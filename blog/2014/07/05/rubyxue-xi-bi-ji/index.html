
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>ruby学习笔记——类 | Ajia's Blog</title>

	<meta name="author" content="Ajia"> 
	
	<meta name="description" content="Ruby学习笔记"> <meta name="keywords" content="Ruby学习笔记">

	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Ajia's Blog" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="/stylesheets/font-awesome.min.css" rel="stylesheet" type="text/css">
	
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<!--<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">-->
<!--<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>-->
<!--<link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>-->

    <script type="text/javascript" src="/javascripts/jquery.min.js"></script>
</head>



<body>
	<header id="header" class="inner"><a href="/"><h1>Ajia's Blog</h1></a>
<nav id="main-nav">
    <!--<form action="/search.html" method="get">-->
        <!--<fieldset role="search">-->
            <!--<input type="text" x-webkit-speech="" placeholder="Search..." name="query" class="search">-->
        <!--</fieldset>-->
    <!--</form>-->


    <ul class="main-navigation">
        <li><a href="/blog/archives">archives</a></li>
        <li><a href="/blog/categories/java/">java</a></li>
        <li><a href="/blog/categories/python/">python</a></li>
        <li><a href="/blog/categories/node/">node</a></li>
        <li><a href="/blog/categories/javascript/">javascript</a></li>
        <li><a href="/blog/categories/ios/">ios</a></li>
        <li><a href="/blog/categories/startup/">startup</a></li>
        <li><a href="/blog/categories/rework/">rework</a></li>
    </ul>
</nav>


</header>

	<div id="content" class="inner"><article class="post">


	<h2 class="title">Ruby学习笔记——类</h2>
	<div class="entry-content"><!--more-->


<p>类的定义:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Song</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span> <span class="n">artist</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>
</span><span class='line'>      <span class="vi">@name</span> <span class="o">=</span> <span class="nb">name</span>        <span class="c1">#实例变量</span>
</span><span class='line'>      <span class="vi">@artist</span> <span class="o">=</span> <span class="n">artist</span>
</span><span class='line'>      <span class="vi">@duration</span> <span class="o">=</span> <span class="n">duration</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>在Ruby中，类永远都不是封闭的：你总可以向一个已有的类中添加方法。这个适用于你自己编写的类，同样适用于标准的内建（built-in）类。只要打开某个已有类的类定义，你就可以将指定的新内容添加进去，比如向上面已经定义的Song添加to_s方法：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Song</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">to_s</span>
</span><span class='line'>    <span class="s2">&quot;Song: </span><span class="si">#@name</span><span class="s2">--</span><span class="si">#@artist</span><span class="s2">(</span><span class="si">#@duration</span><span class="s2">)&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>类的实例化：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">song</span> <span class="o">=</span> <span class="no">Song</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;Bicyclops&quot;</span><span class="p">,</span> <span class="s2">&quot;Fleck&quot;</span><span class="p">,</span> <span class="mi">260</span><span class="p">)</span>
</span><span class='line'><span class="n">song</span><span class="o">.</span><span class="n">to_s</span>
</span></code></pre></td></tr></table></div></figure>


<p>继承：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">KaraoKeSong</span> <span class="o">&lt;</span> <span class="no">Song</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span> <span class="n">artist</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">lyrics</span><span class="p">){</span>
</span><span class='line'>      <span class="k">super</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span> <span class="n">artist</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>
</span><span class='line'>      <span class="vi">@lyrics</span> <span class="o">=</span> <span class="n">lyrics</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>读对象的属性</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Song</span>
</span><span class='line'>  <span class="kp">attr_reader</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:artist</span><span class="p">,</span> <span class="ss">:duration</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>可写的属性，创建一个名字以等号结尾的方法来设置对象属性，或者使用attr_writer</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Song</span>
</span><span class='line'>  <span class="kp">attr_writer</span> <span class="ss">:duration</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>类变量，只存在一份拷贝，由@@开头，例如@@count</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Song</span>
</span><span class='line'>  <span class="vc">@@plays</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span> <span class="n">artist</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>
</span><span class='line'>      <span class="vi">@name</span>       <span class="o">=</span> <span class="nb">name</span>
</span><span class='line'>      <span class="vi">@artist</span> <span class="o">=</span> <span class="n">artist</span>
</span><span class='line'>      <span class="vi">@duration</span>   <span class="o">=</span> <span class="n">duration</span>
</span><span class='line'>      <span class="vi">@plays</span>      <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">play</span>
</span><span class='line'>      <span class="vi">@plays</span> <span class="o">+=</span> <span class="mi">1</span> <span class="c1">#same as @plays = @plays + 1</span>
</span><span class='line'>      <span class="vc">@@plays</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class='line'>      <span class="s2">&quot;This song:# </span><span class="si">#@plays</span><span class="s2"> plays. Total </span><span class="si">#@@plays</span><span class="s2"> plays.&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>类方法，通过在方法名之前放置类名以及一个句点来定义</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Example</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">instance_method</span>  <span class="c1">#实例方法</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="k">def</span> <span class="nc">Example</span><span class="o">.</span><span class="nf">class_method</span>  <span class="c1">#类方法</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>单例模式</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">MyLogger</span>
</span><span class='line'>  <span class="nb">private_class_method</span> <span class="ss">:new</span>
</span><span class='line'>  <span class="vc">@@logger</span> <span class="o">=</span> <span class="kp">nil</span>
</span><span class='line'>  <span class="k">def</span> <span class="nc">MyLogger</span><span class="o">.</span><span class="nf">create</span>
</span><span class='line'>      <span class="vc">@@logger</span> <span class="o">=</span> <span class="kp">new</span> <span class="k">unless</span> <span class="vc">@@logger</span>
</span><span class='line'>      <span class="vc">@@logger</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>访问控制</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Accounts</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">checking</span><span class="p">,</span> <span class="n">savings</span><span class="p">)</span>
</span><span class='line'>      <span class="vi">@checking</span> <span class="o">=</span> <span class="n">checking</span>
</span><span class='line'>      <span class="vi">@savings</span> <span class="o">=</span> <span class="n">savings</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="kp">private</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">debit</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="n">amount</span><span class="p">)</span>
</span><span class='line'>      <span class="n">account</span><span class="o">.</span><span class="n">balance</span> <span class="o">-=</span> <span class="n">amount</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">credit</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="n">amount</span><span class="p">)</span>
</span><span class='line'>      <span class="n">account</span><span class="o">.</span><span class="n">balance</span> <span class="o">+=</span> <span class="n">amount</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="kp">public</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">transfer_to_savings</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>
</span><span class='line'>      <span class="n">debit</span><span class="p">(</span><span class="vi">@checking</span><span class="p">,</span> <span class="n">amount</span><span class="p">)</span>
</span><span class='line'>      <span class="n">credit</span><span class="p">(</span><span class="vi">@savings</span><span class="p">,</span> <span class="n">amount</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>



</div>


<div class="sharing">
  
  
  
</div>
</article>
</div>
	<footer id="footer" class="inner"><div class="aboutme">
<hr>
  <div class="profile">
    <!--<a href="http://twitter.com/"><img class="icon" src=""></a>-->

    <h3>Ajia</h3>
    <!--<p><a href="http://twitter.com/">@</a></p>-->

    <!--<div class="codes">-->
      <!--<h4>Codes</h4>-->
      <!--<div class="github"><a href="https://github.com/ajia">github.com/ajia</a></div>-->
    <!--</div>-->
  </div>

  <div class="float_clear"></div>

</div>
Copyright &copy; 2015
 Ajia 
<br>
Powered by Octopress.



</footer>
	

</body>
</html>

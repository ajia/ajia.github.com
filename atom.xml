<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Ajia's Blog]]></title>
  <link href="http://ajia.github.com/atom.xml" rel="self"/>
  <link href="http://ajia.github.com/"/>
  <updated>2013-05-24T14:33:27+08:00</updated>
  <id>http://ajia.github.com/</id>
  <author>
    <name><![CDATA[Ajia]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[java插件之timer]]></title>
    <link href="http://ajia.github.com/blog/2013/05/24/javacha-jian-zhi-timer/"/>
    <updated>2013-05-24T14:20:00+08:00</updated>
    <id>http://ajia.github.com/blog/2013/05/24/javacha-jian-zhi-timer</id>
    <content type="html"><![CDATA[<p>JQuery Timers应用知识<br/>
提供了三个函式<br/>
1. everyTime(时间间隔, [计时器名称], 函式名称, [次数限制], [等待函式程序完成])</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="cm">/*************************************************************</span>
</span><span class='line'><span class="cm">*   everyTime(时间间隔, [计时器名称], 函式名称, [次数限制], [等待函式程序完成])</span>
</span><span class='line'><span class="cm">*************************************************************/</span>
</span><span class='line'><span class="c1">//每1秒执行函式test()</span>
</span><span class='line'><span class="kd">function</span> <span class="nx">test</span><span class="p">(){</span>
</span><span class='line'>   <span class="c1">//do something...</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">everyTime</span><span class="p">(</span><span class="s1">&#39;1s&#39;</span><span class="p">,</span><span class="nx">test</span><span class="p">);</span>
</span><span class='line'><span class="c1">//每1秒执行</span>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">everyTime</span><span class="p">(</span><span class="s1">&#39;1s&#39;</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'><span class="c1">//do something...</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'><span class="c1">//每1秒执行，并命名计时器名称为A</span>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">everyTime</span><span class="p">(</span><span class="s1">&#39;1s&#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'><span class="c1">//do something...</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'><span class="c1">//每20秒执行，最多5次，并命名计时器名称为B</span>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">everyTime</span><span class="p">(</span><span class="s1">&#39;2das&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'><span class="c1">//do something...</span>
</span><span class='line'><span class="p">},</span><span class="mi">5</span><span class="p">);</span>
</span><span class='line'><span class="c1">//每20秒执行，无限次，并命名计时器名称为C</span>
</span><span class='line'><span class="c1">//若时间间隔抵到，但函式程序仍未完成则需等待执行函式完成后再继续计时</span>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">everyTime</span><span class="p">(</span><span class="s1">&#39;2das&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>    <span class="c1">//执行一个会超过20秒以上的程式</span>
</span><span class='line'><span class="p">},</span><span class="mi">0</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<!-- more -->


<ol>
<li>oneTime(时间间隔, [计时器名称], 呼叫的函式)</li>
</ol>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="cm">/***********************************************************</span>
</span><span class='line'><span class="cm">*   oneTime(时间间隔, [计时器名称], 呼叫的函式)</span>
</span><span class='line'><span class="cm">***********************************************************/</span>
</span><span class='line'><span class="c1">//倒数10秒后执行</span>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">oneTime</span><span class="p">(</span><span class="s1">&#39;1das&#39;</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'><span class="c1">//do something...</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'><span class="c1">//倒数100秒后执行，并命名计时器名称为D</span>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">oneTime</span><span class="p">(</span><span class="s1">&#39;1hs&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'><span class="c1">//do something...</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<ol>
<li>stopTime ([计时器名称], [函式名称])</li>
</ol>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="cm">/************************************************************</span>
</span><span class='line'><span class="cm">*  stopTime ([计时器名称], [函式名称])</span>
</span><span class='line'><span class="cm">************************************************************/</span>
</span><span class='line'><span class="c1">//停止所有的在$(&#39;body&#39;)上计时器</span>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">stopTime</span> <span class="p">();</span>
</span><span class='line'><span class="c1">//停止$(&#39;body&#39;)上名称为A的计时器</span>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">stopTime</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">);</span>
</span><span class='line'><span class="c1">//停止$(&#39;body&#39;)上所有呼叫test()的计时器</span>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">stopTime</span> <span class="p">(</span><span class="nx">test</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>自定义时间单位
打开源代码
找到</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">powers</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>   <span class="c1">// Yeah this is major overkill...</span>
</span><span class='line'>   <span class="s1">&#39;ms&#39;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>   <span class="s1">&#39;cs&#39;</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
</span><span class='line'>   <span class="s1">&#39;ds&#39;</span><span class="o">:</span> <span class="mi">100</span><span class="p">,</span>
</span><span class='line'>   <span class="s1">&#39;s&#39;</span><span class="o">:</span> <span class="mi">1000</span><span class="p">,</span>
</span><span class='line'>   <span class="s1">&#39;das&#39;</span><span class="o">:</span> <span class="mi">10000</span><span class="p">,</span>
</span><span class='line'>   <span class="s1">&#39;hs&#39;</span><span class="o">:</span> <span class="mi">100000</span><span class="p">,</span>
</span><span class='line'>   <span class="s1">&#39;ks&#39;</span><span class="o">:</span> <span class="mi">1000000</span>
</span><span class='line'>  <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[joda日期计算]]></title>
    <link href="http://ajia.github.com/blog/2013/05/24/jodari-qi-ji-suan/"/>
    <updated>2013-05-24T10:19:00+08:00</updated>
    <id>http://ajia.github.com/blog/2013/05/24/jodari-qi-ji-suan</id>
    <content type="html"><![CDATA[<p>Joda-Time提供了一组Java类包用于处理包括ISO8601标准在内的date和time。可以利用它把JDK Date和Calendar类完全替换掉，而且仍然能够提供很好的集成。<a href="http://joda-time.sourceforge.net/">项目地址</a></p>

<!-- more -->


<p>获取DateTime:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="c1">//方法一：取系统点间  </span>
</span><span class='line'><span class="n">DateTime</span> <span class="n">dt1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DateTime</span><span class="o">();</span>
</span><span class='line'><span class="c1">//方法二：通过java.util.Date对象生成  </span>
</span><span class='line'><span class="n">DateTime</span> <span class="n">dt2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DateTime</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">());</span>
</span><span class='line'><span class="c1">//方法三：指定年月日点分秒生成(参数依次是：年,月,日,时,分,秒,毫秒)  </span>
</span><span class='line'><span class="n">DateTime</span> <span class="n">dt3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DateTime</span><span class="o">(</span><span class="mi">2012</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">20</span><span class="o">,</span> <span class="mi">13</span><span class="o">,</span> <span class="mi">14</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
</span><span class='line'><span class="c1">//方法四：ISO8601形式生成  </span>
</span><span class='line'><span class="n">DateTime</span> <span class="n">dt4</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DateTime</span><span class="o">(</span><span class="s">&quot;2012-05-20&quot;</span><span class="o">);</span>
</span><span class='line'><span class="n">DateTime</span> <span class="n">dt5</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DateTime</span><span class="o">(</span><span class="s">&quot;2012-05-20T13:14:00&quot;</span><span class="o">);</span>
</span><span class='line'><span class="c1">//只需要年月日的时候  </span>
</span><span class='line'><span class="n">LocalDate</span> <span class="n">localDate</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LocalDate</span><span class="o">(</span><span class="mi">2009</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="mi">6</span><span class="o">);</span><span class="c1">// September 6, 2009  </span>
</span><span class='line'><span class="c1">//只需要时分秒毫秒的时候  </span>
</span><span class='line'><span class="n">LocalTime</span> <span class="n">localTime</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LocalTime</span><span class="o">(</span><span class="mi">13</span><span class="o">,</span> <span class="mi">30</span><span class="o">,</span> <span class="mi">26</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span><span class="c1">// 1:30:26PM</span>
</span></code></pre></td></tr></table></div></figure>


<p>获取年月日点分秒</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">DateTime</span> <span class="n">dt</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DateTime</span><span class="o">();</span>
</span><span class='line'><span class="c1">//年  </span>
</span><span class='line'><span class="kt">int</span> <span class="n">year</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="na">getYear</span><span class="o">();</span>
</span><span class='line'><span class="c1">//月  </span>
</span><span class='line'><span class="kt">int</span> <span class="n">month</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="na">getMonthOfYear</span><span class="o">();</span>
</span><span class='line'><span class="c1">//日  </span>
</span><span class='line'><span class="kt">int</span> <span class="n">day</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="na">getDayOfMonth</span><span class="o">();</span>
</span><span class='line'><span class="c1">//星期  </span>
</span><span class='line'><span class="kt">int</span> <span class="n">week</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="na">getDayOfWeek</span><span class="o">();</span>
</span><span class='line'><span class="c1">//点  </span>
</span><span class='line'><span class="kt">int</span> <span class="n">hour</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="na">getHourOfDay</span><span class="o">();</span>
</span><span class='line'><span class="c1">//分  </span>
</span><span class='line'><span class="kt">int</span> <span class="n">min</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="na">getMinuteOfHour</span><span class="o">();</span>
</span><span class='line'><span class="c1">//秒  </span>
</span><span class='line'><span class="kt">int</span> <span class="n">sec</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="na">getSecondOfMinute</span><span class="o">();</span>
</span><span class='line'><span class="c1">//毫秒  </span>
</span><span class='line'><span class="kt">int</span> <span class="n">msec</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="na">getMillisOfSecond</span><span class="o">();</span>
</span></code></pre></td></tr></table></div></figure>


<p>星期的特殊处理</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">DateTime</span> <span class="n">dt</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DateTime</span><span class="o">();</span>
</span><span class='line'><span class="c1">//星期  </span>
</span><span class='line'><span class="k">switch</span><span class="o">(</span><span class="n">dt</span><span class="o">.</span><span class="na">getDayOfWeek</span><span class="o">())</span> <span class="o">{</span>
</span><span class='line'><span class="k">case</span> <span class="n">DateTimeConstants</span><span class="o">.</span><span class="na">SUNDAY</span><span class="o">:</span>
</span><span class='line'>    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;星期日&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">break</span><span class="o">;</span>
</span><span class='line'><span class="k">case</span> <span class="n">DateTimeConstants</span><span class="o">.</span><span class="na">MONDAY</span><span class="o">:</span>
</span><span class='line'>    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;星期一&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">break</span><span class="o">;</span>
</span><span class='line'><span class="k">case</span> <span class="n">DateTimeConstants</span><span class="o">.</span><span class="na">TUESDAY</span><span class="o">:</span>
</span><span class='line'>    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;星期二&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">break</span><span class="o">;</span>
</span><span class='line'><span class="k">case</span> <span class="n">DateTimeConstants</span><span class="o">.</span><span class="na">WEDNESDAY</span><span class="o">:</span>
</span><span class='line'>    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;星期三&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">break</span><span class="o">;</span>
</span><span class='line'><span class="k">case</span> <span class="n">DateTimeConstants</span><span class="o">.</span><span class="na">THURSDAY</span><span class="o">:</span>
</span><span class='line'>    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;星期四&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">break</span><span class="o">;</span>
</span><span class='line'><span class="k">case</span> <span class="n">DateTimeConstants</span><span class="o">.</span><span class="na">FRIDAY</span><span class="o">:</span>
</span><span class='line'>    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;星期五&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">break</span><span class="o">;</span>
</span><span class='line'><span class="k">case</span> <span class="n">DateTimeConstants</span><span class="o">.</span><span class="na">SATURDAY</span><span class="o">:</span>
</span><span class='line'>    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;星期六&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">break</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>与JDK日期对象转换</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">DateTime</span> <span class="n">dt</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DateTime</span><span class="o">();</span>
</span><span class='line'><span class="c1">//转换成java.util.Date对象  </span>
</span><span class='line'><span class="n">Date</span> <span class="n">d1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Date</span><span class="o">(</span><span class="n">dt</span><span class="o">.</span><span class="na">getMillis</span><span class="o">());</span>
</span><span class='line'><span class="n">Date</span> <span class="n">d2</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="na">toDate</span><span class="o">();</span>
</span><span class='line'><span class="c1">//转换成java.util.Calendar对象  </span>
</span><span class='line'><span class="n">Calendar</span> <span class="n">c1</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
</span><span class='line'><span class="n">c1</span><span class="o">.</span><span class="na">setTimeInMillis</span><span class="o">(</span><span class="n">dt</span><span class="o">.</span><span class="na">getMillis</span><span class="o">());</span>
</span><span class='line'><span class="n">Calendar</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="na">toCalendar</span><span class="o">(</span><span class="n">Locale</span><span class="o">.</span><span class="na">getDefault</span><span class="o">());</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>日期前后推算</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">DateTime</span> <span class="n">dt</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DateTime</span><span class="o">();</span>
</span><span class='line'><span class="c1">//昨天  </span>
</span><span class='line'><span class="n">DateTime</span> <span class="n">yesterday</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="na">minusDays</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
</span><span class='line'><span class="c1">//明天  </span>
</span><span class='line'><span class="n">DateTime</span> <span class="n">tomorrow</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="na">plusDays</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
</span><span class='line'><span class="c1">//1个月前  </span>
</span><span class='line'><span class="n">DateTime</span> <span class="n">before1month</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="na">minusMonths</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
</span><span class='line'><span class="c1">//3个月后  </span>
</span><span class='line'><span class="n">DateTime</span> <span class="n">after3month</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="na">plusMonths</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
</span><span class='line'><span class="c1">//2年前  </span>
</span><span class='line'><span class="n">DateTime</span> <span class="n">before2year</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="na">minusYears</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
</span><span class='line'><span class="c1">//5年后  </span>
</span><span class='line'><span class="n">DateTime</span> <span class="n">after5year</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="na">plusYears</span><span class="o">(</span><span class="mi">5</span><span class="o">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>取特殊日期</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">DateTime</span> <span class="n">dt</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DateTime</span><span class="o">();</span>
</span><span class='line'><span class="c1">//月末日期    </span>
</span><span class='line'><span class="n">DateTime</span> <span class="n">lastday</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="na">dayOfMonth</span><span class="o">().</span><span class="na">withMaximumValue</span><span class="o">();</span>
</span><span class='line'><span class="c1">//90天后那周的周一  </span>
</span><span class='line'><span class="n">DateTime</span> <span class="n">firstday</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="na">plusDays</span><span class="o">(</span><span class="mi">90</span><span class="o">).</span><span class="na">dayOfWeek</span><span class="o">().</span><span class="na">withMinimumValue</span><span class="o">();</span>
</span></code></pre></td></tr></table></div></figure>


<p>计算区间</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">DateTime</span> <span class="n">begin</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DateTime</span><span class="o">(</span><span class="s">&quot;2012-02-01&quot;</span><span class="o">);</span>
</span><span class='line'><span class="n">DateTime</span> <span class="n">end</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DateTime</span><span class="o">(</span><span class="s">&quot;2012-05-01&quot;</span><span class="o">);</span>
</span><span class='line'><span class="c1">//计算区间毫秒数  </span>
</span><span class='line'><span class="n">Duration</span> <span class="n">d</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Duration</span><span class="o">(</span><span class="n">begin</span><span class="o">,</span> <span class="n">end</span><span class="o">);</span>
</span><span class='line'><span class="kt">long</span> <span class="n">time</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="na">getMillis</span><span class="o">();</span>
</span><span class='line'><span class="c1">//计算区间天数  </span>
</span><span class='line'><span class="n">Period</span> <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Period</span><span class="o">(</span><span class="n">begin</span><span class="o">,</span> <span class="n">end</span><span class="o">,</span> <span class="n">PeriodType</span><span class="o">.</span><span class="na">days</span><span class="o">());</span>
</span><span class='line'><span class="kt">int</span> <span class="n">days</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="na">getDays</span><span class="o">();</span>
</span><span class='line'><span class="c1">//计算特定日期是否在该区间内  </span>
</span><span class='line'><span class="n">Interval</span> <span class="n">i</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Interval</span><span class="o">(</span><span class="n">begin</span><span class="o">,</span> <span class="n">end</span><span class="o">);</span>
</span><span class='line'><span class="kt">boolean</span> <span class="n">contained</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="k">new</span> <span class="n">DateTime</span><span class="o">(</span><span class="s">&quot;2012-03-01&quot;</span><span class="o">));</span>
</span></code></pre></td></tr></table></div></figure>


<p>日期比较</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">DateTime</span> <span class="n">d1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DateTime</span><span class="o">(</span><span class="s">&quot;2012-02-01&quot;</span><span class="o">);</span>
</span><span class='line'><span class="n">DateTime</span> <span class="n">d2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DateTime</span><span class="o">(</span><span class="s">&quot;2012-05-01&quot;</span><span class="o">);</span>
</span><span class='line'><span class="c1">//和系统时间比  </span>
</span><span class='line'><span class="kt">boolean</span> <span class="n">b1</span> <span class="o">=</span> <span class="n">d1</span><span class="o">.</span><span class="na">isAfterNow</span><span class="o">();</span>
</span><span class='line'><span class="kt">boolean</span> <span class="n">b2</span> <span class="o">=</span> <span class="n">d1</span><span class="o">.</span><span class="na">isBeforeNow</span><span class="o">();</span>
</span><span class='line'><span class="kt">boolean</span> <span class="n">b3</span> <span class="o">=</span> <span class="n">d1</span><span class="o">.</span><span class="na">isEqualNow</span><span class="o">();</span>
</span><span class='line'><span class="c1">//和其他日期比  </span>
</span><span class='line'><span class="kt">boolean</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">d1</span><span class="o">.</span><span class="na">isAfter</span><span class="o">(</span><span class="n">d2</span><span class="o">);</span>
</span><span class='line'><span class="kt">boolean</span> <span class="n">f2</span> <span class="o">=</span> <span class="n">d1</span><span class="o">.</span><span class="na">isBefore</span><span class="o">(</span><span class="n">d2</span><span class="o">);</span>
</span><span class='line'><span class="kt">boolean</span> <span class="n">f3</span> <span class="o">=</span> <span class="n">d1</span><span class="o">.</span><span class="na">isEqual</span><span class="o">(</span><span class="n">d2</span><span class="o">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>格式化输出</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">DateTime</span> <span class="n">dateTime</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DateTime</span><span class="o">();</span>
</span><span class='line'><span class="n">String</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">dateTime</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="s">&quot;yyyy/MM/dd hh:mm:ss.SSSa&quot;</span><span class="o">);</span>
</span><span class='line'><span class="n">String</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">dateTime</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="s">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><span class="o">);</span>
</span><span class='line'><span class="n">String</span> <span class="n">s3</span> <span class="o">=</span> <span class="n">dateTime</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="s">&quot;EEEE dd MMMM, yyyy HH:mm:ssa&quot;</span><span class="o">);</span>
</span><span class='line'><span class="n">String</span> <span class="n">s4</span> <span class="o">=</span> <span class="n">dateTime</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="s">&quot;yyyy/MM/dd HH:mm ZZZZ&quot;</span><span class="o">);</span>
</span><span class='line'><span class="n">String</span> <span class="n">s5</span> <span class="o">=</span> <span class="n">dateTime</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="s">&quot;yyyy/MM/dd HH:mm Z&quot;</span><span class="o">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>时区</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="c1">//默认设置为日本时间  </span>
</span><span class='line'><span class="n">DateTimeZone</span><span class="o">.</span><span class="na">setDefault</span><span class="o">(</span><span class="n">DateTimeZone</span><span class="o">.</span><span class="na">forID</span><span class="o">(</span><span class="s">&quot;Asia/Tokyo&quot;</span><span class="o">));</span>
</span><span class='line'><span class="n">DateTime</span> <span class="n">dt1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DateTime</span><span class="o">();</span>
</span><span class='line'><span class="c1">//伦敦时间  </span>
</span><span class='line'><span class="n">DateTime</span> <span class="n">dt2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DateTime</span><span class="o">(</span><span class="n">DateTimeZone</span><span class="o">.</span><span class="na">forID</span><span class="o">(</span><span class="s">&quot;Europe/London&quot;</span><span class="o">));</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[读取音频文件的信息]]></title>
    <link href="http://ajia.github.com/blog/2013/05/06/du-qu-yin-pin-wen-jian-de-xin-xi/"/>
    <updated>2013-05-06T18:33:00+08:00</updated>
    <id>http://ajia.github.com/blog/2013/05/06/du-qu-yin-pin-wen-jian-de-xin-xi</id>
    <content type="html"><![CDATA[<p>项目里需要读取音频的播放时间，找了一个下午发现这个：jaudiotagger(http://www.jthink.net/jaudiotagger/)，它是一个音频标签JAVA库，目前支持 Mp3, Mp4 (Mp4 audio, M4a and M4p audio) Ogg Vorbis, Flac and Wma, 但是对Wav 和 Real 的支持有限。</p>

<!-- more -->


<p>读取m4a格式的播放时间</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm"> * 获取m4a格式文件的播放时间</span>
</span><span class='line'><span class="cm"> * @param filePath</span>
</span><span class='line'><span class="cm"> * @return</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">getMp4AudioLength</span> <span class="o">(</span><span class="n">String</span> <span class="n">filePath</span><span class="o">){</span>
</span><span class='line'>  <span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">filePath</span><span class="o">);</span>
</span><span class='line'>  <span class="n">Mp4FileReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Mp4FileReader</span><span class="o">();</span>
</span><span class='line'>  <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
</span><span class='line'>    <span class="n">AudioFile</span> <span class="n">f</span><span class="o">;</span>
</span><span class='line'>  <span class="k">try</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">f</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">file</span><span class="o">);</span>
</span><span class='line'>      <span class="n">AudioHeader</span> <span class="n">head</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="na">getAudioHeader</span><span class="o">();</span>
</span><span class='line'>      <span class="n">length</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="na">getTrackLength</span><span class="o">();</span>
</span><span class='line'>  <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">CannotReadException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">TagException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ReadOnlyFileException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InvalidAudioFrameException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">length</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>读取mp3格式的播放时间</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm"> * 获取mp3格式文件的播放时间</span>
</span><span class='line'><span class="cm"> * @param filePath</span>
</span><span class='line'><span class="cm"> * @return</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">getMp3AudioLength</span> <span class="o">(</span><span class="n">String</span> <span class="n">filePath</span><span class="o">){</span>
</span><span class='line'>  <span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">filePath</span><span class="o">);</span>
</span><span class='line'>  <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
</span><span class='line'>  <span class="k">try</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">MP3File</span> <span class="n">f</span> <span class="o">=</span> <span class="o">(</span><span class="n">MP3File</span><span class="o">)</span><span class="n">AudioFileIO</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">file</span><span class="o">);</span>
</span><span class='line'>      <span class="n">MP3AudioHeader</span> <span class="n">audioHeader</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="na">getMP3AudioHeader</span><span class="o">();</span>
</span><span class='line'>      <span class="n">length</span> <span class="o">=</span> <span class="n">audioHeader</span><span class="o">.</span><span class="na">getTrackLength</span><span class="o">();</span>
</span><span class='line'>  <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">CannotReadException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">TagException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ReadOnlyFileException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InvalidAudioFrameException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">length</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[使用jave转换音视频格式]]></title>
    <link href="http://ajia.github.com/blog/2013/05/04/shi-yong-javezhuan-huan-yin-shi-pin-ge-shi/"/>
    <updated>2013-05-04T15:54:00+08:00</updated>
    <id>http://ajia.github.com/blog/2013/05/04/shi-yong-javezhuan-huan-yin-shi-pin-ge-shi</id>
    <content type="html"><![CDATA[<p>JAVE是用java包装ffmpeg的一个类库，可以自由的在各种音视频格式之间转换，它的jar包里就包含了ffmpeg的可执行文件，有linux和windows的，我为了在本机上调试，去ffmpeg的官网下了一个Mac OSX版本的。</p>

<p>官网地址：http://www.sauronsoftware.it/projects/jave/。养成去看官网的习惯很重要，英语差点的话可以先看中文的介绍，有个概念再去看官网的说明。</p>

<!-- more -->


<p>
我是直接用源代码跑的，方便调试问题。下面是mp3转换为m4a格式的一个例子，更多的例子和请去官网查看</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm">     * 转化音频格式</span>
</span><span class='line'><span class="cm">     * @param s</span>
</span><span class='line'><span class="cm">     * @param t</span>
</span><span class='line'><span class="cm">     * @throws IllegalArgumentException</span>
</span><span class='line'><span class="cm">     * @throws InputFormatException</span>
</span><span class='line'><span class="cm">     * @throws EncoderException</span>
</span><span class='line'><span class="cm">     */</span>
</span><span class='line'>    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">convertAudio</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">,</span> <span class="n">String</span> <span class="n">t</span><span class="o">){</span>
</span><span class='line'>      <span class="n">File</span> <span class="n">source</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
</span><span class='line'>      <span class="n">File</span> <span class="n">target</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">t</span><span class="o">);</span>
</span><span class='line'>      <span class="n">AudioAttributes</span> <span class="n">audio</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AudioAttributes</span><span class="o">();</span>
</span><span class='line'>      <span class="n">audio</span><span class="o">.</span><span class="na">setCodec</span><span class="o">(</span><span class="s">&quot;libmp3lame&quot;</span><span class="o">);</span>
</span><span class='line'>      <span class="n">audio</span><span class="o">.</span><span class="na">setBitRate</span><span class="o">(</span><span class="k">new</span> <span class="n">Integer</span><span class="o">(</span><span class="mi">128000</span><span class="o">));</span>
</span><span class='line'>      <span class="n">audio</span><span class="o">.</span><span class="na">setChannels</span><span class="o">(</span><span class="k">new</span> <span class="n">Integer</span><span class="o">(</span><span class="mi">2</span><span class="o">));</span>
</span><span class='line'>      <span class="n">audio</span><span class="o">.</span><span class="na">setSamplingRate</span><span class="o">(</span><span class="k">new</span> <span class="n">Integer</span><span class="o">(</span><span class="mi">44100</span><span class="o">));</span>
</span><span class='line'>      <span class="n">EncodingAttributes</span> <span class="n">attrs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">EncodingAttributes</span><span class="o">();</span>
</span><span class='line'>      <span class="n">attrs</span><span class="o">.</span><span class="na">setFormat</span><span class="o">(</span><span class="s">&quot;mp4&quot;</span><span class="o">);</span>
</span><span class='line'>      <span class="n">attrs</span><span class="o">.</span><span class="na">setAudioAttributes</span><span class="o">(</span><span class="n">audio</span><span class="o">);</span>
</span><span class='line'>      <span class="n">Encoder</span> <span class="n">encoder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Encoder</span><span class="o">();</span>
</span><span class='line'>      <span class="k">try</span> <span class="o">{</span>
</span><span class='line'>          <span class="n">encoder</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="n">source</span><span class="o">,</span> <span class="n">target</span><span class="o">,</span> <span class="n">attrs</span><span class="o">);</span>
</span><span class='line'>      <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IllegalArgumentException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>          <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
</span><span class='line'>      <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InputFormatException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>          <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
</span><span class='line'>      <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">EncoderException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>          <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>转换的时候老是报错，抛出EncoderException异常，我查了一下源码，注释掉Encoder.java的864行</p>

<blockquote><blockquote><p>throw new EncoderException(line);</p></blockquote></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[音乐播放器dewplayer的使用]]></title>
    <link href="http://ajia.github.com/blog/2013/05/04/yin-le-bo-fang-qi-dewplayerde-shi-yong/"/>
    <updated>2013-05-04T15:53:00+08:00</updated>
    <id>http://ajia.github.com/blog/2013/05/04/yin-le-bo-fang-qi-dewplayerde-shi-yong</id>
    <content type="html"><![CDATA[<p>介绍一个flash音乐播放器：dewplayer(法国的)<br/>
官网地址：http://www.alsacreations.fr/dewplayer.html。它提供几种风格，根据自己的需要选择一种风格。下面说一下用javascript来操作dewplayer</p>

<!-- more -->


<p>引入swfobject.js</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span> <span class="nx">src</span><span class="o">=</span><span class="s2">&quot;swfobject.js&quot;</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>然后是js代码</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">dewp</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;dewplayerjs&quot;</span><span class="p">);</span>
</span><span class='line'><span class="kd">function</span> <span class="nx">play</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">if</span><span class="p">(</span><span class="nx">dewp</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="nx">dewp</span><span class="p">.</span><span class="nx">dewplay</span><span class="p">();</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="kd">function</span> <span class="nx">stop</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">if</span><span class="p">(</span><span class="nx">dewp</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="nx">dewp</span><span class="p">.</span><span class="nx">dewstop</span><span class="p">();</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="kd">function</span> <span class="nx">pause</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">if</span><span class="p">(</span><span class="nx">dewp</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="nx">dewp</span><span class="p">.</span><span class="nx">dewpause</span><span class="p">();</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="kd">function</span> <span class="nx">next</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">if</span><span class="p">(</span><span class="nx">dewp</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="nx">dewp</span><span class="p">.</span><span class="nx">dewnext</span><span class="p">();</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="kd">function</span> <span class="nx">prev</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">if</span><span class="p">(</span><span class="nx">dewp</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="nx">dewp</span><span class="p">.</span><span class="nx">dewprev</span><span class="p">();</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="kd">function</span> <span class="nx">set</span><span class="p">(</span><span class="nx">file</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">if</span><span class="p">(</span><span class="nx">dewp</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="nx">dewp</span><span class="p">.</span><span class="nx">dewset</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="kd">function</span> <span class="nx">go</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">if</span><span class="p">(</span><span class="nx">dewp</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="nx">dewp</span><span class="p">.</span><span class="nx">dewgo</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="kd">function</span> <span class="nx">setpos</span><span class="p">(</span><span class="nx">ms</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">if</span><span class="p">(</span><span class="nx">dewp</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="nx">dewp</span><span class="p">.</span><span class="nx">dewsetpos</span><span class="p">(</span><span class="nx">ms</span><span class="p">);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="kd">function</span> <span class="nx">getpos</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">if</span><span class="p">(</span><span class="nx">dewp</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="nx">alert</span><span class="p">(</span><span class="nx">dewp</span><span class="p">.</span><span class="nx">dewgetpos</span><span class="p">());</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="kd">function</span> <span class="nx">volume</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">if</span><span class="p">(</span><span class="nx">dewp</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="nx">alert</span><span class="p">(</span><span class="nx">dewp</span><span class="p">.</span><span class="nx">dewvolume</span><span class="p">(</span><span class="nx">val</span><span class="p">));</span>
</span><span class='line'>          <span class="p">}</span>            
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>html代码</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>     <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;dewplayer_content_js&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;object</span> <span class="na">data=</span><span class="s">&quot;dewplayer.swf&quot;</span> <span class="na">width=</span><span class="s">&quot;200&quot;</span> <span class="na">height=</span><span class="s">&quot;20&quot;</span> <span class="na">name=</span><span class="s">&quot;dewplayer&quot;</span> <span class="na">id=</span><span class="s">&quot;dewplayerjs&quot;</span> <span class="na">type=</span><span class="s">&quot;application/x-shockwave-flash&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&quot;movie&quot;</span> <span class="na">value=</span><span class="s">&quot;dewplayer.swf&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>      <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&quot;flashvars&quot;</span> <span class="na">value=</span><span class="s">&quot;mp3=mp3/test1.mp3|mp3/test2.mp3|mp3/test3.mp3&amp;javascript=on&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>      <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&quot;wmode&quot;</span> <span class="na">value=</span><span class="s">&quot;transparent&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/object&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>      <span class="nt">&lt;p&gt;</span>
</span><span class='line'>      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">onclick=</span><span class="s">&quot;play();&quot;</span> <span class="na">value=</span><span class="s">&quot;Play&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">onclick=</span><span class="s">&quot;stop();&quot;</span> <span class="na">value=</span><span class="s">&quot;Stop&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">onclick=</span><span class="s">&quot;pause();&quot;</span> <span class="na">value=</span><span class="s">&quot;Pause&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">onclick=</span><span class="s">&quot;next();&quot;</span> <span class="na">value=</span><span class="s">&quot;Next&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">onclick=</span><span class="s">&quot;prev();&quot;</span> <span class="na">value=</span><span class="s">&quot;Prev&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">onclick=</span><span class="s">&quot;go(2);&quot;</span> <span class="na">value=</span><span class="s">&quot;Go(2)&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">onclick=</span><span class="s">&quot;set(&#39;mp3/test2.mp3&#39;);&quot;</span> <span class="na">value=</span><span class="s">&quot;Set mp3&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">onclick=</span><span class="s">&quot;set(&#39;mp3/test3.mp3&#39;);&quot;</span> <span class="na">value=</span><span class="s">&quot;Set another mp3&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">onclick=</span><span class="s">&quot;setpos(10000);&quot;</span> <span class="na">value=</span><span class="s">&quot;Set position 10 sec&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">onclick=</span><span class="s">&quot;getpos();&quot;</span> <span class="na">value=</span><span class="s">&quot;Get position&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">onclick=</span><span class="s">&quot;volume(50);&quot;</span> <span class="na">value=</span><span class="s">&quot;Set volume 50%&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/p&gt;</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[seo优化]]></title>
    <link href="http://ajia.github.com/blog/2013/04/27/seoyou-hua/"/>
    <updated>2013-04-27T17:10:00+08:00</updated>
    <id>http://ajia.github.com/blog/2013/04/27/seoyou-hua</id>
    <content type="html"><![CDATA[<p>添加 meta data description</p>

<p>文章生产时默认会生成 layout, title, date, comments, categories 这几项，如果多添加2个选项 ‘keywords’, ‘description’，会在 generate 文章的时候自动生成相应的 meta 标签
如果文章 header 写成这样</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>layout: post
</span><span class='line'>title: "SEO for Octopress"
</span><span class='line'>date: 2012-04-22 09:55
</span><span class='line'>comments: true
</span><span class='line'>categories: [seo,octopress]
</span><span class='line'>keywords: seo,octopress
</span><span class='line'>description: How to optimize Octopress for SEO</span></code></pre></td></tr></table></div></figure>


<p></p>

<!-- more -->


<p>生成的post head标签中会生成</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;title&gt;SEO for Octopress &lt;/title&gt;
</span><span class='line'>&lt;meta name="author" content="Yatish Mehta"&gt;
</span><span class='line'>&lt;meta name="description" content="How to optimize Octopress for SEO"&gt;
</span><span class='line'>&lt;meta name="keywords" content="seo,octopress"&gt;</span></code></pre></td></tr></table></div></figure>


<p>如果不想每次都得手动添加，可以修改 Rakefile文件</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>open(filename, 'w') do |post|
</span><span class='line'>  post.puts "---"
</span><span class='line'>  post.puts "layout: post"
</span><span class='line'>  post.puts "title: \"#{title.gsub(/&/,'&amp;')}\""
</span><span class='line'>  post.puts "date: #{Time.now.strftime('%Y-%m-%d %H:%M')}"
</span><span class='line'>  post.puts "comments: true"
</span><span class='line'>  post.puts "categories: "
</span><span class='line'>  post.puts "keywords: "
</span><span class='line'>  post.puts "description: "
</span><span class='line'>  post.puts "---"
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>


<p>上面的方法只能给每个 post 生成对应的 meta标签，如果要给主页添加 meta 标签，修改 source/_includes/head.html，添加以下内容</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;meta name="author" content="Ajia"&gt;
</span><span class='line'>
</span><span class='line'>&lt;meta name="description" content="Swim in the code, Ajia's blog"&gt;
</span><span class='line'>&lt;meta name="keywords" content="seo优化, octopress"&gt;</span></code></pre></td></tr></table></div></figure>


<p>在 _config.yml 文件中填充全局的 keywords 和 description, 比如这样</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>description: Ajia's blog
</span><span class='line'>keywords: java,算法,数据结构,web development,Ajax</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Sending 'ccColor4B' (aka 'struct _ccColor4B') to parameter of incompatible type 'CIColor *']]></title>
    <link href="http://ajia.github.com/blog/2013/04/22/sending-cccolor4b-aka-struct-cccolor4b-to-parameter-of-incompatible-type-cicolor-star/"/>
    <updated>2013-04-22T15:25:00+08:00</updated>
    <id>http://ajia.github.com/blog/2013/04/22/sending-cccolor4b-aka-struct-cccolor4b-to-parameter-of-incompatible-type-cicolor-star</id>
    <content type="html"><![CDATA[<p>升级cocos2d以后，编译项目，CCLayer.m的layerWithColor:(ccColor4B)color报错</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">Sending</span> <span class="err">&#39;</span><span class="n">ccColor4B</span><span class="err">&#39;</span> <span class="p">(</span><span class="n">aka</span> <span class="err">&#39;</span><span class="k">struct</span> <span class="n">_ccColor4B</span><span class="err">&#39;</span><span class="p">)</span> <span class="n">to</span> <span class="n">parameter</span>
</span><span class='line'> <span class="n">of</span> <span class="n">incompatible</span> <span class="n">type</span> <span class="err">&#39;</span><span class="n">CIColor</span> <span class="o">*</span><span class="err">&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>把</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="k">return</span> <span class="p">[[[</span><span class="n">self</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithColor:</span><span class="n">color</span><span class="p">]</span> <span class="n">autorelease</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>改成</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="k">return</span> <span class="p">[[(</span><span class="n">CCColorLayer</span><span class="o">*</span><span class="p">)[</span><span class="n">self</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithColor:</span><span class="n">color</span><span class="p">]</span> <span class="n">autorelease</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>就可以了</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[mysql创建function失败]]></title>
    <link href="http://ajia.github.com/blog/2013/04/16/mysqlchuang-jian-functionshi-bai/"/>
    <updated>2013-04-16T16:12:00+08:00</updated>
    <id>http://ajia.github.com/blog/2013/04/16/mysqlchuang-jian-functionshi-bai</id>
    <content type="html"><![CDATA[<p>出错信息：</p>

<p>创建function时</p>

<pre><code>ERROR 1418 (HY000): This function has none of DETERMINISTIC, NO SQL,
or READS SQL DATA in its declaration and binary logging is enabled 
(you might want to use the less safe log_bin_trust_function_creators variable)
</code></pre>

<p>原因：</p>

<p>这是我们开启了bin-log, 我们就必须指定我们的函数是否是
1 DETERMINISTIC 不确定的
2 NO SQL 没有SQl语句，当然也不会修改数据
3 READS SQL DATA 只是读取数据，当然也不会修改数据
4 MODIFIES SQL DATA 要修改数据
5 CONTAINS SQL 包含了SQL语句</p>

<p>其中在function里面，只有 DETERMINISTIC, NO SQL 和 READS SQL DATA 被支持。如果我们开启了 bin-log, 我们就必须为我们的function指定一个参数。</p>

<p>解决办法</p>

<pre><code>mysql&gt;show variables like '%func%';
+---------------------------------+-------+  
|Variable_name                  |Value|  
+---------------------------------+-------+  
|log_bin_trust_function_creators|OFF  |  
+---------------------------------+-------+  

set global log_bin_trust_function_creators=1;  

mysql&gt;show variables like '%func%';  
+---------------------------------+-------+  
|Variable_name                  |Value|  
+---------------------------------+-------+  
|log_bin_trust_function_creators|ON   |  
+---------------------------------+-------+  
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[hessian版本冲突的问题]]></title>
    <link href="http://ajia.github.com/blog/2013/04/11/hessianban-ben-chong-tu-de-wen-ti/"/>
    <updated>2013-04-11T17:53:00+08:00</updated>
    <id>http://ajia.github.com/blog/2013/04/11/hessianban-ben-chong-tu-de-wen-ti</id>
    <content type="html"><![CDATA[<p>项目需要调用远程的接口，用的是hessian，写了一段代码测试，结果报错</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">HessianProtocolException</span><span class="err">：</span><span class="n">expected</span> <span class="n">integer</span> <span class="n">at</span><span class="err">…</span>
</span></code></pre></td></tr></table></div></figure>


<p>非常简短，让人摸不着头脑。寻找了一段时间，在网上发现这样一句话</p>

<blockquote><blockquote><p>use hessian-4.<em> spring-3.</em>  resin-4.<em>. for Hessian protocol 2.And resin-3.</em>, spring-2.* hessian before 3.2.0 for Hessian protocol version 1.</p></blockquote></blockquote>

<p>看来是版本的问题，我的环境是resin-4.*、spring-2.*、hessian-4.*，后来改成用resin.3.1.13版本就正常了。接下来试试把spring升级到3。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[jquery插件之cookie]]></title>
    <link href="http://ajia.github.com/blog/2013/04/09/jquerycha-jian-zhi-cookie/"/>
    <updated>2013-04-09T11:59:00+08:00</updated>
    <id>http://ajia.github.com/blog/2013/04/09/jquerycha-jian-zhi-cookie</id>
    <content type="html"><![CDATA[<p>Create session cookie:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">cookie</span><span class="p">(</span><span class="s1">&#39;the_cookie&#39;</span><span class="p">,</span> <span class="s1">&#39;the_value&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Create expiring cookie, 7 days:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">cookie</span><span class="p">(</span><span class="s1">&#39;the_cookie&#39;</span><span class="p">,</span> <span class="s1">&#39;the_value&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">expires</span><span class="o">:</span> <span class="mi">7</span> <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Create expiring cookie, valid across entire site:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">cookie</span><span class="p">(</span><span class="s1">&#39;the_cookie&#39;</span><span class="p">,</span> <span class="s1">&#39;the_value&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">expires</span><span class="o">:</span> <span class="mi">7</span><span class="p">,</span> <span class="nx">path</span><span class="o">:</span> <span class="s1">&#39;/&#39;</span> <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Read cookie:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">cookie</span><span class="p">(</span><span class="s1">&#39;the_cookie&#39;</span><span class="p">);</span> <span class="c1">// =&gt; &quot;the_value&quot;</span>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">cookie</span><span class="p">(</span><span class="s1">&#39;not_existing&#39;</span><span class="p">);</span> <span class="c1">// =&gt; undefined</span>
</span></code></pre></td></tr></table></div></figure>


<p>Read all available cookies:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">cookie</span><span class="p">();</span> <span class="c1">// =&gt; { &quot;the_cookie&quot;: &quot;the_value&quot;, &quot;...remaining&quot;: &quot;cookies&quot; }</span>
</span></code></pre></td></tr></table></div></figure>


<p>Delete cookie:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// Returns true when cookie was found, false when no cookie was found...</span>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">removeCookie</span><span class="p">(</span><span class="s1">&#39;the_cookie&#39;</span><span class="p">);</span>
</span><span class='line'><span class="c1">// Same path as when the cookie was written...</span>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">removeCookie</span><span class="p">(</span><span class="s1">&#39;the_cookie&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">path</span><span class="o">:</span> <span class="s1">&#39;/&#39;</span> <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<!--more-->


<figure class='code'><figcaption><span> (jquery.cookie.js)</span> <a href='http://ajia.github.com/downloads/code/jquery.cookie.js'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="cm">/*!</span>
</span><span class='line'><span class="cm"> * jQuery Cookie Plugin v1.3.1</span>
</span><span class='line'><span class="cm"> * https://github.com/carhartl/jquery-cookie</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * Copyright 2013 Klaus Hartl</span>
</span><span class='line'><span class="cm"> * Released under the MIT license</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">factory</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">define</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">define</span><span class="p">.</span><span class="nx">amd</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="c1">// AMD. Register as anonymous module.</span>
</span><span class='line'>      <span class="nx">define</span><span class="p">([</span><span class="s1">&#39;jquery&#39;</span><span class="p">],</span> <span class="nx">factory</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>      <span class="c1">// Browser globals.</span>
</span><span class='line'>      <span class="nx">factory</span><span class="p">(</span><span class="nx">jQuery</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">$</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">pluses</span> <span class="o">=</span> <span class="sr">/\+/g</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">raw</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">s</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">decoded</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nb">decodeURIComponent</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">pluses</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">));</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">converted</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="c1">// This is a quoted cookie as according to RFC2068, unescape</span>
</span><span class='line'>          <span class="nx">s</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\\&quot;/g</span><span class="p">,</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\\\\/g</span><span class="p">,</span> <span class="s1">&#39;\\&#39;</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">try</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="nx">config</span><span class="p">.</span><span class="nx">json</span> <span class="o">?</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="o">:</span> <span class="nx">s</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">er</span><span class="p">)</span> <span class="p">{}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">config</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">cookie</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// write</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">options</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span> <span class="nx">config</span><span class="p">.</span><span class="nx">defaults</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">expires</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="kd">var</span> <span class="nx">days</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">expires</span><span class="p">,</span> <span class="nx">t</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">expires</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
</span><span class='line'>              <span class="nx">t</span><span class="p">.</span><span class="nx">setDate</span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="o">+</span> <span class="nx">days</span><span class="p">);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>          <span class="nx">value</span> <span class="o">=</span> <span class="nx">config</span><span class="p">.</span><span class="nx">json</span> <span class="o">?</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">:</span> <span class="nb">String</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">return</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span> <span class="o">=</span> <span class="p">[</span>
</span><span class='line'>              <span class="nx">config</span><span class="p">.</span><span class="nx">raw</span> <span class="o">?</span> <span class="nx">key</span> <span class="o">:</span> <span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">key</span><span class="p">),</span>
</span><span class='line'>              <span class="s1">&#39;=&#39;</span><span class="p">,</span>
</span><span class='line'>              <span class="nx">config</span><span class="p">.</span><span class="nx">raw</span> <span class="o">?</span> <span class="nx">value</span> <span class="o">:</span> <span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">value</span><span class="p">),</span>
</span><span class='line'>              <span class="nx">options</span><span class="p">.</span><span class="nx">expires</span> <span class="o">?</span> <span class="s1">&#39;; expires=&#39;</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">expires</span><span class="p">.</span><span class="nx">toUTCString</span><span class="p">()</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="c1">// use expires attribute, max-age is not supported by IE</span>
</span><span class='line'>              <span class="nx">options</span><span class="p">.</span><span class="nx">path</span>    <span class="o">?</span> <span class="s1">&#39;; path=&#39;</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">path</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span class='line'>              <span class="nx">options</span><span class="p">.</span><span class="nx">domain</span>  <span class="o">?</span> <span class="s1">&#39;; domain=&#39;</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">domain</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span class='line'>              <span class="nx">options</span><span class="p">.</span><span class="nx">secure</span>  <span class="o">?</span> <span class="s1">&#39;; secure&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span>
</span><span class='line'>          <span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">));</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// read</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">decode</span> <span class="o">=</span> <span class="nx">config</span><span class="p">.</span><span class="nx">raw</span> <span class="o">?</span> <span class="nx">raw</span> <span class="o">:</span> <span class="nx">decoded</span><span class="p">;</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">cookies</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="p">);</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">key</span> <span class="o">?</span> <span class="kc">undefined</span> <span class="o">:</span> <span class="p">{};</span>
</span><span class='line'>      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">l</span> <span class="o">=</span> <span class="nx">cookies</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">parts</span> <span class="o">=</span> <span class="nx">cookies</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">);</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">decode</span><span class="p">(</span><span class="nx">parts</span><span class="p">.</span><span class="nx">shift</span><span class="p">());</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">cookie</span> <span class="o">=</span> <span class="nx">decode</span><span class="p">(</span><span class="nx">parts</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="nx">key</span> <span class="o">&amp;&amp;</span> <span class="nx">key</span> <span class="o">===</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">result</span> <span class="o">=</span> <span class="nx">converted</span><span class="p">(</span><span class="nx">cookie</span><span class="p">);</span>
</span><span class='line'>              <span class="k">break</span><span class="p">;</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">result</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">converted</span><span class="p">(</span><span class="nx">cookie</span><span class="p">);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">config</span><span class="p">.</span><span class="nx">defaults</span> <span class="o">=</span> <span class="p">{};</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">removeCookie</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">cookie</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="c1">// Must not alter options, thus extending a fresh object...</span>
</span><span class='line'>          <span class="nx">$</span><span class="p">.</span><span class="nx">cookie</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span> <span class="nx">options</span><span class="p">,</span> <span class="p">{</span> <span class="nx">expires</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span> <span class="p">}));</span>
</span><span class='line'>          <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="p">}));</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[jquery的jsonp方式的ajax提交解决跨域的问题]]></title>
    <link href="http://ajia.github.com/blog/2013/04/08/jqueryde-jsonpfang-shi-de-ajaxti-jiao-jie-jue-kua-yu-de-wen-ti/"/>
    <updated>2013-04-08T17:45:00+08:00</updated>
    <id>http://ajia.github.com/blog/2013/04/08/jqueryde-jsonpfang-shi-de-ajaxti-jiao-jie-jue-kua-yu-de-wen-ti</id>
    <content type="html"><![CDATA[<p>jquery请求：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">action</span> <span class="o">=</span> <span class="nx">form</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;action&quot;</span><span class="p">);</span>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">type</span><span class="o">:</span><span class="s2">&quot;get&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">mobile</span> <span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#mobile&#39;</span><span class="o">+</span><span class="nx">id</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="nx">url</span><span class="o">:</span><span class="nx">action</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">dataType</span><span class="o">:</span><span class="s2">&quot;jsonp&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">jsonp</span><span class="o">:</span><span class="s2">&quot;callback&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">success</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">resultObj</span><span class="p">.</span><span class="nx">result</span><span class="p">){</span>
</span><span class='line'>          <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;发送成功&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>服务器端：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">response</span><span class="o">.</span><span class="na">setContentType</span><span class="o">(</span><span class="s">&quot;text/html; charset=utf-8&quot;</span><span class="o">);</span>
</span><span class='line'><span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">&quot;Pragma&quot;</span><span class="o">,</span> <span class="s">&quot;No-cache&quot;</span><span class="o">);</span>
</span><span class='line'><span class="n">response</span><span class="o">.</span><span class="na">setDateHeader</span><span class="o">(</span><span class="s">&quot;Expires&quot;</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
</span><span class='line'><span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">&quot;Cache-Control&quot;</span><span class="o">,</span> <span class="s">&quot;no-cache&quot;</span><span class="o">);</span>
</span><span class='line'><span class="n">PrintWriter</span> <span class="n">out</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getWriter</span><span class="o">();</span>
</span><span class='line'><span class="c1">//业务逻辑</span>
</span><span class='line'><span class="n">String</span> <span class="n">callback</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&quot;callback&quot;</span><span class="o">);</span>
</span><span class='line'><span class="n">result</span> <span class="o">=</span> <span class="n">callback</span><span class="o">+</span><span class="s">&quot;(&quot;</span><span class="o">+</span><span class="n">resultJson</span><span class="o">.</span><span class="na">toString</span><span class="o">()+</span><span class="s">&quot;)&quot;</span><span class="o">;</span>
</span><span class='line'><span class="n">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
</span><span class='line'><span class="n">out</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
</span><span class='line'><span class="n">out</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[遇上MySql的奇怪问题]]></title>
    <link href="http://ajia.github.com/blog/2013/04/08/yu-shang-mysqlde-qi-guai-wen-ti/"/>
    <updated>2013-04-08T17:25:00+08:00</updated>
    <id>http://ajia.github.com/blog/2013/04/08/yu-shang-mysqlde-qi-guai-wen-ti</id>
    <content type="html"><![CDATA[<p>今天遇上一个异常：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>2013-04-08 15:35:47 072 [ERROR] JDBC commit failed [org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:124)]
</span><span class='line'>com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: Communications link failure during commit(). Transaction resolution unknown.
</span><span class='line'>  at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
</span><span class='line'>  at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
</span><span class='line'>  at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
</span><span class='line'>  at java.lang.reflect.Constructor.newInstance(Constructor.java:532)
</span><span class='line'>  at com.mysql.jdbc.Util.handleNewInstance(Util.java:407)
</span><span class='line'>  at com.mysql.jdbc.Util.getInstance(Util.java:382)
</span><span class='line'>  at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1013)
</span><span class='line'>  at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:987)
</span><span class='line'>  at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:982)
</span><span class='line'>  at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:927)
</span><span class='line'>  at com.mysql.jdbc.ConnectionImpl.commit(ConnectionImpl.java:1672)
</span><span class='line'>  at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
</span><span class='line'>  at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
</span><span class='line'>  at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
</span><span class='line'>  at java.lang.reflect.Method.invoke(Method.java:616)
</span><span class='line'>  at org.logicalcobwebs.proxool.WrappedConnection.invoke(WrappedConnection.java:162)
</span><span class='line'>  at org.logicalcobwebs.proxool.WrappedConnection.intercept(WrappedConnection.java:87)
</span><span class='line'>  at $java.sql.Connection$$EnhancerByProxool$$90ddbb0c.commit(&lt;generated&gt;)
</span><span class='line'>  at org.hibernate.transaction.JDBCTransaction.commitAndResetAutoCommit(JDBCTransaction.java:139)
</span><span class='line'>  at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:115)
</span><span class='line'>  at org.springframework.orm.hibernate3.HibernateTransactionManager.doCommit(HibernateTransactionManager.java:596)
</span><span class='line'>  at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:709)
</span><span class='line'>  at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:678)
</span><span class='line'>  at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:319)
</span><span class='line'>  at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:116)
</span><span class='line'>  at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)
</span><span class='line'>  at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204)
</span><span class='line'>  at $Proxy163.importDate(Unknown Source)</span></code></pre></td></tr></table></div></figure>


<p>找了一个上午和半个下午终于解决了，原因是线上的数据库服务器关掉了innodb引擎，myisam对事务支持有问题，所以修改spring的配置文件，把事务的配置去掉就可以了。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[HttpClient上传文件]]></title>
    <link href="http://ajia.github.com/blog/2013/04/07/httpclientshang-chuan-wen-jian/"/>
    <updated>2013-04-07T21:44:00+08:00</updated>
    <id>http://ajia.github.com/blog/2013/04/07/httpclientshang-chuan-wen-jian</id>
    <content type="html"><![CDATA[<p>折腾了一下用HttpClient上传文件，主要是不需要设置“multipart/form-data”,否则会出现“the request was rejected because no multipart boundary was found”</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">PostMethod</span> <span class="n">method</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PostMethod</span><span class="o">(</span><span class="n">url</span><span class="o">);</span>
</span><span class='line'>  <span class="n">Part</span><span class="o">[]</span> <span class="n">part</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Part</span><span class="o">[</span><span class="n">params</span><span class="o">.</span><span class="na">size</span><span class="o">()+</span><span class="mi">1</span><span class="o">];</span>
</span><span class='line'>    <span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">keySet</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="na">keySet</span><span class="o">();</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
</span><span class='line'>    <span class="k">for</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span> <span class="o">:</span> <span class="n">keySet</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
</span><span class='line'>      <span class="k">if</span><span class="o">(</span><span class="n">StringUtil</span><span class="o">.</span><span class="na">isNotNull</span><span class="o">(</span><span class="n">value</span><span class="o">)){</span>
</span><span class='line'>          <span class="n">part</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringPart</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">,</span> <span class="s">&quot;UTF-8&quot;</span><span class="o">);</span>
</span><span class='line'>      <span class="o">}</span><span class="k">else</span><span class="o">{</span>
</span><span class='line'>          <span class="n">part</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringPart</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="s">&quot;&quot;</span><span class="o">,</span> <span class="s">&quot;UTF-8&quot;</span><span class="o">);</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>      <span class="n">i</span><span class="o">++;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="n">FilePart</span> <span class="n">fp</span> <span class="o">=</span> <span class="k">new</span>  <span class="n">FilePart</span><span class="o">(</span><span class="s">&quot;image&quot;</span><span class="o">,</span> <span class="n">file</span><span class="o">);</span>
</span><span class='line'>    <span class="n">fp</span><span class="o">.</span><span class="na">setContentType</span><span class="o">(</span><span class="n">MIME</span><span class="o">.</span><span class="na">ENC_BINARY</span><span class="o">);</span>
</span><span class='line'>    <span class="n">part</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">fp</span><span class="o">;</span>
</span><span class='line'>    <span class="n">HttpConnectionManagerParams</span> <span class="n">managerParams</span> <span class="o">=</span> <span class="n">httpClient</span><span class="o">.</span><span class="na">getHttpConnectionManager</span><span class="o">().</span><span class="na">getParams</span><span class="o">();</span>
</span><span class='line'>    <span class="n">managerParams</span><span class="o">.</span><span class="na">setConnectionTimeout</span><span class="o">(</span><span class="mi">3000000</span><span class="o">);</span>
</span><span class='line'>     <span class="n">managerParams</span><span class="o">.</span><span class="na">setSoTimeout</span><span class="o">(</span><span class="mi">12000000</span><span class="o">);</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">statusCode</span><span class="o">;</span>
</span><span class='line'>  <span class="k">try</span> <span class="o">{</span>
</span><span class='line'>        <span class="n">MultipartRequestEntity</span> <span class="n">mrp</span><span class="o">=</span> <span class="k">new</span>  <span class="n">MultipartRequestEntity</span><span class="o">(</span><span class="n">part</span><span class="o">,</span> <span class="n">method</span><span class="o">.</span><span class="na">getParams</span><span class="o">());</span>
</span><span class='line'>        <span class="n">method</span><span class="o">.</span><span class="na">setRequestEntity</span><span class="o">(</span><span class="n">mrp</span><span class="o">);</span>
</span><span class='line'>        <span class="n">statusCode</span> <span class="o">=</span> <span class="n">httpClient</span><span class="o">.</span><span class="na">executeMethod</span><span class="o">(</span><span class="n">method</span><span class="o">);</span>
</span><span class='line'>      <span class="k">if</span><span class="o">(</span><span class="n">statusCode</span> <span class="o">!=</span> <span class="n">HttpStatus</span><span class="o">.</span><span class="na">SC_OK</span><span class="o">){</span>
</span><span class='line'>          <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">&quot;Method failed code=&quot;</span> <span class="o">+</span> <span class="n">statusCode</span> <span class="o">+</span> <span class="s">&quot;: &quot;</span> <span class="o">+</span> <span class="n">method</span><span class="o">.</span><span class="na">getStatusLine</span><span class="o">());</span>
</span><span class='line'>        <span class="o">}</span><span class="k">else</span><span class="o">{</span>
</span><span class='line'>          <span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="na">getResponseBodyAsStream</span><span class="o">();</span>
</span><span class='line'>            <span class="n">BufferedReader</span> <span class="n">br</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">InputStreamReader</span><span class="o">(</span><span class="n">inputStream</span><span class="o">,</span> <span class="s">&quot;UTF-8&quot;</span><span class="o">));</span>
</span><span class='line'>            <span class="n">String</span> <span class="n">str</span><span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
</span><span class='line'>            <span class="k">while</span><span class="o">((</span><span class="n">str</span> <span class="o">=</span> <span class="n">br</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">){</span>
</span><span class='line'>              <span class="n">response</span> <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">str</span><span class="o">);</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">HttpException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span> <span class="k">finally</span><span class="o">{</span>
</span><span class='line'>      <span class="n">method</span><span class="o">.</span><span class="na">releaseConnection</span><span class="o">();</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[如何获得创业点子]]></title>
    <link href="http://ajia.github.com/blog/2013/04/04/ru-he-huo-de-chuang-ye-dian-zi/"/>
    <updated>2013-04-04T22:27:00+08:00</updated>
    <id>http://ajia.github.com/blog/2013/04/04/ru-he-huo-de-chuang-ye-dian-zi</id>
    <content type="html"><![CDATA[<p>  硅谷创业教父、创业公司孵化器YC创始人保罗·格雷厄姆(Paul Graham)本月发表了一篇题为《如何获得创业点子》的文章，从创业点子的发现、筛选、竞争以及学校教育等多个角度为创业者详细指点了如何才能得到真正有用的创业点子。他指出，创业者需要去发现身边的问题，而不要凭空想象。大多数好的创业点子最初都是只针对很小的特定用户群体。</p>

<p>　　创业之前最需要做的并不是想创业点子，而是去发现问题。说不定你自己头疼的事情就有可能是潜在的商机。</p>

<p>　　最好的创业点子具有三点共性：它们是创始人自己想做而且有能力实现的，另外，很少有人意识到其价值。当今的巨鳄们如微软、苹果、雅虎、谷歌和Facebook都是凭借这样的好点子起家的。</p>

<!--more-->


<h4>发现问题</h4>

<p>　　为什么说要重视自己身边的问题？因为自己身边的问题是实际存在的，着眼于这些问题必然强过自己闭门造车。这一点是显而易见的，用户需要产品能够解决实际存在的问题而不是不着边际地空想出来的问题。</p>

<p>　　1995年，我自己成立过一个公司，为画廊提供在线画廊服务。但是画廊的老板们显然根本不想把自己展出的画放到网络上。这压根就不是艺术品行业能接受的商业模式。我为了去实现这个看起来很蠢实际上也很蠢的点子花了整整六个月。而直到被一个个客户完全否决后才让我认识到这个点子有多么的不切实际。即使一次次打击之后，一种怀才不遇的郁闷还一直支配着自己，让自己愚蠢地相信努力不会白费。</p>

<p>　　可惜直到现在，仍然有一些创业者们执着于一些谁也不会关心的点子。他们的问题和我之前一样：为了创业而去想问题而不是为了解决问题而去创业。正因为如此，他们为了一些不切实际的点子去做着无用功。在投资界，我们把这些创业公司的点子叫做“made-up”(捏造)或者是“sitcom”(情景喜剧)。这就像是一个为了讲述创业历程的电视节目，编剧们为了生存必须去捏造一些点子让“创业公司”去开发。但是真正好的创业点子是可遇不可求的。并不是编剧们想想就能找到(除非他们真的够走运)，大部分情况下他们可能想到一些听起来蛮不错的点子，但是实际上却糟糕到完全没有人关心。</p>

<p>　　举一个比较有代表性的例子，开发一个针对宠物爱好者的社交网络。这个点子听起来似乎很合理。毕竟成千上万的人都在养宠物，而大多数主人都很关心自己的宠物并且愿意为自己的宠物花钱。自然这些人中可能会有一些想要有这么一个可以互相交流的网站。虽然不是全部，但是至少也有2%到3%的人会经常访问。这样算起来，这个网站的固定用户也有好几百万。网站可以向他们发送定向广告或者提供收费服务。</p>

<p>　　对于这种听起来很合理的点子。当创业者们去征求有宠物的朋友们的点子的时候，没有人会说：“我绝对不会用这东西。”相反，他们都会表现出比较深厚的兴趣。在这个网站刚上线时，可能会有很多人觉得这东西很实用。但是绝大多数这样想的人自己并不会去使用它，即使他们总觉得其他人有可能在用。但是到头来，虽然这个网站口碑不错，看起来也不错，但是却实际上根本没有用户会真正用到它。</p>

<h4>打井</h4>

<p>　　当一家创业公司成立时，一定得有一些真正的用户需要他们的产品。需要注意的是，所谓真正的用户一定要是非常急切的想要它的固定用户，而不是一些用了一次就再不用的尝鲜者。通常来说，这个用户群体刚开始会比较小，因为如果是大多数人都需要而又是一个几个人就能够实现的东西肯定早就已经面世几百年了。所以创业者们需要做出妥协，要么开发一个针对巨大的用户群但是使用频率比较低的产品，要么开发一个针对小用户群但是使用频率比较高的产品。后一种选择中可能大部分点子都不一定好，但是好的创业公司基本上都是靠这样的点子起步的。</p>

<p>　　像谷歌这样的大公司同时投资着很多的项目，应该说这些大公司的产品几乎涵盖了所有人的大部分需求。要想在大公司们的夹缝中取得生存空间，创业公司就需要将自己的全部精力投入到一个产品并将它做好，也就是“术业有专攻”。我们可以把创业想象成挖洞，你可以选择挖一个很大但很浅的坑，也可以挖一个很窄但很深的洞，就好比打一口井。</p>

<p>　　编造的想法通常属于第一种。许多人痴迷于针对宠物主人的社交网络这样的想法。</p>

<p>　　几乎所有好的创业点子都是第二种，如微软的第一个产品Altair Basic。当时Altair电脑只有数千名用户，但是如果没有微软的产品，他们只能用硬件语言编程。三十年后，Facebook走了微软的老路，它在设计之初仅仅针对哈佛的学生们。大概也就几千人的规模。但是正是这几千人却非常渴望这种产品的出现。</p>

<p>　　对于创业者们来说，创业之前最需要考虑的两个问题是：目前哪些人需要什么？哪些人非常想用这个产品，即使它还只是两个名不见经传的人做出来的，而且是漏洞百出的测试版。如果这两个问题的答案还不明确，还请三思而后行。</p>

<p>　　你需要的不是井本身的“窄”，而是它的“深”。窄只是深(和速度)的副产品。实际上，这两者实际上是紧密联系的。当你知道产品将吸引特定用户群或用户类型时，这是个好迹象。</p>

<p>　　但是，小范围用户群的需求是好创业点子的必要条件，但不是充分条件。如果马克 扎克伯格(Mark Zuckerberg)的产品永远只停留在为哈佛学生服务的层面上，那么他就不会像现在这样成功了。Facebook之所以成功是因为它在小范围市场中取得成功后迅速扩张到了更大的市场。当Facebook在哈佛这样的学校成功之后，与之类似的大学生市场很快就接纳了它。当所有的大学都加入进来之后，其他用户都蜂拥而至。</p>

<p>　　Facebook实际上走着微软当年所走过的路：从仅仅支持Altair的Basic开始，到支持所有电脑的Basic，再到支持Basic之外的语言，再扩张到操作系统、应用程序，最后上市。</p>

<h4>直觉</h4>

<p>　　如何判断自己的产品是否可以扩张到更大的市场？如何判断自己的产品是否正是大公司渴求的产品或者只是一个不会受重视的小玩意？大部分时候创业者们自己也很迷惑。Airbnb创始人一开始也没有意识到自己开启了多么大的市场。最开始他们只是想针对某些用户做一个好产品。他们为房东们提供了一个可以将自己家里面多余空间出租的平台。但是他们并没有预料到这个市场可以扩大，直到事实摆在他们眼前他们不得不跟进更多用户的需求。他们最开始只知道需要做好这个产品。这也许正是比尔 盖茨(Bill Gates)或者扎克伯格最开始所想的。</p>

<p>　　或许有些点子在设想之初就想好了扩张的过程。或者有一些投资专家能在一家创业公司最初的产品上规划这个产品的未来。但是无论创业者多么有经验，这些规划所能预测的都很有限。因此，对于创业者们来说，首先需要铭记于心的一点是：扩张的过程是难以预见的。</p>

<p>　　这就引出了另外一个问题：如果创业者们不确定自己的哪个点子能做大，如何在这些点子中做出抉择？这个问题的答案虽然听起来令人沮丧，但是却引人思考：如果你是那样的人，就会有正确的直觉。如果你处在快速变化的行业最前沿，当你有直觉认为值得去做的点子时，往往这就是最正确的选择。</p>

<p>　　在《Zen and the Art of Motorcycle Maintenance》(摩托车维修的禅与艺术)一书中，罗伯特•波西格(Robert Pirsig)写道：</p>

<p>　　“你想去完成一幅完美的画作？很简单。保持自己最好状态按你自己想的去画就行。”</p>

<p>　　同样的道理，最好的创业点子来自于那些需要这些产品的人。</p>

<p>　　所谓处在行业最前沿并不意味着要是那些推动行业前进的人。你也可以是使用这种行业产品的用户。正如扎克伯格能想到Facebook这个好点子并不一定因为他是程序员，而是因为他也是一个电脑用户。如果在2004年问一群40岁的人他们想不想把自己的生活公布在网络上，他们肯定以为问的人是疯子。但是扎克伯格却会觉得这个点子很自然，因为他已经长期使用网络。</p>

<p>　　保罗•布赫海特(Paul Buchheit，YC合伙人，Gmail之父)认为，那些处在高速变化的行业最前沿的人“实际上生活在未来”。结合波西格的名言可以总结为：</p>

<p>　　活在未来，打造这个世界上缺少的东西。</p>

<p>　　几乎所有的创业公司都是通过这种方式开始的。苹果、雅虎、谷歌和Facebook最开始并不是一个公司。他们的创始人们灵机一动的好产品缔造了这些伟大的公司。</p>

<p>　　回头看一下这些创始人的成功历程，他们的成功几乎都是一个机遇契合了他们有准备的头脑。当比尔•盖茨和保罗•艾伦(Paul Allen)听说了Altair电脑的问世，第一个点子就是“我们可以为它写一个Basic解释器”。德鲁•休斯敦(Drew Houston)发现他忘了带U盘时就想到“如果可以把文件放在网络里面并随时可以访问就好了。”听说过Altair电脑的人很多，忘带U盘的人更多。但是只有这些有着充分准备的人注意到了其中的问题并把握了机遇。</p>

<p>　　对于渴求创业点子的创业者来说，“发现”比“想”更重要。YC将这种从创业者自身经历中诞生的创业点子称为“有机创业点子”。最成功的创业公司往往是以这种方式开始的。</p>

<p>　　这可能不是创业者们喜欢听的话。他们想要的是找到好创业点子的窍门，而不是要他们去做好准备。但是这确实是无可争辩的真理。其实这也可以算做是一种窍门，只是这个方法需要长时间的积累。</p>

<p>　　对于并不处在技术发展前沿的人，想创业就得去主动去接触这些知识。事实上，只要智力正常的人都可以在一年内学会最新的编程技术。一家成功的创业公司将至少要发展3-5年，相比之下，一年的准备时间是一笔划算的投资。尤其是如果你想寻找创业合伙人。</p>

<p>　　要处于快速变化的行业前沿，并非必须学习编程。掌握编程技术是并不是创业的必要条件，但是一个很不错的选择。正如马克•安德森(Marc Andreessen)所说，软件正在入侵世界的每一个角落，而这个过程还将持续几十年。</p>

<p>　　熟练的掌握技术意味着当创业者有好的点子的时候，可以自己去实现这个点子。虽然这不是必须的(比如亚马逊的创始人杰夫•贝佐斯(Jeff Bezos)就不懂编程)，但是这可以成为创业者的一个优势。同样是想出Facebook这个点子的人，不懂技术的人只能说：“这是个不错的点子。”但是懂技术的人就会说：“这点子不错，我可以试试今天晚上把它搞出来。”更好的是自己是开发人员兼用户，这样测试也可以自己解决了。</p>

<h4>留意</h4>

<p>　　如果你生活在未来，获得创业点子的方式是寻找那些缺少的东西。如果你真的处于快速变化的领域最前沿，就会发现一些明显缺少的东西。不明显的是它们正是创业点子。因此，如果你想要发现创业点子，不要仅仅开启“缺少什么”这个筛选条件，同时还要关闭其他所有筛选条件，特别是“我们能成长为一家大公司吗？”。如果最开始就考虑这些事，你不仅会错过很多好的创业点子，还会让自己专注于错误的点子。</p>

<p>　　大多数缺少的东西都需要人们花时间来发现，你必须留意身边的点子。</p>

<p>　　当遇到的问题得到解决时，回想起来你会发现这些问题其实非常明显。你需要关闭通常妨碍你发现它们的筛选条件。这时候最有效的方法就是认为当前的状态是理所当然的，我们中思想最开明的人都经常这么做。如果停下来质疑所有事情，你就无法前进一步。</p>

<p>　　但是，寻找创业点子时，你可以牺牲一些认为现状是理所当然的效率，并且开始质疑某些事情。为什么你的收件箱总是满的？因为你收到了许多邮件，或者你没有从收件箱删除任何邮件。为什么你收到了这么多邮件？人们给你发邮件，希望你帮忙他们解决什么？这些问题有更好的解决办法吗？为什么很难从收件箱删除邮件？为什么在阅读邮件后不删除它们？你的收件箱是处理这些事情的最佳工具吗？</p>

<p>　　要特别注意那些让你感到头痛的事情。认为当前所处的状态是理所当然的不仅能够使生活更高效，也使得人更有忍耐力。如果你知道在未来50年里会发生什么事情，你将会发现现在生活的拘束性，就如同科幻小说里利用时光机把人们送回50年前所感觉到的那样。某些事情会让你感到苦恼是因为你生活在未来。</p>

<p>　　当你发现了正确的问题时，应当至少对你自己将它描述得很明显。当我们开发Viaweb时，所有在线商店都是网页设计师用单个HTML页面组建的。我们作为程序员，便会明显觉得这些网站可以用软件生成。</p>

<p>　　这意味着，想出创业点子是关于发现明显的事情。你必须重新审视那些看起来很明显以及那些你还没有发现的事情。你需要放松你的大脑，尝试着换个角度来看待问题。寻找缺少的东西，努力解决难题，同时关注空白地带和异常的事情。</p>

<p>　　给自己一些时间，你知道自己何时会准备妥当，但你不知道点子会在什么时候出现。如果比尔•盖茨和保罗•艾伦强迫自己在Altair电脑出现前一个月内想出创业点子，那么他们可能就不会创造出微软这么伟大的公司了。</p>

<p>　　让自己发现点子的一个好方法就是做一些很酷的事情。做那些事便会自然而然的发现缺失的东西，创建已经存在的东西就没那么有趣。</p>

<p>　　就如同在思考创业点子的同时也会产生坏主意一样，做那些看起来像“玩具”的东西也会让你发现好的点子。当某个东西看起来像“玩具”时，这也意味着它具有点子所拥有的一切东西(除重要性意外)。它很酷，用户喜欢，只是重要性不够。但如果你生活在未来并打造某个用户喜欢而且很酷的东西时，它的重要性可能超过外行的看法。当苹果和微软刚开始开发微型计算机时，人们普遍认为它是玩具。BackRub(谷歌搜索引擎最初的名字)曾经看起来像微不足道的科学项目。Facebook最初只是本科生相互悄悄跟踪的方式。</p>

<p>　　YC孵化的很多企业都在做那些被外界认为像“玩具”的事情，在我们看来这就证明了这些企业拥有非常好的点子。</p>

<p>　　如果你拥有长远的眼光，你就能够把“生活在未来并打造缺少的东西”这件事做得更好。</p>

<p>　　生活在未来并做有趣的事情。</p>

<h4>学校</h4>

<p>　　我建议大学生试着去做事情，而不是学习“企业家精神”。只有亲身去“创业”，你才能更好的了解它，那些成功创业者的例子已经很清楚地说明了这一点。在大学你应当规划自己的未来，学校是做这件事情的最好场所。不要耗费时间来学习创业最容易的部分，你应当试着成为具有创业潜质的人。</p>

<p>　　领域之间的碰撞是创意的源泉。如果你懂编程，并且开始学习其它领域，你将会发现很多问题都能够用软件解决。实际上，你将会在其它领域发现新的问题。</p>

<p>　　因此，如果你是计算机系的学生，并且想要创业。你最好能够先去一家生物科技公司工作。计算机系的学生通常能够在计算机硬件或软件公司进行暑期实习，而不是学习与企业家精神相关的课程。但如果想要寻找创业点子，你最好能够在一些与计算机不相关的领域进行实习。或者干脆直接开始创业。微软和Facebook都是1月份成立的，因为在哈佛大学1月份是阅读季，学生们没有任何课程，这为创业提供了条件。</p>

<p>　　但是不要认为自己所做的事最终都能实现创业，这还太早。试着与其他同学共事，大学是一个人规划未来的好地方，周围的人们和你做着相同的事情。如果和他们共同做一件事情，你将不仅能收获好的点子，也能收获好的创始团队。</p>

<p>　　当心研究。如果一名本科生写了一篇论文，内容是关于他的朋友们已经开始使用的某些东西，那么这很有可能意味着一个好的创业点子的出现，博士论文则不会出现这样的结果。一个点子的研究成分越重，它就越不可能用于创业。因为研究的范围往往比较狭窄，因而不太可能满足所有人的要求。而当你的点子是为了解决用户的问题时，你通常能够摆脱学术研究带来的局限性。</p>

<h4>竞争</h4>

<p>　　好的点子似乎是显而易见的，当你拥有它的时候通常会觉得已经晚了。但不要沮丧，担心自己起步晚了是好点子出现的标志。即使你发现其他人也在做同样的事情，你也不会太晚。初创企业被竞争对手消灭的事情非常少见，因而你大可不必为此担心，除非竞争对手有办法让用户远离你。</p>

<p>　　如果你不确定，去问问用户。你是否太晚是由是否有用户需要你所做的东西所决定的。如果你有竞争对手没有而用户又需要的东西，那么你就有了领先的机会。</p>

<p>　　问题是你是否需要去争取领先。如果你所做的事情未来许多人都会做，那么不管这件事情多么小，你都应该坚持去做它。例如，如果你的应用只能在最新款的手机上运行，而竞争对手无法做到这点，这就是一次机会。</p>

<p>　　当面临竞争者时，错误也会随之出现。缺少经验的创始人通常给予竞争者太多信任。要知道，你的成功与否主要取决于你，而不是你的竞争对手。在一个好的点子上遇到竞争对手比在坏点子上没有竞争对手要好得多。</p>

<p>　　不要担心自己将进入一个对手众多的领域，你要坚信自己会注意到其他人忽略的地方，这是一个非常好的开始，谷歌就是一个有力的例证。一个充斥着竞争对手的领域表示那里存在需求，并且没有好的解决方案出现。初创企业不能幻想着自己进入一个足够大的市场，并且那里没有竞争对手。因此任何成功的初创企业要么进入一个充满竞争对手的市场，但是自身拥有秘密武器，要么进入一个看起来很小但之后会变大的市场(例如微软)。</p>

<h4>筛选</h4>

<p>　　当你在寻找创业点子时，记得关闭另外两个筛选条件：不吸引人和费劲。</p>

<p>　　绝大多数程序员脑海中的创业过程是这样的：写几行牛逼闪闪的代码，放到服务器上，然后就坐等收钱。他们可能不愿意处理枯燥无味的琐事或者牵扯进乱糟糟的现实世界中，理由是这些事情会拖慢进程。但是这样的偏好广泛传播导致一些不错的创业点子的空间被大为压缩。如果你愿意在这些无聊乏味的点子上花些心思琢磨，极有可能发现有价值的点子等待实现。</p>

<p>　　在线支付公司Stripe就是一个关闭费劲筛选条件而受益匪浅的好例子。曾经有无数的程序员有过这个点子，也曾有无数的程序员知道付款的过程是多么痛苦，但是当他们寻找创业灵感时，他们并没有看到这一点，因为他们在无意识中逃避和支付打交道。对Stripe来说，支付同样是一件进展缓慢的事，但绝不是无法容忍的。事实上他们可能痛苦还少些，因为和支付打交道的恐惧让绝大多数人远离这个领域，同样他们也不用费劲心思让用户知道自己，因为这些绝望的用户都在眼巴巴地等着他们的产品。</p>

<p>　　不吸引人筛选条件和费劲筛选条件有相似之处，只不过前者是让你远离那些你瞧不上的问题，而后者是你惧怕的问题，通常后者比前者对你的影响更加大，因为费劲筛选条件更像是一种幻觉，即便不是，那也是一种更为严重的自我沉溺。进行创业意味着付出相当多的劳动，即使产品可能并不需要很多的努力，不过，你还是有很多琐事要做，比如和投资人打交道，招聘和解雇员工等等。所以如果你有一个不错的点子但是担心费时费力，那么你要知道，任何一个点子其实都要花费精力。</p>

<h4>窍门</h4>

<p>　　当寻找创业点子时，从你擅长的领域开始是个不错的选择。如果你是个数据库专家，那么就不要想着为年轻人开发一款聊天应用，就算这是个不错的点子，你也不能相信自己的判断，而对那些跟数据库有关系的点子，你可以充分相信自己的判断力。如果你觉得在数据库领域想个好主意有点困难，那是因为你的知识体系提高了你的标准，这其实是一种邓宁-克鲁格效应，即认知偏差现象。</p>

<p>　　从你需要的地方寻找点子是最有效的。</p>

<p>　　一般来说，问问自己是不是有什么东西让自己的需要和别人不同，与众不同是非常好的。</p>

<p>　　如果你改变了点子，想想是否发现了任何需求，一些大的创业公司就是这样起步的，Hotmail就是因为它的创始人在日常工作中记下了一些关于之前创业公司的点子而开始的。</p>

<p>　　保持年轻是不同寻常的特别方法，最有价值的新点子往往来自人的青年时代。只有年轻人才知道自己同辈人最需要什么，如果没在大学校园中呆过，很难想象会有创建Facebook的点子。所以如果你是年轻创业者，那么想想有没有你和你的朋友想做但是目前技术并没有提供帮助的东西。</p>

<p>　　一种确保你解决好别人难题的方法就是把这些问题当做自己的，当Rajat Suri 决定做一款餐厅软件的时候，他找了个招待的工作去了解餐厅是如何运作的。这看起来有点极端，不过创业就意味着极致。</p>

<p>　　事实上，发现好的点子不只是关掉这些筛选条件，而是寻找那些不吸引人和让人感到困难的点子，一个好的方法是，问问自己希望别人做些什么你可以使用，你愿意付钱。</p>

<p>　　创业之初，往往选择为那些规模较小但是又很重要的用户服务，如果是那些大公司不屑的领域就更好了，因为这往往会误导他们的判断。举例来说，在斯蒂夫•沃兹尼亚克(Steve Wozniak)开发出苹果一代之后，他觉得有义务告诉他当时的雇主惠普公司，不过幸运的是，惠普拒绝了他，理由之一是惠普当时使用电视机作为显示器。</p>

<p>　　寻找创业点子是一门非常微秒的学问，这也是绝大多数尝试的人都失败的原因。单纯地思考创业点子并没有很大效果，最有效的方法往往是更为间接的：如果你有好的行业背景，好的创业点子可能容易想到，不过这也不是立即就会有的。注意到缺少什么会花费很长时间。</p>

<p>　　生活在未来，做有趣的事，听起来可能很奇怪，不过这才是真正的创业良方。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[javascript遇上的几个问题]]></title>
    <link href="http://ajia.github.com/blog/2013/04/03/javascriptpan-duan-fang-fa-shi-fou-cun-zai/"/>
    <updated>2013-04-03T14:11:00+08:00</updated>
    <id>http://ajia.github.com/blog/2013/04/03/javascriptpan-duan-fang-fa-shi-fou-cun-zai</id>
    <content type="html"><![CDATA[<h3>判断方法存不存在</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'>  <span class="k">if</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="nx">nl</span><span class="p">.</span><span class="nx">onBlue</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;function&quot;</span><span class="p">){</span>
</span><span class='line'>      <span class="c1">//存在</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">else</span><span class="p">{</span>
</span><span class='line'>      <span class="c1">//不存在</span>
</span><span class='line'>  <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>把字符串转换成对象</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;{id:&quot;1&quot;,name:&quot;aaaa&quot;}&#39;</span><span class="p">;</span>
</span><span class='line'><span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;var obj=&quot;</span><span class="o">+</span><span class="nx">str</span><span class="p">);</span>
</span><span class='line'><span class="nx">alert</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<!--more-->


<h3>jquery-ui的DatePicker用法</h3>

<h5>配置如下</h5>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">(</span> <span class="s2">&quot;#birthday&quot;</span> <span class="p">).</span><span class="nx">datepicker</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">dateFormat</span><span class="o">:</span> <span class="s2">&quot;yy-mm-dd&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">yearRange</span><span class="o">:</span> <span class="s2">&quot;1940:2000&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">changeMonth</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">changeYear</span><span class="o">:</span> <span class="kc">true</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h5>下面是中文的datepicker</h5>

<figure class='code'><figcaption><span> (jquery-ui-datepicker.js)</span> <a href='http://ajia.github.com/downloads/code/jquery-ui-datepicker.js'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
<span class='line-number'>201</span>
<span class='line-number'>202</span>
<span class='line-number'>203</span>
<span class='line-number'>204</span>
<span class='line-number'>205</span>
<span class='line-number'>206</span>
<span class='line-number'>207</span>
<span class='line-number'>208</span>
<span class='line-number'>209</span>
<span class='line-number'>210</span>
<span class='line-number'>211</span>
<span class='line-number'>212</span>
<span class='line-number'>213</span>
<span class='line-number'>214</span>
<span class='line-number'>215</span>
<span class='line-number'>216</span>
<span class='line-number'>217</span>
<span class='line-number'>218</span>
<span class='line-number'>219</span>
<span class='line-number'>220</span>
<span class='line-number'>221</span>
<span class='line-number'>222</span>
<span class='line-number'>223</span>
<span class='line-number'>224</span>
<span class='line-number'>225</span>
<span class='line-number'>226</span>
<span class='line-number'>227</span>
<span class='line-number'>228</span>
<span class='line-number'>229</span>
<span class='line-number'>230</span>
<span class='line-number'>231</span>
<span class='line-number'>232</span>
<span class='line-number'>233</span>
<span class='line-number'>234</span>
<span class='line-number'>235</span>
<span class='line-number'>236</span>
<span class='line-number'>237</span>
<span class='line-number'>238</span>
<span class='line-number'>239</span>
<span class='line-number'>240</span>
<span class='line-number'>241</span>
<span class='line-number'>242</span>
<span class='line-number'>243</span>
<span class='line-number'>244</span>
<span class='line-number'>245</span>
<span class='line-number'>246</span>
<span class='line-number'>247</span>
<span class='line-number'>248</span>
<span class='line-number'>249</span>
<span class='line-number'>250</span>
<span class='line-number'>251</span>
<span class='line-number'>252</span>
<span class='line-number'>253</span>
<span class='line-number'>254</span>
<span class='line-number'>255</span>
<span class='line-number'>256</span>
<span class='line-number'>257</span>
<span class='line-number'>258</span>
<span class='line-number'>259</span>
<span class='line-number'>260</span>
<span class='line-number'>261</span>
<span class='line-number'>262</span>
<span class='line-number'>263</span>
<span class='line-number'>264</span>
<span class='line-number'>265</span>
<span class='line-number'>266</span>
<span class='line-number'>267</span>
<span class='line-number'>268</span>
<span class='line-number'>269</span>
<span class='line-number'>270</span>
<span class='line-number'>271</span>
<span class='line-number'>272</span>
<span class='line-number'>273</span>
<span class='line-number'>274</span>
<span class='line-number'>275</span>
<span class='line-number'>276</span>
<span class='line-number'>277</span>
<span class='line-number'>278</span>
<span class='line-number'>279</span>
<span class='line-number'>280</span>
<span class='line-number'>281</span>
<span class='line-number'>282</span>
<span class='line-number'>283</span>
<span class='line-number'>284</span>
<span class='line-number'>285</span>
<span class='line-number'>286</span>
<span class='line-number'>287</span>
<span class='line-number'>288</span>
<span class='line-number'>289</span>
<span class='line-number'>290</span>
<span class='line-number'>291</span>
<span class='line-number'>292</span>
<span class='line-number'>293</span>
<span class='line-number'>294</span>
<span class='line-number'>295</span>
<span class='line-number'>296</span>
<span class='line-number'>297</span>
<span class='line-number'>298</span>
<span class='line-number'>299</span>
<span class='line-number'>300</span>
<span class='line-number'>301</span>
<span class='line-number'>302</span>
<span class='line-number'>303</span>
<span class='line-number'>304</span>
<span class='line-number'>305</span>
<span class='line-number'>306</span>
<span class='line-number'>307</span>
<span class='line-number'>308</span>
<span class='line-number'>309</span>
<span class='line-number'>310</span>
<span class='line-number'>311</span>
<span class='line-number'>312</span>
<span class='line-number'>313</span>
<span class='line-number'>314</span>
<span class='line-number'>315</span>
<span class='line-number'>316</span>
<span class='line-number'>317</span>
<span class='line-number'>318</span>
<span class='line-number'>319</span>
<span class='line-number'>320</span>
<span class='line-number'>321</span>
<span class='line-number'>322</span>
<span class='line-number'>323</span>
<span class='line-number'>324</span>
<span class='line-number'>325</span>
<span class='line-number'>326</span>
<span class='line-number'>327</span>
<span class='line-number'>328</span>
<span class='line-number'>329</span>
<span class='line-number'>330</span>
<span class='line-number'>331</span>
<span class='line-number'>332</span>
<span class='line-number'>333</span>
<span class='line-number'>334</span>
<span class='line-number'>335</span>
<span class='line-number'>336</span>
<span class='line-number'>337</span>
<span class='line-number'>338</span>
<span class='line-number'>339</span>
<span class='line-number'>340</span>
<span class='line-number'>341</span>
<span class='line-number'>342</span>
<span class='line-number'>343</span>
<span class='line-number'>344</span>
<span class='line-number'>345</span>
<span class='line-number'>346</span>
<span class='line-number'>347</span>
<span class='line-number'>348</span>
<span class='line-number'>349</span>
<span class='line-number'>350</span>
<span class='line-number'>351</span>
<span class='line-number'>352</span>
<span class='line-number'>353</span>
<span class='line-number'>354</span>
<span class='line-number'>355</span>
<span class='line-number'>356</span>
<span class='line-number'>357</span>
<span class='line-number'>358</span>
<span class='line-number'>359</span>
<span class='line-number'>360</span>
<span class='line-number'>361</span>
<span class='line-number'>362</span>
<span class='line-number'>363</span>
<span class='line-number'>364</span>
<span class='line-number'>365</span>
<span class='line-number'>366</span>
<span class='line-number'>367</span>
<span class='line-number'>368</span>
<span class='line-number'>369</span>
<span class='line-number'>370</span>
<span class='line-number'>371</span>
<span class='line-number'>372</span>
<span class='line-number'>373</span>
<span class='line-number'>374</span>
<span class='line-number'>375</span>
<span class='line-number'>376</span>
<span class='line-number'>377</span>
<span class='line-number'>378</span>
<span class='line-number'>379</span>
<span class='line-number'>380</span>
<span class='line-number'>381</span>
<span class='line-number'>382</span>
<span class='line-number'>383</span>
<span class='line-number'>384</span>
<span class='line-number'>385</span>
<span class='line-number'>386</span>
<span class='line-number'>387</span>
<span class='line-number'>388</span>
<span class='line-number'>389</span>
<span class='line-number'>390</span>
<span class='line-number'>391</span>
<span class='line-number'>392</span>
<span class='line-number'>393</span>
<span class='line-number'>394</span>
<span class='line-number'>395</span>
<span class='line-number'>396</span>
<span class='line-number'>397</span>
<span class='line-number'>398</span>
<span class='line-number'>399</span>
<span class='line-number'>400</span>
<span class='line-number'>401</span>
<span class='line-number'>402</span>
<span class='line-number'>403</span>
<span class='line-number'>404</span>
<span class='line-number'>405</span>
<span class='line-number'>406</span>
<span class='line-number'>407</span>
<span class='line-number'>408</span>
<span class='line-number'>409</span>
<span class='line-number'>410</span>
<span class='line-number'>411</span>
<span class='line-number'>412</span>
<span class='line-number'>413</span>
<span class='line-number'>414</span>
<span class='line-number'>415</span>
<span class='line-number'>416</span>
<span class='line-number'>417</span>
<span class='line-number'>418</span>
<span class='line-number'>419</span>
<span class='line-number'>420</span>
<span class='line-number'>421</span>
<span class='line-number'>422</span>
<span class='line-number'>423</span>
<span class='line-number'>424</span>
<span class='line-number'>425</span>
<span class='line-number'>426</span>
<span class='line-number'>427</span>
<span class='line-number'>428</span>
<span class='line-number'>429</span>
<span class='line-number'>430</span>
<span class='line-number'>431</span>
<span class='line-number'>432</span>
<span class='line-number'>433</span>
<span class='line-number'>434</span>
<span class='line-number'>435</span>
<span class='line-number'>436</span>
<span class='line-number'>437</span>
<span class='line-number'>438</span>
<span class='line-number'>439</span>
<span class='line-number'>440</span>
<span class='line-number'>441</span>
<span class='line-number'>442</span>
<span class='line-number'>443</span>
<span class='line-number'>444</span>
<span class='line-number'>445</span>
<span class='line-number'>446</span>
<span class='line-number'>447</span>
<span class='line-number'>448</span>
<span class='line-number'>449</span>
<span class='line-number'>450</span>
<span class='line-number'>451</span>
<span class='line-number'>452</span>
<span class='line-number'>453</span>
<span class='line-number'>454</span>
<span class='line-number'>455</span>
<span class='line-number'>456</span>
<span class='line-number'>457</span>
<span class='line-number'>458</span>
<span class='line-number'>459</span>
<span class='line-number'>460</span>
<span class='line-number'>461</span>
<span class='line-number'>462</span>
<span class='line-number'>463</span>
<span class='line-number'>464</span>
<span class='line-number'>465</span>
<span class='line-number'>466</span>
<span class='line-number'>467</span>
<span class='line-number'>468</span>
<span class='line-number'>469</span>
<span class='line-number'>470</span>
<span class='line-number'>471</span>
<span class='line-number'>472</span>
<span class='line-number'>473</span>
<span class='line-number'>474</span>
<span class='line-number'>475</span>
<span class='line-number'>476</span>
<span class='line-number'>477</span>
<span class='line-number'>478</span>
<span class='line-number'>479</span>
<span class='line-number'>480</span>
<span class='line-number'>481</span>
<span class='line-number'>482</span>
<span class='line-number'>483</span>
<span class='line-number'>484</span>
<span class='line-number'>485</span>
<span class='line-number'>486</span>
<span class='line-number'>487</span>
<span class='line-number'>488</span>
<span class='line-number'>489</span>
<span class='line-number'>490</span>
<span class='line-number'>491</span>
<span class='line-number'>492</span>
<span class='line-number'>493</span>
<span class='line-number'>494</span>
<span class='line-number'>495</span>
<span class='line-number'>496</span>
<span class='line-number'>497</span>
<span class='line-number'>498</span>
<span class='line-number'>499</span>
<span class='line-number'>500</span>
<span class='line-number'>501</span>
<span class='line-number'>502</span>
<span class='line-number'>503</span>
<span class='line-number'>504</span>
<span class='line-number'>505</span>
<span class='line-number'>506</span>
<span class='line-number'>507</span>
<span class='line-number'>508</span>
<span class='line-number'>509</span>
<span class='line-number'>510</span>
<span class='line-number'>511</span>
<span class='line-number'>512</span>
<span class='line-number'>513</span>
<span class='line-number'>514</span>
<span class='line-number'>515</span>
<span class='line-number'>516</span>
<span class='line-number'>517</span>
<span class='line-number'>518</span>
<span class='line-number'>519</span>
<span class='line-number'>520</span>
<span class='line-number'>521</span>
<span class='line-number'>522</span>
<span class='line-number'>523</span>
<span class='line-number'>524</span>
<span class='line-number'>525</span>
<span class='line-number'>526</span>
<span class='line-number'>527</span>
<span class='line-number'>528</span>
<span class='line-number'>529</span>
<span class='line-number'>530</span>
<span class='line-number'>531</span>
<span class='line-number'>532</span>
<span class='line-number'>533</span>
<span class='line-number'>534</span>
<span class='line-number'>535</span>
<span class='line-number'>536</span>
<span class='line-number'>537</span>
<span class='line-number'>538</span>
<span class='line-number'>539</span>
<span class='line-number'>540</span>
<span class='line-number'>541</span>
<span class='line-number'>542</span>
<span class='line-number'>543</span>
<span class='line-number'>544</span>
<span class='line-number'>545</span>
<span class='line-number'>546</span>
<span class='line-number'>547</span>
<span class='line-number'>548</span>
<span class='line-number'>549</span>
<span class='line-number'>550</span>
<span class='line-number'>551</span>
<span class='line-number'>552</span>
<span class='line-number'>553</span>
<span class='line-number'>554</span>
<span class='line-number'>555</span>
<span class='line-number'>556</span>
<span class='line-number'>557</span>
<span class='line-number'>558</span>
<span class='line-number'>559</span>
<span class='line-number'>560</span>
<span class='line-number'>561</span>
<span class='line-number'>562</span>
<span class='line-number'>563</span>
<span class='line-number'>564</span>
<span class='line-number'>565</span>
<span class='line-number'>566</span>
<span class='line-number'>567</span>
<span class='line-number'>568</span>
<span class='line-number'>569</span>
<span class='line-number'>570</span>
<span class='line-number'>571</span>
<span class='line-number'>572</span>
<span class='line-number'>573</span>
<span class='line-number'>574</span>
<span class='line-number'>575</span>
<span class='line-number'>576</span>
<span class='line-number'>577</span>
<span class='line-number'>578</span>
<span class='line-number'>579</span>
<span class='line-number'>580</span>
<span class='line-number'>581</span>
<span class='line-number'>582</span>
<span class='line-number'>583</span>
<span class='line-number'>584</span>
<span class='line-number'>585</span>
<span class='line-number'>586</span>
<span class='line-number'>587</span>
<span class='line-number'>588</span>
<span class='line-number'>589</span>
<span class='line-number'>590</span>
<span class='line-number'>591</span>
<span class='line-number'>592</span>
<span class='line-number'>593</span>
<span class='line-number'>594</span>
<span class='line-number'>595</span>
<span class='line-number'>596</span>
<span class='line-number'>597</span>
<span class='line-number'>598</span>
<span class='line-number'>599</span>
<span class='line-number'>600</span>
<span class='line-number'>601</span>
<span class='line-number'>602</span>
<span class='line-number'>603</span>
<span class='line-number'>604</span>
<span class='line-number'>605</span>
<span class='line-number'>606</span>
<span class='line-number'>607</span>
<span class='line-number'>608</span>
<span class='line-number'>609</span>
<span class='line-number'>610</span>
<span class='line-number'>611</span>
<span class='line-number'>612</span>
<span class='line-number'>613</span>
<span class='line-number'>614</span>
<span class='line-number'>615</span>
<span class='line-number'>616</span>
<span class='line-number'>617</span>
<span class='line-number'>618</span>
<span class='line-number'>619</span>
<span class='line-number'>620</span>
<span class='line-number'>621</span>
<span class='line-number'>622</span>
<span class='line-number'>623</span>
<span class='line-number'>624</span>
<span class='line-number'>625</span>
<span class='line-number'>626</span>
<span class='line-number'>627</span>
<span class='line-number'>628</span>
<span class='line-number'>629</span>
<span class='line-number'>630</span>
<span class='line-number'>631</span>
<span class='line-number'>632</span>
<span class='line-number'>633</span>
<span class='line-number'>634</span>
<span class='line-number'>635</span>
<span class='line-number'>636</span>
<span class='line-number'>637</span>
<span class='line-number'>638</span>
<span class='line-number'>639</span>
<span class='line-number'>640</span>
<span class='line-number'>641</span>
<span class='line-number'>642</span>
<span class='line-number'>643</span>
<span class='line-number'>644</span>
<span class='line-number'>645</span>
<span class='line-number'>646</span>
<span class='line-number'>647</span>
<span class='line-number'>648</span>
<span class='line-number'>649</span>
<span class='line-number'>650</span>
<span class='line-number'>651</span>
<span class='line-number'>652</span>
<span class='line-number'>653</span>
<span class='line-number'>654</span>
<span class='line-number'>655</span>
<span class='line-number'>656</span>
<span class='line-number'>657</span>
<span class='line-number'>658</span>
<span class='line-number'>659</span>
<span class='line-number'>660</span>
<span class='line-number'>661</span>
<span class='line-number'>662</span>
<span class='line-number'>663</span>
<span class='line-number'>664</span>
<span class='line-number'>665</span>
<span class='line-number'>666</span>
<span class='line-number'>667</span>
<span class='line-number'>668</span>
<span class='line-number'>669</span>
<span class='line-number'>670</span>
<span class='line-number'>671</span>
<span class='line-number'>672</span>
<span class='line-number'>673</span>
<span class='line-number'>674</span>
<span class='line-number'>675</span>
<span class='line-number'>676</span>
<span class='line-number'>677</span>
<span class='line-number'>678</span>
<span class='line-number'>679</span>
<span class='line-number'>680</span>
<span class='line-number'>681</span>
<span class='line-number'>682</span>
<span class='line-number'>683</span>
<span class='line-number'>684</span>
<span class='line-number'>685</span>
<span class='line-number'>686</span>
<span class='line-number'>687</span>
<span class='line-number'>688</span>
<span class='line-number'>689</span>
<span class='line-number'>690</span>
<span class='line-number'>691</span>
<span class='line-number'>692</span>
<span class='line-number'>693</span>
<span class='line-number'>694</span>
<span class='line-number'>695</span>
<span class='line-number'>696</span>
<span class='line-number'>697</span>
<span class='line-number'>698</span>
<span class='line-number'>699</span>
<span class='line-number'>700</span>
<span class='line-number'>701</span>
<span class='line-number'>702</span>
<span class='line-number'>703</span>
<span class='line-number'>704</span>
<span class='line-number'>705</span>
<span class='line-number'>706</span>
<span class='line-number'>707</span>
<span class='line-number'>708</span>
<span class='line-number'>709</span>
<span class='line-number'>710</span>
<span class='line-number'>711</span>
<span class='line-number'>712</span>
<span class='line-number'>713</span>
<span class='line-number'>714</span>
<span class='line-number'>715</span>
<span class='line-number'>716</span>
<span class='line-number'>717</span>
<span class='line-number'>718</span>
<span class='line-number'>719</span>
<span class='line-number'>720</span>
<span class='line-number'>721</span>
<span class='line-number'>722</span>
<span class='line-number'>723</span>
<span class='line-number'>724</span>
<span class='line-number'>725</span>
<span class='line-number'>726</span>
<span class='line-number'>727</span>
<span class='line-number'>728</span>
<span class='line-number'>729</span>
<span class='line-number'>730</span>
<span class='line-number'>731</span>
<span class='line-number'>732</span>
<span class='line-number'>733</span>
<span class='line-number'>734</span>
<span class='line-number'>735</span>
<span class='line-number'>736</span>
<span class='line-number'>737</span>
<span class='line-number'>738</span>
<span class='line-number'>739</span>
<span class='line-number'>740</span>
<span class='line-number'>741</span>
<span class='line-number'>742</span>
<span class='line-number'>743</span>
<span class='line-number'>744</span>
<span class='line-number'>745</span>
<span class='line-number'>746</span>
<span class='line-number'>747</span>
<span class='line-number'>748</span>
<span class='line-number'>749</span>
<span class='line-number'>750</span>
<span class='line-number'>751</span>
<span class='line-number'>752</span>
<span class='line-number'>753</span>
<span class='line-number'>754</span>
<span class='line-number'>755</span>
<span class='line-number'>756</span>
<span class='line-number'>757</span>
<span class='line-number'>758</span>
<span class='line-number'>759</span>
<span class='line-number'>760</span>
<span class='line-number'>761</span>
<span class='line-number'>762</span>
<span class='line-number'>763</span>
<span class='line-number'>764</span>
<span class='line-number'>765</span>
<span class='line-number'>766</span>
<span class='line-number'>767</span>
<span class='line-number'>768</span>
<span class='line-number'>769</span>
<span class='line-number'>770</span>
<span class='line-number'>771</span>
<span class='line-number'>772</span>
<span class='line-number'>773</span>
<span class='line-number'>774</span>
<span class='line-number'>775</span>
<span class='line-number'>776</span>
<span class='line-number'>777</span>
<span class='line-number'>778</span>
<span class='line-number'>779</span>
<span class='line-number'>780</span>
<span class='line-number'>781</span>
<span class='line-number'>782</span>
<span class='line-number'>783</span>
<span class='line-number'>784</span>
<span class='line-number'>785</span>
<span class='line-number'>786</span>
<span class='line-number'>787</span>
<span class='line-number'>788</span>
<span class='line-number'>789</span>
<span class='line-number'>790</span>
<span class='line-number'>791</span>
<span class='line-number'>792</span>
<span class='line-number'>793</span>
<span class='line-number'>794</span>
<span class='line-number'>795</span>
<span class='line-number'>796</span>
<span class='line-number'>797</span>
<span class='line-number'>798</span>
<span class='line-number'>799</span>
<span class='line-number'>800</span>
<span class='line-number'>801</span>
<span class='line-number'>802</span>
<span class='line-number'>803</span>
<span class='line-number'>804</span>
<span class='line-number'>805</span>
<span class='line-number'>806</span>
<span class='line-number'>807</span>
<span class='line-number'>808</span>
<span class='line-number'>809</span>
<span class='line-number'>810</span>
<span class='line-number'>811</span>
<span class='line-number'>812</span>
<span class='line-number'>813</span>
<span class='line-number'>814</span>
<span class='line-number'>815</span>
<span class='line-number'>816</span>
<span class='line-number'>817</span>
<span class='line-number'>818</span>
<span class='line-number'>819</span>
<span class='line-number'>820</span>
<span class='line-number'>821</span>
<span class='line-number'>822</span>
<span class='line-number'>823</span>
<span class='line-number'>824</span>
<span class='line-number'>825</span>
<span class='line-number'>826</span>
<span class='line-number'>827</span>
<span class='line-number'>828</span>
<span class='line-number'>829</span>
<span class='line-number'>830</span>
<span class='line-number'>831</span>
<span class='line-number'>832</span>
<span class='line-number'>833</span>
<span class='line-number'>834</span>
<span class='line-number'>835</span>
<span class='line-number'>836</span>
<span class='line-number'>837</span>
<span class='line-number'>838</span>
<span class='line-number'>839</span>
<span class='line-number'>840</span>
<span class='line-number'>841</span>
<span class='line-number'>842</span>
<span class='line-number'>843</span>
<span class='line-number'>844</span>
<span class='line-number'>845</span>
<span class='line-number'>846</span>
<span class='line-number'>847</span>
<span class='line-number'>848</span>
<span class='line-number'>849</span>
<span class='line-number'>850</span>
<span class='line-number'>851</span>
<span class='line-number'>852</span>
<span class='line-number'>853</span>
<span class='line-number'>854</span>
<span class='line-number'>855</span>
<span class='line-number'>856</span>
<span class='line-number'>857</span>
<span class='line-number'>858</span>
<span class='line-number'>859</span>
<span class='line-number'>860</span>
<span class='line-number'>861</span>
<span class='line-number'>862</span>
<span class='line-number'>863</span>
<span class='line-number'>864</span>
<span class='line-number'>865</span>
<span class='line-number'>866</span>
<span class='line-number'>867</span>
<span class='line-number'>868</span>
<span class='line-number'>869</span>
<span class='line-number'>870</span>
<span class='line-number'>871</span>
<span class='line-number'>872</span>
<span class='line-number'>873</span>
<span class='line-number'>874</span>
<span class='line-number'>875</span>
<span class='line-number'>876</span>
<span class='line-number'>877</span>
<span class='line-number'>878</span>
<span class='line-number'>879</span>
<span class='line-number'>880</span>
<span class='line-number'>881</span>
<span class='line-number'>882</span>
<span class='line-number'>883</span>
<span class='line-number'>884</span>
<span class='line-number'>885</span>
<span class='line-number'>886</span>
<span class='line-number'>887</span>
<span class='line-number'>888</span>
<span class='line-number'>889</span>
<span class='line-number'>890</span>
<span class='line-number'>891</span>
<span class='line-number'>892</span>
<span class='line-number'>893</span>
<span class='line-number'>894</span>
<span class='line-number'>895</span>
<span class='line-number'>896</span>
<span class='line-number'>897</span>
<span class='line-number'>898</span>
<span class='line-number'>899</span>
<span class='line-number'>900</span>
<span class='line-number'>901</span>
<span class='line-number'>902</span>
<span class='line-number'>903</span>
<span class='line-number'>904</span>
<span class='line-number'>905</span>
<span class='line-number'>906</span>
<span class='line-number'>907</span>
<span class='line-number'>908</span>
<span class='line-number'>909</span>
<span class='line-number'>910</span>
<span class='line-number'>911</span>
<span class='line-number'>912</span>
<span class='line-number'>913</span>
<span class='line-number'>914</span>
<span class='line-number'>915</span>
<span class='line-number'>916</span>
<span class='line-number'>917</span>
<span class='line-number'>918</span>
<span class='line-number'>919</span>
<span class='line-number'>920</span>
<span class='line-number'>921</span>
<span class='line-number'>922</span>
<span class='line-number'>923</span>
<span class='line-number'>924</span>
<span class='line-number'>925</span>
<span class='line-number'>926</span>
<span class='line-number'>927</span>
<span class='line-number'>928</span>
<span class='line-number'>929</span>
<span class='line-number'>930</span>
<span class='line-number'>931</span>
<span class='line-number'>932</span>
<span class='line-number'>933</span>
<span class='line-number'>934</span>
<span class='line-number'>935</span>
<span class='line-number'>936</span>
<span class='line-number'>937</span>
<span class='line-number'>938</span>
<span class='line-number'>939</span>
<span class='line-number'>940</span>
<span class='line-number'>941</span>
<span class='line-number'>942</span>
<span class='line-number'>943</span>
<span class='line-number'>944</span>
<span class='line-number'>945</span>
<span class='line-number'>946</span>
<span class='line-number'>947</span>
<span class='line-number'>948</span>
<span class='line-number'>949</span>
<span class='line-number'>950</span>
<span class='line-number'>951</span>
<span class='line-number'>952</span>
<span class='line-number'>953</span>
<span class='line-number'>954</span>
<span class='line-number'>955</span>
<span class='line-number'>956</span>
<span class='line-number'>957</span>
<span class='line-number'>958</span>
<span class='line-number'>959</span>
<span class='line-number'>960</span>
<span class='line-number'>961</span>
<span class='line-number'>962</span>
<span class='line-number'>963</span>
<span class='line-number'>964</span>
<span class='line-number'>965</span>
<span class='line-number'>966</span>
<span class='line-number'>967</span>
<span class='line-number'>968</span>
<span class='line-number'>969</span>
<span class='line-number'>970</span>
<span class='line-number'>971</span>
<span class='line-number'>972</span>
<span class='line-number'>973</span>
<span class='line-number'>974</span>
<span class='line-number'>975</span>
<span class='line-number'>976</span>
<span class='line-number'>977</span>
<span class='line-number'>978</span>
<span class='line-number'>979</span>
<span class='line-number'>980</span>
<span class='line-number'>981</span>
<span class='line-number'>982</span>
<span class='line-number'>983</span>
<span class='line-number'>984</span>
<span class='line-number'>985</span>
<span class='line-number'>986</span>
<span class='line-number'>987</span>
<span class='line-number'>988</span>
<span class='line-number'>989</span>
<span class='line-number'>990</span>
<span class='line-number'>991</span>
<span class='line-number'>992</span>
<span class='line-number'>993</span>
<span class='line-number'>994</span>
<span class='line-number'>995</span>
<span class='line-number'>996</span>
<span class='line-number'>997</span>
<span class='line-number'>998</span>
<span class='line-number'>999</span>
<span class='line-number'>1000</span>
<span class='line-number'>1001</span>
<span class='line-number'>1002</span>
<span class='line-number'>1003</span>
<span class='line-number'>1004</span>
<span class='line-number'>1005</span>
<span class='line-number'>1006</span>
<span class='line-number'>1007</span>
<span class='line-number'>1008</span>
<span class='line-number'>1009</span>
<span class='line-number'>1010</span>
<span class='line-number'>1011</span>
<span class='line-number'>1012</span>
<span class='line-number'>1013</span>
<span class='line-number'>1014</span>
<span class='line-number'>1015</span>
<span class='line-number'>1016</span>
<span class='line-number'>1017</span>
<span class='line-number'>1018</span>
<span class='line-number'>1019</span>
<span class='line-number'>1020</span>
<span class='line-number'>1021</span>
<span class='line-number'>1022</span>
<span class='line-number'>1023</span>
<span class='line-number'>1024</span>
<span class='line-number'>1025</span>
<span class='line-number'>1026</span>
<span class='line-number'>1027</span>
<span class='line-number'>1028</span>
<span class='line-number'>1029</span>
<span class='line-number'>1030</span>
<span class='line-number'>1031</span>
<span class='line-number'>1032</span>
<span class='line-number'>1033</span>
<span class='line-number'>1034</span>
<span class='line-number'>1035</span>
<span class='line-number'>1036</span>
<span class='line-number'>1037</span>
<span class='line-number'>1038</span>
<span class='line-number'>1039</span>
<span class='line-number'>1040</span>
<span class='line-number'>1041</span>
<span class='line-number'>1042</span>
<span class='line-number'>1043</span>
<span class='line-number'>1044</span>
<span class='line-number'>1045</span>
<span class='line-number'>1046</span>
<span class='line-number'>1047</span>
<span class='line-number'>1048</span>
<span class='line-number'>1049</span>
<span class='line-number'>1050</span>
<span class='line-number'>1051</span>
<span class='line-number'>1052</span>
<span class='line-number'>1053</span>
<span class='line-number'>1054</span>
<span class='line-number'>1055</span>
<span class='line-number'>1056</span>
<span class='line-number'>1057</span>
<span class='line-number'>1058</span>
<span class='line-number'>1059</span>
<span class='line-number'>1060</span>
<span class='line-number'>1061</span>
<span class='line-number'>1062</span>
<span class='line-number'>1063</span>
<span class='line-number'>1064</span>
<span class='line-number'>1065</span>
<span class='line-number'>1066</span>
<span class='line-number'>1067</span>
<span class='line-number'>1068</span>
<span class='line-number'>1069</span>
<span class='line-number'>1070</span>
<span class='line-number'>1071</span>
<span class='line-number'>1072</span>
<span class='line-number'>1073</span>
<span class='line-number'>1074</span>
<span class='line-number'>1075</span>
<span class='line-number'>1076</span>
<span class='line-number'>1077</span>
<span class='line-number'>1078</span>
<span class='line-number'>1079</span>
<span class='line-number'>1080</span>
<span class='line-number'>1081</span>
<span class='line-number'>1082</span>
<span class='line-number'>1083</span>
<span class='line-number'>1084</span>
<span class='line-number'>1085</span>
<span class='line-number'>1086</span>
<span class='line-number'>1087</span>
<span class='line-number'>1088</span>
<span class='line-number'>1089</span>
<span class='line-number'>1090</span>
<span class='line-number'>1091</span>
<span class='line-number'>1092</span>
<span class='line-number'>1093</span>
<span class='line-number'>1094</span>
<span class='line-number'>1095</span>
<span class='line-number'>1096</span>
<span class='line-number'>1097</span>
<span class='line-number'>1098</span>
<span class='line-number'>1099</span>
<span class='line-number'>1100</span>
<span class='line-number'>1101</span>
<span class='line-number'>1102</span>
<span class='line-number'>1103</span>
<span class='line-number'>1104</span>
<span class='line-number'>1105</span>
<span class='line-number'>1106</span>
<span class='line-number'>1107</span>
<span class='line-number'>1108</span>
<span class='line-number'>1109</span>
<span class='line-number'>1110</span>
<span class='line-number'>1111</span>
<span class='line-number'>1112</span>
<span class='line-number'>1113</span>
<span class='line-number'>1114</span>
<span class='line-number'>1115</span>
<span class='line-number'>1116</span>
<span class='line-number'>1117</span>
<span class='line-number'>1118</span>
<span class='line-number'>1119</span>
<span class='line-number'>1120</span>
<span class='line-number'>1121</span>
<span class='line-number'>1122</span>
<span class='line-number'>1123</span>
<span class='line-number'>1124</span>
<span class='line-number'>1125</span>
<span class='line-number'>1126</span>
<span class='line-number'>1127</span>
<span class='line-number'>1128</span>
<span class='line-number'>1129</span>
<span class='line-number'>1130</span>
<span class='line-number'>1131</span>
<span class='line-number'>1132</span>
<span class='line-number'>1133</span>
<span class='line-number'>1134</span>
<span class='line-number'>1135</span>
<span class='line-number'>1136</span>
<span class='line-number'>1137</span>
<span class='line-number'>1138</span>
<span class='line-number'>1139</span>
<span class='line-number'>1140</span>
<span class='line-number'>1141</span>
<span class='line-number'>1142</span>
<span class='line-number'>1143</span>
<span class='line-number'>1144</span>
<span class='line-number'>1145</span>
<span class='line-number'>1146</span>
<span class='line-number'>1147</span>
<span class='line-number'>1148</span>
<span class='line-number'>1149</span>
<span class='line-number'>1150</span>
<span class='line-number'>1151</span>
<span class='line-number'>1152</span>
<span class='line-number'>1153</span>
<span class='line-number'>1154</span>
<span class='line-number'>1155</span>
<span class='line-number'>1156</span>
<span class='line-number'>1157</span>
<span class='line-number'>1158</span>
<span class='line-number'>1159</span>
<span class='line-number'>1160</span>
<span class='line-number'>1161</span>
<span class='line-number'>1162</span>
<span class='line-number'>1163</span>
<span class='line-number'>1164</span>
<span class='line-number'>1165</span>
<span class='line-number'>1166</span>
<span class='line-number'>1167</span>
<span class='line-number'>1168</span>
<span class='line-number'>1169</span>
<span class='line-number'>1170</span>
<span class='line-number'>1171</span>
<span class='line-number'>1172</span>
<span class='line-number'>1173</span>
<span class='line-number'>1174</span>
<span class='line-number'>1175</span>
<span class='line-number'>1176</span>
<span class='line-number'>1177</span>
<span class='line-number'>1178</span>
<span class='line-number'>1179</span>
<span class='line-number'>1180</span>
<span class='line-number'>1181</span>
<span class='line-number'>1182</span>
<span class='line-number'>1183</span>
<span class='line-number'>1184</span>
<span class='line-number'>1185</span>
<span class='line-number'>1186</span>
<span class='line-number'>1187</span>
<span class='line-number'>1188</span>
<span class='line-number'>1189</span>
<span class='line-number'>1190</span>
<span class='line-number'>1191</span>
<span class='line-number'>1192</span>
<span class='line-number'>1193</span>
<span class='line-number'>1194</span>
<span class='line-number'>1195</span>
<span class='line-number'>1196</span>
<span class='line-number'>1197</span>
<span class='line-number'>1198</span>
<span class='line-number'>1199</span>
<span class='line-number'>1200</span>
<span class='line-number'>1201</span>
<span class='line-number'>1202</span>
<span class='line-number'>1203</span>
<span class='line-number'>1204</span>
<span class='line-number'>1205</span>
<span class='line-number'>1206</span>
<span class='line-number'>1207</span>
<span class='line-number'>1208</span>
<span class='line-number'>1209</span>
<span class='line-number'>1210</span>
<span class='line-number'>1211</span>
<span class='line-number'>1212</span>
<span class='line-number'>1213</span>
<span class='line-number'>1214</span>
<span class='line-number'>1215</span>
<span class='line-number'>1216</span>
<span class='line-number'>1217</span>
<span class='line-number'>1218</span>
<span class='line-number'>1219</span>
<span class='line-number'>1220</span>
<span class='line-number'>1221</span>
<span class='line-number'>1222</span>
<span class='line-number'>1223</span>
<span class='line-number'>1224</span>
<span class='line-number'>1225</span>
<span class='line-number'>1226</span>
<span class='line-number'>1227</span>
<span class='line-number'>1228</span>
<span class='line-number'>1229</span>
<span class='line-number'>1230</span>
<span class='line-number'>1231</span>
<span class='line-number'>1232</span>
<span class='line-number'>1233</span>
<span class='line-number'>1234</span>
<span class='line-number'>1235</span>
<span class='line-number'>1236</span>
<span class='line-number'>1237</span>
<span class='line-number'>1238</span>
<span class='line-number'>1239</span>
<span class='line-number'>1240</span>
<span class='line-number'>1241</span>
<span class='line-number'>1242</span>
<span class='line-number'>1243</span>
<span class='line-number'>1244</span>
<span class='line-number'>1245</span>
<span class='line-number'>1246</span>
<span class='line-number'>1247</span>
<span class='line-number'>1248</span>
<span class='line-number'>1249</span>
<span class='line-number'>1250</span>
<span class='line-number'>1251</span>
<span class='line-number'>1252</span>
<span class='line-number'>1253</span>
<span class='line-number'>1254</span>
<span class='line-number'>1255</span>
<span class='line-number'>1256</span>
<span class='line-number'>1257</span>
<span class='line-number'>1258</span>
<span class='line-number'>1259</span>
<span class='line-number'>1260</span>
<span class='line-number'>1261</span>
<span class='line-number'>1262</span>
<span class='line-number'>1263</span>
<span class='line-number'>1264</span>
<span class='line-number'>1265</span>
<span class='line-number'>1266</span>
<span class='line-number'>1267</span>
<span class='line-number'>1268</span>
<span class='line-number'>1269</span>
<span class='line-number'>1270</span>
<span class='line-number'>1271</span>
<span class='line-number'>1272</span>
<span class='line-number'>1273</span>
<span class='line-number'>1274</span>
<span class='line-number'>1275</span>
<span class='line-number'>1276</span>
<span class='line-number'>1277</span>
<span class='line-number'>1278</span>
<span class='line-number'>1279</span>
<span class='line-number'>1280</span>
<span class='line-number'>1281</span>
<span class='line-number'>1282</span>
<span class='line-number'>1283</span>
<span class='line-number'>1284</span>
<span class='line-number'>1285</span>
<span class='line-number'>1286</span>
<span class='line-number'>1287</span>
<span class='line-number'>1288</span>
<span class='line-number'>1289</span>
<span class='line-number'>1290</span>
<span class='line-number'>1291</span>
<span class='line-number'>1292</span>
<span class='line-number'>1293</span>
<span class='line-number'>1294</span>
<span class='line-number'>1295</span>
<span class='line-number'>1296</span>
<span class='line-number'>1297</span>
<span class='line-number'>1298</span>
<span class='line-number'>1299</span>
<span class='line-number'>1300</span>
<span class='line-number'>1301</span>
<span class='line-number'>1302</span>
<span class='line-number'>1303</span>
<span class='line-number'>1304</span>
<span class='line-number'>1305</span>
<span class='line-number'>1306</span>
<span class='line-number'>1307</span>
<span class='line-number'>1308</span>
<span class='line-number'>1309</span>
<span class='line-number'>1310</span>
<span class='line-number'>1311</span>
<span class='line-number'>1312</span>
<span class='line-number'>1313</span>
<span class='line-number'>1314</span>
<span class='line-number'>1315</span>
<span class='line-number'>1316</span>
<span class='line-number'>1317</span>
<span class='line-number'>1318</span>
<span class='line-number'>1319</span>
<span class='line-number'>1320</span>
<span class='line-number'>1321</span>
<span class='line-number'>1322</span>
<span class='line-number'>1323</span>
<span class='line-number'>1324</span>
<span class='line-number'>1325</span>
<span class='line-number'>1326</span>
<span class='line-number'>1327</span>
<span class='line-number'>1328</span>
<span class='line-number'>1329</span>
<span class='line-number'>1330</span>
<span class='line-number'>1331</span>
<span class='line-number'>1332</span>
<span class='line-number'>1333</span>
<span class='line-number'>1334</span>
<span class='line-number'>1335</span>
<span class='line-number'>1336</span>
<span class='line-number'>1337</span>
<span class='line-number'>1338</span>
<span class='line-number'>1339</span>
<span class='line-number'>1340</span>
<span class='line-number'>1341</span>
<span class='line-number'>1342</span>
<span class='line-number'>1343</span>
<span class='line-number'>1344</span>
<span class='line-number'>1345</span>
<span class='line-number'>1346</span>
<span class='line-number'>1347</span>
<span class='line-number'>1348</span>
<span class='line-number'>1349</span>
<span class='line-number'>1350</span>
<span class='line-number'>1351</span>
<span class='line-number'>1352</span>
<span class='line-number'>1353</span>
<span class='line-number'>1354</span>
<span class='line-number'>1355</span>
<span class='line-number'>1356</span>
<span class='line-number'>1357</span>
<span class='line-number'>1358</span>
<span class='line-number'>1359</span>
<span class='line-number'>1360</span>
<span class='line-number'>1361</span>
<span class='line-number'>1362</span>
<span class='line-number'>1363</span>
<span class='line-number'>1364</span>
<span class='line-number'>1365</span>
<span class='line-number'>1366</span>
<span class='line-number'>1367</span>
<span class='line-number'>1368</span>
<span class='line-number'>1369</span>
<span class='line-number'>1370</span>
<span class='line-number'>1371</span>
<span class='line-number'>1372</span>
<span class='line-number'>1373</span>
<span class='line-number'>1374</span>
<span class='line-number'>1375</span>
<span class='line-number'>1376</span>
<span class='line-number'>1377</span>
<span class='line-number'>1378</span>
<span class='line-number'>1379</span>
<span class='line-number'>1380</span>
<span class='line-number'>1381</span>
<span class='line-number'>1382</span>
<span class='line-number'>1383</span>
<span class='line-number'>1384</span>
<span class='line-number'>1385</span>
<span class='line-number'>1386</span>
<span class='line-number'>1387</span>
<span class='line-number'>1388</span>
<span class='line-number'>1389</span>
<span class='line-number'>1390</span>
<span class='line-number'>1391</span>
<span class='line-number'>1392</span>
<span class='line-number'>1393</span>
<span class='line-number'>1394</span>
<span class='line-number'>1395</span>
<span class='line-number'>1396</span>
<span class='line-number'>1397</span>
<span class='line-number'>1398</span>
<span class='line-number'>1399</span>
<span class='line-number'>1400</span>
<span class='line-number'>1401</span>
<span class='line-number'>1402</span>
<span class='line-number'>1403</span>
<span class='line-number'>1404</span>
<span class='line-number'>1405</span>
<span class='line-number'>1406</span>
<span class='line-number'>1407</span>
<span class='line-number'>1408</span>
<span class='line-number'>1409</span>
<span class='line-number'>1410</span>
<span class='line-number'>1411</span>
<span class='line-number'>1412</span>
<span class='line-number'>1413</span>
<span class='line-number'>1414</span>
<span class='line-number'>1415</span>
<span class='line-number'>1416</span>
<span class='line-number'>1417</span>
<span class='line-number'>1418</span>
<span class='line-number'>1419</span>
<span class='line-number'>1420</span>
<span class='line-number'>1421</span>
<span class='line-number'>1422</span>
<span class='line-number'>1423</span>
<span class='line-number'>1424</span>
<span class='line-number'>1425</span>
<span class='line-number'>1426</span>
<span class='line-number'>1427</span>
<span class='line-number'>1428</span>
<span class='line-number'>1429</span>
<span class='line-number'>1430</span>
<span class='line-number'>1431</span>
<span class='line-number'>1432</span>
<span class='line-number'>1433</span>
<span class='line-number'>1434</span>
<span class='line-number'>1435</span>
<span class='line-number'>1436</span>
<span class='line-number'>1437</span>
<span class='line-number'>1438</span>
<span class='line-number'>1439</span>
<span class='line-number'>1440</span>
<span class='line-number'>1441</span>
<span class='line-number'>1442</span>
<span class='line-number'>1443</span>
<span class='line-number'>1444</span>
<span class='line-number'>1445</span>
<span class='line-number'>1446</span>
<span class='line-number'>1447</span>
<span class='line-number'>1448</span>
<span class='line-number'>1449</span>
<span class='line-number'>1450</span>
<span class='line-number'>1451</span>
<span class='line-number'>1452</span>
<span class='line-number'>1453</span>
<span class='line-number'>1454</span>
<span class='line-number'>1455</span>
<span class='line-number'>1456</span>
<span class='line-number'>1457</span>
<span class='line-number'>1458</span>
<span class='line-number'>1459</span>
<span class='line-number'>1460</span>
<span class='line-number'>1461</span>
<span class='line-number'>1462</span>
<span class='line-number'>1463</span>
<span class='line-number'>1464</span>
<span class='line-number'>1465</span>
<span class='line-number'>1466</span>
<span class='line-number'>1467</span>
<span class='line-number'>1468</span>
<span class='line-number'>1469</span>
<span class='line-number'>1470</span>
<span class='line-number'>1471</span>
<span class='line-number'>1472</span>
<span class='line-number'>1473</span>
<span class='line-number'>1474</span>
<span class='line-number'>1475</span>
<span class='line-number'>1476</span>
<span class='line-number'>1477</span>
<span class='line-number'>1478</span>
<span class='line-number'>1479</span>
<span class='line-number'>1480</span>
<span class='line-number'>1481</span>
<span class='line-number'>1482</span>
<span class='line-number'>1483</span>
<span class='line-number'>1484</span>
<span class='line-number'>1485</span>
<span class='line-number'>1486</span>
<span class='line-number'>1487</span>
<span class='line-number'>1488</span>
<span class='line-number'>1489</span>
<span class='line-number'>1490</span>
<span class='line-number'>1491</span>
<span class='line-number'>1492</span>
<span class='line-number'>1493</span>
<span class='line-number'>1494</span>
<span class='line-number'>1495</span>
<span class='line-number'>1496</span>
<span class='line-number'>1497</span>
<span class='line-number'>1498</span>
<span class='line-number'>1499</span>
<span class='line-number'>1500</span>
<span class='line-number'>1501</span>
<span class='line-number'>1502</span>
<span class='line-number'>1503</span>
<span class='line-number'>1504</span>
<span class='line-number'>1505</span>
<span class='line-number'>1506</span>
<span class='line-number'>1507</span>
<span class='line-number'>1508</span>
<span class='line-number'>1509</span>
<span class='line-number'>1510</span>
<span class='line-number'>1511</span>
<span class='line-number'>1512</span>
<span class='line-number'>1513</span>
<span class='line-number'>1514</span>
<span class='line-number'>1515</span>
<span class='line-number'>1516</span>
<span class='line-number'>1517</span>
<span class='line-number'>1518</span>
<span class='line-number'>1519</span>
<span class='line-number'>1520</span>
<span class='line-number'>1521</span>
<span class='line-number'>1522</span>
<span class='line-number'>1523</span>
<span class='line-number'>1524</span>
<span class='line-number'>1525</span>
<span class='line-number'>1526</span>
<span class='line-number'>1527</span>
<span class='line-number'>1528</span>
<span class='line-number'>1529</span>
<span class='line-number'>1530</span>
<span class='line-number'>1531</span>
<span class='line-number'>1532</span>
<span class='line-number'>1533</span>
<span class='line-number'>1534</span>
<span class='line-number'>1535</span>
<span class='line-number'>1536</span>
<span class='line-number'>1537</span>
<span class='line-number'>1538</span>
<span class='line-number'>1539</span>
<span class='line-number'>1540</span>
<span class='line-number'>1541</span>
<span class='line-number'>1542</span>
<span class='line-number'>1543</span>
<span class='line-number'>1544</span>
<span class='line-number'>1545</span>
<span class='line-number'>1546</span>
<span class='line-number'>1547</span>
<span class='line-number'>1548</span>
<span class='line-number'>1549</span>
<span class='line-number'>1550</span>
<span class='line-number'>1551</span>
<span class='line-number'>1552</span>
<span class='line-number'>1553</span>
<span class='line-number'>1554</span>
<span class='line-number'>1555</span>
<span class='line-number'>1556</span>
<span class='line-number'>1557</span>
<span class='line-number'>1558</span>
<span class='line-number'>1559</span>
<span class='line-number'>1560</span>
<span class='line-number'>1561</span>
<span class='line-number'>1562</span>
<span class='line-number'>1563</span>
<span class='line-number'>1564</span>
<span class='line-number'>1565</span>
<span class='line-number'>1566</span>
<span class='line-number'>1567</span>
<span class='line-number'>1568</span>
<span class='line-number'>1569</span>
<span class='line-number'>1570</span>
<span class='line-number'>1571</span>
<span class='line-number'>1572</span>
<span class='line-number'>1573</span>
<span class='line-number'>1574</span>
<span class='line-number'>1575</span>
<span class='line-number'>1576</span>
<span class='line-number'>1577</span>
<span class='line-number'>1578</span>
<span class='line-number'>1579</span>
<span class='line-number'>1580</span>
<span class='line-number'>1581</span>
<span class='line-number'>1582</span>
<span class='line-number'>1583</span>
<span class='line-number'>1584</span>
<span class='line-number'>1585</span>
<span class='line-number'>1586</span>
<span class='line-number'>1587</span>
<span class='line-number'>1588</span>
<span class='line-number'>1589</span>
<span class='line-number'>1590</span>
<span class='line-number'>1591</span>
<span class='line-number'>1592</span>
<span class='line-number'>1593</span>
<span class='line-number'>1594</span>
<span class='line-number'>1595</span>
<span class='line-number'>1596</span>
<span class='line-number'>1597</span>
<span class='line-number'>1598</span>
<span class='line-number'>1599</span>
<span class='line-number'>1600</span>
<span class='line-number'>1601</span>
<span class='line-number'>1602</span>
<span class='line-number'>1603</span>
<span class='line-number'>1604</span>
<span class='line-number'>1605</span>
<span class='line-number'>1606</span>
<span class='line-number'>1607</span>
<span class='line-number'>1608</span>
<span class='line-number'>1609</span>
<span class='line-number'>1610</span>
<span class='line-number'>1611</span>
<span class='line-number'>1612</span>
<span class='line-number'>1613</span>
<span class='line-number'>1614</span>
<span class='line-number'>1615</span>
<span class='line-number'>1616</span>
<span class='line-number'>1617</span>
<span class='line-number'>1618</span>
<span class='line-number'>1619</span>
<span class='line-number'>1620</span>
<span class='line-number'>1621</span>
<span class='line-number'>1622</span>
<span class='line-number'>1623</span>
<span class='line-number'>1624</span>
<span class='line-number'>1625</span>
<span class='line-number'>1626</span>
<span class='line-number'>1627</span>
<span class='line-number'>1628</span>
<span class='line-number'>1629</span>
<span class='line-number'>1630</span>
<span class='line-number'>1631</span>
<span class='line-number'>1632</span>
<span class='line-number'>1633</span>
<span class='line-number'>1634</span>
<span class='line-number'>1635</span>
<span class='line-number'>1636</span>
<span class='line-number'>1637</span>
<span class='line-number'>1638</span>
<span class='line-number'>1639</span>
<span class='line-number'>1640</span>
<span class='line-number'>1641</span>
<span class='line-number'>1642</span>
<span class='line-number'>1643</span>
<span class='line-number'>1644</span>
<span class='line-number'>1645</span>
<span class='line-number'>1646</span>
<span class='line-number'>1647</span>
<span class='line-number'>1648</span>
<span class='line-number'>1649</span>
<span class='line-number'>1650</span>
<span class='line-number'>1651</span>
<span class='line-number'>1652</span>
<span class='line-number'>1653</span>
<span class='line-number'>1654</span>
<span class='line-number'>1655</span>
<span class='line-number'>1656</span>
<span class='line-number'>1657</span>
<span class='line-number'>1658</span>
<span class='line-number'>1659</span>
<span class='line-number'>1660</span>
<span class='line-number'>1661</span>
<span class='line-number'>1662</span>
<span class='line-number'>1663</span>
<span class='line-number'>1664</span>
<span class='line-number'>1665</span>
<span class='line-number'>1666</span>
<span class='line-number'>1667</span>
<span class='line-number'>1668</span>
<span class='line-number'>1669</span>
<span class='line-number'>1670</span>
<span class='line-number'>1671</span>
<span class='line-number'>1672</span>
<span class='line-number'>1673</span>
<span class='line-number'>1674</span>
<span class='line-number'>1675</span>
<span class='line-number'>1676</span>
<span class='line-number'>1677</span>
<span class='line-number'>1678</span>
<span class='line-number'>1679</span>
<span class='line-number'>1680</span>
<span class='line-number'>1681</span>
<span class='line-number'>1682</span>
<span class='line-number'>1683</span>
<span class='line-number'>1684</span>
<span class='line-number'>1685</span>
<span class='line-number'>1686</span>
<span class='line-number'>1687</span>
<span class='line-number'>1688</span>
<span class='line-number'>1689</span>
<span class='line-number'>1690</span>
<span class='line-number'>1691</span>
<span class='line-number'>1692</span>
<span class='line-number'>1693</span>
<span class='line-number'>1694</span>
<span class='line-number'>1695</span>
<span class='line-number'>1696</span>
<span class='line-number'>1697</span>
<span class='line-number'>1698</span>
<span class='line-number'>1699</span>
<span class='line-number'>1700</span>
<span class='line-number'>1701</span>
<span class='line-number'>1702</span>
<span class='line-number'>1703</span>
<span class='line-number'>1704</span>
<span class='line-number'>1705</span>
<span class='line-number'>1706</span>
<span class='line-number'>1707</span>
<span class='line-number'>1708</span>
<span class='line-number'>1709</span>
<span class='line-number'>1710</span>
<span class='line-number'>1711</span>
<span class='line-number'>1712</span>
<span class='line-number'>1713</span>
<span class='line-number'>1714</span>
<span class='line-number'>1715</span>
<span class='line-number'>1716</span>
<span class='line-number'>1717</span>
<span class='line-number'>1718</span>
<span class='line-number'>1719</span>
<span class='line-number'>1720</span>
<span class='line-number'>1721</span>
<span class='line-number'>1722</span>
<span class='line-number'>1723</span>
<span class='line-number'>1724</span>
<span class='line-number'>1725</span>
<span class='line-number'>1726</span>
<span class='line-number'>1727</span>
<span class='line-number'>1728</span>
<span class='line-number'>1729</span>
<span class='line-number'>1730</span>
<span class='line-number'>1731</span>
<span class='line-number'>1732</span>
<span class='line-number'>1733</span>
<span class='line-number'>1734</span>
<span class='line-number'>1735</span>
<span class='line-number'>1736</span>
<span class='line-number'>1737</span>
<span class='line-number'>1738</span>
<span class='line-number'>1739</span>
<span class='line-number'>1740</span>
<span class='line-number'>1741</span>
<span class='line-number'>1742</span>
<span class='line-number'>1743</span>
<span class='line-number'>1744</span>
<span class='line-number'>1745</span>
<span class='line-number'>1746</span>
<span class='line-number'>1747</span>
<span class='line-number'>1748</span>
<span class='line-number'>1749</span>
<span class='line-number'>1750</span>
<span class='line-number'>1751</span>
<span class='line-number'>1752</span>
<span class='line-number'>1753</span>
<span class='line-number'>1754</span>
<span class='line-number'>1755</span>
<span class='line-number'>1756</span>
<span class='line-number'>1757</span>
<span class='line-number'>1758</span>
<span class='line-number'>1759</span>
<span class='line-number'>1760</span>
<span class='line-number'>1761</span>
<span class='line-number'>1762</span>
<span class='line-number'>1763</span>
<span class='line-number'>1764</span>
<span class='line-number'>1765</span>
<span class='line-number'>1766</span>
<span class='line-number'>1767</span>
<span class='line-number'>1768</span>
<span class='line-number'>1769</span>
<span class='line-number'>1770</span>
<span class='line-number'>1771</span>
<span class='line-number'>1772</span>
<span class='line-number'>1773</span>
<span class='line-number'>1774</span>
<span class='line-number'>1775</span>
<span class='line-number'>1776</span>
<span class='line-number'>1777</span>
<span class='line-number'>1778</span>
<span class='line-number'>1779</span>
<span class='line-number'>1780</span>
<span class='line-number'>1781</span>
<span class='line-number'>1782</span>
<span class='line-number'>1783</span>
<span class='line-number'>1784</span>
<span class='line-number'>1785</span>
<span class='line-number'>1786</span>
<span class='line-number'>1787</span>
<span class='line-number'>1788</span>
<span class='line-number'>1789</span>
<span class='line-number'>1790</span>
<span class='line-number'>1791</span>
<span class='line-number'>1792</span>
<span class='line-number'>1793</span>
<span class='line-number'>1794</span>
<span class='line-number'>1795</span>
<span class='line-number'>1796</span>
<span class='line-number'>1797</span>
<span class='line-number'>1798</span>
<span class='line-number'>1799</span>
<span class='line-number'>1800</span>
<span class='line-number'>1801</span>
<span class='line-number'>1802</span>
<span class='line-number'>1803</span>
<span class='line-number'>1804</span>
<span class='line-number'>1805</span>
<span class='line-number'>1806</span>
<span class='line-number'>1807</span>
<span class='line-number'>1808</span>
<span class='line-number'>1809</span>
<span class='line-number'>1810</span>
<span class='line-number'>1811</span>
<span class='line-number'>1812</span>
<span class='line-number'>1813</span>
<span class='line-number'>1814</span>
<span class='line-number'>1815</span>
<span class='line-number'>1816</span>
<span class='line-number'>1817</span>
<span class='line-number'>1818</span>
<span class='line-number'>1819</span>
<span class='line-number'>1820</span>
<span class='line-number'>1821</span>
<span class='line-number'>1822</span>
<span class='line-number'>1823</span>
<span class='line-number'>1824</span>
<span class='line-number'>1825</span>
<span class='line-number'>1826</span>
<span class='line-number'>1827</span>
<span class='line-number'>1828</span>
<span class='line-number'>1829</span>
<span class='line-number'>1830</span>
<span class='line-number'>1831</span>
<span class='line-number'>1832</span>
<span class='line-number'>1833</span>
<span class='line-number'>1834</span>
<span class='line-number'>1835</span>
<span class='line-number'>1836</span>
<span class='line-number'>1837</span>
<span class='line-number'>1838</span>
<span class='line-number'>1839</span>
<span class='line-number'>1840</span>
<span class='line-number'>1841</span>
<span class='line-number'>1842</span>
<span class='line-number'>1843</span>
<span class='line-number'>1844</span>
<span class='line-number'>1845</span>
<span class='line-number'>1846</span>
<span class='line-number'>1847</span>
<span class='line-number'>1848</span>
<span class='line-number'>1849</span>
<span class='line-number'>1850</span>
<span class='line-number'>1851</span>
<span class='line-number'>1852</span>
<span class='line-number'>1853</span>
<span class='line-number'>1854</span>
<span class='line-number'>1855</span>
<span class='line-number'>1856</span>
<span class='line-number'>1857</span>
<span class='line-number'>1858</span>
<span class='line-number'>1859</span>
<span class='line-number'>1860</span>
<span class='line-number'>1861</span>
<span class='line-number'>1862</span>
<span class='line-number'>1863</span>
<span class='line-number'>1864</span>
<span class='line-number'>1865</span>
<span class='line-number'>1866</span>
<span class='line-number'>1867</span>
<span class='line-number'>1868</span>
<span class='line-number'>1869</span>
<span class='line-number'>1870</span>
<span class='line-number'>1871</span>
<span class='line-number'>1872</span>
<span class='line-number'>1873</span>
<span class='line-number'>1874</span>
<span class='line-number'>1875</span>
<span class='line-number'>1876</span>
<span class='line-number'>1877</span>
<span class='line-number'>1878</span>
<span class='line-number'>1879</span>
<span class='line-number'>1880</span>
<span class='line-number'>1881</span>
<span class='line-number'>1882</span>
<span class='line-number'>1883</span>
<span class='line-number'>1884</span>
<span class='line-number'>1885</span>
<span class='line-number'>1886</span>
<span class='line-number'>1887</span>
<span class='line-number'>1888</span>
<span class='line-number'>1889</span>
<span class='line-number'>1890</span>
<span class='line-number'>1891</span>
<span class='line-number'>1892</span>
<span class='line-number'>1893</span>
<span class='line-number'>1894</span>
<span class='line-number'>1895</span>
<span class='line-number'>1896</span>
<span class='line-number'>1897</span>
<span class='line-number'>1898</span>
<span class='line-number'>1899</span>
<span class='line-number'>1900</span>
<span class='line-number'>1901</span>
<span class='line-number'>1902</span>
<span class='line-number'>1903</span>
<span class='line-number'>1904</span>
<span class='line-number'>1905</span>
<span class='line-number'>1906</span>
<span class='line-number'>1907</span>
<span class='line-number'>1908</span>
<span class='line-number'>1909</span>
<span class='line-number'>1910</span>
<span class='line-number'>1911</span>
<span class='line-number'>1912</span>
<span class='line-number'>1913</span>
<span class='line-number'>1914</span>
<span class='line-number'>1915</span>
<span class='line-number'>1916</span>
<span class='line-number'>1917</span>
<span class='line-number'>1918</span>
<span class='line-number'>1919</span>
<span class='line-number'>1920</span>
<span class='line-number'>1921</span>
<span class='line-number'>1922</span>
<span class='line-number'>1923</span>
<span class='line-number'>1924</span>
<span class='line-number'>1925</span>
<span class='line-number'>1926</span>
<span class='line-number'>1927</span>
<span class='line-number'>1928</span>
<span class='line-number'>1929</span>
<span class='line-number'>1930</span>
<span class='line-number'>1931</span>
<span class='line-number'>1932</span>
<span class='line-number'>1933</span>
<span class='line-number'>1934</span>
<span class='line-number'>1935</span>
<span class='line-number'>1936</span>
<span class='line-number'>1937</span>
<span class='line-number'>1938</span>
<span class='line-number'>1939</span>
<span class='line-number'>1940</span>
<span class='line-number'>1941</span>
<span class='line-number'>1942</span>
<span class='line-number'>1943</span>
<span class='line-number'>1944</span>
<span class='line-number'>1945</span>
<span class='line-number'>1946</span>
<span class='line-number'>1947</span>
<span class='line-number'>1948</span>
<span class='line-number'>1949</span>
<span class='line-number'>1950</span>
<span class='line-number'>1951</span>
<span class='line-number'>1952</span>
<span class='line-number'>1953</span>
<span class='line-number'>1954</span>
<span class='line-number'>1955</span>
<span class='line-number'>1956</span>
<span class='line-number'>1957</span>
<span class='line-number'>1958</span>
<span class='line-number'>1959</span>
<span class='line-number'>1960</span>
<span class='line-number'>1961</span>
<span class='line-number'>1962</span>
<span class='line-number'>1963</span>
<span class='line-number'>1964</span>
<span class='line-number'>1965</span>
<span class='line-number'>1966</span>
<span class='line-number'>1967</span>
<span class='line-number'>1968</span>
<span class='line-number'>1969</span>
<span class='line-number'>1970</span>
<span class='line-number'>1971</span>
<span class='line-number'>1972</span>
<span class='line-number'>1973</span>
<span class='line-number'>1974</span>
<span class='line-number'>1975</span>
<span class='line-number'>1976</span>
<span class='line-number'>1977</span>
<span class='line-number'>1978</span>
<span class='line-number'>1979</span>
<span class='line-number'>1980</span>
<span class='line-number'>1981</span>
<span class='line-number'>1982</span>
<span class='line-number'>1983</span>
<span class='line-number'>1984</span>
<span class='line-number'>1985</span>
<span class='line-number'>1986</span>
<span class='line-number'>1987</span>
<span class='line-number'>1988</span>
<span class='line-number'>1989</span>
<span class='line-number'>1990</span>
<span class='line-number'>1991</span>
<span class='line-number'>1992</span>
<span class='line-number'>1993</span>
<span class='line-number'>1994</span>
<span class='line-number'>1995</span>
<span class='line-number'>1996</span>
<span class='line-number'>1997</span>
<span class='line-number'>1998</span>
<span class='line-number'>1999</span>
<span class='line-number'>2000</span>
<span class='line-number'>2001</span>
<span class='line-number'>2002</span>
<span class='line-number'>2003</span>
<span class='line-number'>2004</span>
<span class='line-number'>2005</span>
<span class='line-number'>2006</span>
<span class='line-number'>2007</span>
<span class='line-number'>2008</span>
<span class='line-number'>2009</span>
<span class='line-number'>2010</span>
<span class='line-number'>2011</span>
<span class='line-number'>2012</span>
<span class='line-number'>2013</span>
<span class='line-number'>2014</span>
<span class='line-number'>2015</span>
<span class='line-number'>2016</span>
<span class='line-number'>2017</span>
<span class='line-number'>2018</span>
<span class='line-number'>2019</span>
<span class='line-number'>2020</span>
<span class='line-number'>2021</span>
<span class='line-number'>2022</span>
<span class='line-number'>2023</span>
<span class='line-number'>2024</span>
<span class='line-number'>2025</span>
<span class='line-number'>2026</span>
<span class='line-number'>2027</span>
<span class='line-number'>2028</span>
<span class='line-number'>2029</span>
<span class='line-number'>2030</span>
<span class='line-number'>2031</span>
<span class='line-number'>2032</span>
<span class='line-number'>2033</span>
<span class='line-number'>2034</span>
<span class='line-number'>2035</span>
<span class='line-number'>2036</span>
<span class='line-number'>2037</span>
<span class='line-number'>2038</span>
<span class='line-number'>2039</span>
<span class='line-number'>2040</span>
<span class='line-number'>2041</span>
<span class='line-number'>2042</span>
<span class='line-number'>2043</span>
<span class='line-number'>2044</span>
<span class='line-number'>2045</span>
<span class='line-number'>2046</span>
<span class='line-number'>2047</span>
<span class='line-number'>2048</span>
<span class='line-number'>2049</span>
<span class='line-number'>2050</span>
<span class='line-number'>2051</span>
<span class='line-number'>2052</span>
<span class='line-number'>2053</span>
<span class='line-number'>2054</span>
<span class='line-number'>2055</span>
<span class='line-number'>2056</span>
<span class='line-number'>2057</span>
<span class='line-number'>2058</span>
<span class='line-number'>2059</span>
<span class='line-number'>2060</span>
<span class='line-number'>2061</span>
<span class='line-number'>2062</span>
<span class='line-number'>2063</span>
<span class='line-number'>2064</span>
<span class='line-number'>2065</span>
<span class='line-number'>2066</span>
<span class='line-number'>2067</span>
<span class='line-number'>2068</span>
<span class='line-number'>2069</span>
<span class='line-number'>2070</span>
<span class='line-number'>2071</span>
<span class='line-number'>2072</span>
<span class='line-number'>2073</span>
<span class='line-number'>2074</span>
<span class='line-number'>2075</span>
<span class='line-number'>2076</span>
<span class='line-number'>2077</span>
<span class='line-number'>2078</span>
<span class='line-number'>2079</span>
<span class='line-number'>2080</span>
<span class='line-number'>2081</span>
<span class='line-number'>2082</span>
<span class='line-number'>2083</span>
<span class='line-number'>2084</span>
<span class='line-number'>2085</span>
<span class='line-number'>2086</span>
<span class='line-number'>2087</span>
<span class='line-number'>2088</span>
<span class='line-number'>2089</span>
<span class='line-number'>2090</span>
<span class='line-number'>2091</span>
<span class='line-number'>2092</span>
<span class='line-number'>2093</span>
<span class='line-number'>2094</span>
<span class='line-number'>2095</span>
<span class='line-number'>2096</span>
<span class='line-number'>2097</span>
<span class='line-number'>2098</span>
<span class='line-number'>2099</span>
<span class='line-number'>2100</span>
<span class='line-number'>2101</span>
<span class='line-number'>2102</span>
<span class='line-number'>2103</span>
<span class='line-number'>2104</span>
<span class='line-number'>2105</span>
<span class='line-number'>2106</span>
<span class='line-number'>2107</span>
<span class='line-number'>2108</span>
<span class='line-number'>2109</span>
<span class='line-number'>2110</span>
<span class='line-number'>2111</span>
<span class='line-number'>2112</span>
<span class='line-number'>2113</span>
<span class='line-number'>2114</span>
<span class='line-number'>2115</span>
<span class='line-number'>2116</span>
<span class='line-number'>2117</span>
<span class='line-number'>2118</span>
<span class='line-number'>2119</span>
<span class='line-number'>2120</span>
<span class='line-number'>2121</span>
<span class='line-number'>2122</span>
<span class='line-number'>2123</span>
<span class='line-number'>2124</span>
<span class='line-number'>2125</span>
<span class='line-number'>2126</span>
<span class='line-number'>2127</span>
<span class='line-number'>2128</span>
<span class='line-number'>2129</span>
<span class='line-number'>2130</span>
<span class='line-number'>2131</span>
<span class='line-number'>2132</span>
<span class='line-number'>2133</span>
<span class='line-number'>2134</span>
<span class='line-number'>2135</span>
<span class='line-number'>2136</span>
<span class='line-number'>2137</span>
<span class='line-number'>2138</span>
<span class='line-number'>2139</span>
<span class='line-number'>2140</span>
<span class='line-number'>2141</span>
<span class='line-number'>2142</span>
<span class='line-number'>2143</span>
<span class='line-number'>2144</span>
<span class='line-number'>2145</span>
<span class='line-number'>2146</span>
<span class='line-number'>2147</span>
<span class='line-number'>2148</span>
<span class='line-number'>2149</span>
<span class='line-number'>2150</span>
<span class='line-number'>2151</span>
<span class='line-number'>2152</span>
<span class='line-number'>2153</span>
<span class='line-number'>2154</span>
<span class='line-number'>2155</span>
<span class='line-number'>2156</span>
<span class='line-number'>2157</span>
<span class='line-number'>2158</span>
<span class='line-number'>2159</span>
<span class='line-number'>2160</span>
<span class='line-number'>2161</span>
<span class='line-number'>2162</span>
<span class='line-number'>2163</span>
<span class='line-number'>2164</span>
<span class='line-number'>2165</span>
<span class='line-number'>2166</span>
<span class='line-number'>2167</span>
<span class='line-number'>2168</span>
<span class='line-number'>2169</span>
<span class='line-number'>2170</span>
<span class='line-number'>2171</span>
<span class='line-number'>2172</span>
<span class='line-number'>2173</span>
<span class='line-number'>2174</span>
<span class='line-number'>2175</span>
<span class='line-number'>2176</span>
<span class='line-number'>2177</span>
<span class='line-number'>2178</span>
<span class='line-number'>2179</span>
<span class='line-number'>2180</span>
<span class='line-number'>2181</span>
<span class='line-number'>2182</span>
<span class='line-number'>2183</span>
<span class='line-number'>2184</span>
<span class='line-number'>2185</span>
<span class='line-number'>2186</span>
<span class='line-number'>2187</span>
<span class='line-number'>2188</span>
<span class='line-number'>2189</span>
<span class='line-number'>2190</span>
<span class='line-number'>2191</span>
<span class='line-number'>2192</span>
<span class='line-number'>2193</span>
<span class='line-number'>2194</span>
<span class='line-number'>2195</span>
<span class='line-number'>2196</span>
<span class='line-number'>2197</span>
<span class='line-number'>2198</span>
<span class='line-number'>2199</span>
<span class='line-number'>2200</span>
<span class='line-number'>2201</span>
<span class='line-number'>2202</span>
<span class='line-number'>2203</span>
<span class='line-number'>2204</span>
<span class='line-number'>2205</span>
<span class='line-number'>2206</span>
<span class='line-number'>2207</span>
<span class='line-number'>2208</span>
<span class='line-number'>2209</span>
<span class='line-number'>2210</span>
<span class='line-number'>2211</span>
<span class='line-number'>2212</span>
<span class='line-number'>2213</span>
<span class='line-number'>2214</span>
<span class='line-number'>2215</span>
<span class='line-number'>2216</span>
<span class='line-number'>2217</span>
<span class='line-number'>2218</span>
<span class='line-number'>2219</span>
<span class='line-number'>2220</span>
<span class='line-number'>2221</span>
<span class='line-number'>2222</span>
<span class='line-number'>2223</span>
<span class='line-number'>2224</span>
<span class='line-number'>2225</span>
<span class='line-number'>2226</span>
<span class='line-number'>2227</span>
<span class='line-number'>2228</span>
<span class='line-number'>2229</span>
<span class='line-number'>2230</span>
<span class='line-number'>2231</span>
<span class='line-number'>2232</span>
<span class='line-number'>2233</span>
<span class='line-number'>2234</span>
<span class='line-number'>2235</span>
<span class='line-number'>2236</span>
<span class='line-number'>2237</span>
<span class='line-number'>2238</span>
<span class='line-number'>2239</span>
<span class='line-number'>2240</span>
<span class='line-number'>2241</span>
<span class='line-number'>2242</span>
<span class='line-number'>2243</span>
<span class='line-number'>2244</span>
<span class='line-number'>2245</span>
<span class='line-number'>2246</span>
<span class='line-number'>2247</span>
<span class='line-number'>2248</span>
<span class='line-number'>2249</span>
<span class='line-number'>2250</span>
<span class='line-number'>2251</span>
<span class='line-number'>2252</span>
<span class='line-number'>2253</span>
<span class='line-number'>2254</span>
<span class='line-number'>2255</span>
<span class='line-number'>2256</span>
<span class='line-number'>2257</span>
<span class='line-number'>2258</span>
<span class='line-number'>2259</span>
<span class='line-number'>2260</span>
<span class='line-number'>2261</span>
<span class='line-number'>2262</span>
<span class='line-number'>2263</span>
<span class='line-number'>2264</span>
<span class='line-number'>2265</span>
<span class='line-number'>2266</span>
<span class='line-number'>2267</span>
<span class='line-number'>2268</span>
<span class='line-number'>2269</span>
<span class='line-number'>2270</span>
<span class='line-number'>2271</span>
<span class='line-number'>2272</span>
<span class='line-number'>2273</span>
<span class='line-number'>2274</span>
<span class='line-number'>2275</span>
<span class='line-number'>2276</span>
<span class='line-number'>2277</span>
<span class='line-number'>2278</span>
<span class='line-number'>2279</span>
<span class='line-number'>2280</span>
<span class='line-number'>2281</span>
<span class='line-number'>2282</span>
<span class='line-number'>2283</span>
<span class='line-number'>2284</span>
<span class='line-number'>2285</span>
<span class='line-number'>2286</span>
<span class='line-number'>2287</span>
<span class='line-number'>2288</span>
<span class='line-number'>2289</span>
<span class='line-number'>2290</span>
<span class='line-number'>2291</span>
<span class='line-number'>2292</span>
<span class='line-number'>2293</span>
<span class='line-number'>2294</span>
<span class='line-number'>2295</span>
<span class='line-number'>2296</span>
<span class='line-number'>2297</span>
<span class='line-number'>2298</span>
<span class='line-number'>2299</span>
<span class='line-number'>2300</span>
<span class='line-number'>2301</span>
<span class='line-number'>2302</span>
<span class='line-number'>2303</span>
<span class='line-number'>2304</span>
<span class='line-number'>2305</span>
<span class='line-number'>2306</span>
<span class='line-number'>2307</span>
<span class='line-number'>2308</span>
<span class='line-number'>2309</span>
<span class='line-number'>2310</span>
<span class='line-number'>2311</span>
<span class='line-number'>2312</span>
<span class='line-number'>2313</span>
<span class='line-number'>2314</span>
<span class='line-number'>2315</span>
<span class='line-number'>2316</span>
<span class='line-number'>2317</span>
<span class='line-number'>2318</span>
<span class='line-number'>2319</span>
<span class='line-number'>2320</span>
<span class='line-number'>2321</span>
<span class='line-number'>2322</span>
<span class='line-number'>2323</span>
<span class='line-number'>2324</span>
<span class='line-number'>2325</span>
<span class='line-number'>2326</span>
<span class='line-number'>2327</span>
<span class='line-number'>2328</span>
<span class='line-number'>2329</span>
<span class='line-number'>2330</span>
<span class='line-number'>2331</span>
<span class='line-number'>2332</span>
<span class='line-number'>2333</span>
<span class='line-number'>2334</span>
<span class='line-number'>2335</span>
<span class='line-number'>2336</span>
<span class='line-number'>2337</span>
<span class='line-number'>2338</span>
<span class='line-number'>2339</span>
<span class='line-number'>2340</span>
<span class='line-number'>2341</span>
<span class='line-number'>2342</span>
<span class='line-number'>2343</span>
<span class='line-number'>2344</span>
<span class='line-number'>2345</span>
<span class='line-number'>2346</span>
<span class='line-number'>2347</span>
<span class='line-number'>2348</span>
<span class='line-number'>2349</span>
<span class='line-number'>2350</span>
<span class='line-number'>2351</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="cm">/*! jQuery UI - v1.10.2 - 2013-04-02</span>
</span><span class='line'><span class="cm">* http://jqueryui.com</span>
</span><span class='line'><span class="cm">* Includes: jquery.ui.core.js, jquery.ui.datepicker.js</span>
</span><span class='line'><span class="cm">* Copyright 2013 jQuery Foundation and other contributors Licensed MIT */</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nx">$</span><span class="p">,</span> <span class="kc">undefined</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">uuid</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">runiqueId</span> <span class="o">=</span> <span class="sr">/^ui-id-\d+$/</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// $.ui might exist from components with no dependencies, e.g., $.ui.position</span>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">ui</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">ui</span> <span class="o">||</span> <span class="p">{};</span>
</span><span class='line'>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span> <span class="nx">$</span><span class="p">.</span><span class="nx">ui</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">version</span><span class="o">:</span> <span class="s2">&quot;1.10.2&quot;</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">keyCode</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">BACKSPACE</span><span class="o">:</span> <span class="mi">8</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">COMMA</span><span class="o">:</span> <span class="mi">188</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">DELETE</span><span class="o">:</span> <span class="mi">46</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">DOWN</span><span class="o">:</span> <span class="mi">40</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">END</span><span class="o">:</span> <span class="mi">35</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">ENTER</span><span class="o">:</span> <span class="mi">13</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">ESCAPE</span><span class="o">:</span> <span class="mi">27</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">HOME</span><span class="o">:</span> <span class="mi">36</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">LEFT</span><span class="o">:</span> <span class="mi">37</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">NUMPAD_ADD</span><span class="o">:</span> <span class="mi">107</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">NUMPAD_DECIMAL</span><span class="o">:</span> <span class="mi">110</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">NUMPAD_DIVIDE</span><span class="o">:</span> <span class="mi">111</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">NUMPAD_ENTER</span><span class="o">:</span> <span class="mi">108</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">NUMPAD_MULTIPLY</span><span class="o">:</span> <span class="mi">106</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">NUMPAD_SUBTRACT</span><span class="o">:</span> <span class="mi">109</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">PAGE_DOWN</span><span class="o">:</span> <span class="mi">34</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">PAGE_UP</span><span class="o">:</span> <span class="mi">33</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">PERIOD</span><span class="o">:</span> <span class="mi">190</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">RIGHT</span><span class="o">:</span> <span class="mi">39</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">SPACE</span><span class="o">:</span> <span class="mi">32</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">TAB</span><span class="o">:</span> <span class="mi">9</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">UP</span><span class="o">:</span> <span class="mi">38</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// plugins</span>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">focus</span><span class="o">:</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nx">orig</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">delay</span><span class="p">,</span> <span class="nx">fn</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="k">typeof</span> <span class="nx">delay</span> <span class="o">===</span> <span class="s2">&quot;number&quot;</span> <span class="o">?</span>
</span><span class='line'>              <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>                  <span class="kd">var</span> <span class="nx">elem</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'>                  <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>                      <span class="nx">$</span><span class="p">(</span> <span class="nx">elem</span> <span class="p">).</span><span class="nx">focus</span><span class="p">();</span>
</span><span class='line'>                      <span class="k">if</span> <span class="p">(</span> <span class="nx">fn</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                          <span class="nx">fn</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="nx">elem</span> <span class="p">);</span>
</span><span class='line'>                      <span class="p">}</span>
</span><span class='line'>                  <span class="p">},</span> <span class="nx">delay</span> <span class="p">);</span>
</span><span class='line'>              <span class="p">})</span> <span class="o">:</span>
</span><span class='line'>              <span class="nx">orig</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span> <span class="p">);</span>
</span><span class='line'>      <span class="p">};</span>
</span><span class='line'>  <span class="p">})(</span> <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">focus</span> <span class="p">),</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">scrollParent</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">scrollParent</span><span class="p">;</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">((</span><span class="nx">$</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">ie</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="sr">/(static|relative)/</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">)))</span> <span class="o">||</span> <span class="p">(</span><span class="sr">/absolute/</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">)))</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">scrollParent</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">parents</span><span class="p">().</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">return</span> <span class="p">(</span><span class="sr">/(relative|absolute|fixed)/</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;position&quot;</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="sr">/(auto|scroll)/</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;overflow&quot;</span><span class="p">)</span><span class="o">+</span><span class="nx">$</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;overflow-y&quot;</span><span class="p">)</span><span class="o">+</span><span class="nx">$</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;overflow-x&quot;</span><span class="p">));</span>
</span><span class='line'>          <span class="p">}).</span><span class="nx">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">scrollParent</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">parents</span><span class="p">().</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">return</span> <span class="p">(</span><span class="sr">/(auto|scroll)/</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;overflow&quot;</span><span class="p">)</span><span class="o">+</span><span class="nx">$</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;overflow-y&quot;</span><span class="p">)</span><span class="o">+</span><span class="nx">$</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;overflow-x&quot;</span><span class="p">));</span>
</span><span class='line'>          <span class="p">}).</span><span class="nx">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">return</span> <span class="p">(</span><span class="sr">/fixed/</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">))</span> <span class="o">||</span> <span class="o">!</span><span class="nx">scrollParent</span><span class="p">.</span><span class="nx">length</span> <span class="o">?</span> <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">)</span> <span class="o">:</span> <span class="nx">scrollParent</span><span class="p">;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">zIndex</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">zIndex</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span> <span class="nx">zIndex</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span> <span class="s2">&quot;zIndex&quot;</span><span class="p">,</span> <span class="nx">zIndex</span> <span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">elem</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span> <span class="k">this</span><span class="p">[</span> <span class="mi">0</span> <span class="p">]</span> <span class="p">),</span> <span class="nx">position</span><span class="p">,</span> <span class="nx">value</span><span class="p">;</span>
</span><span class='line'>          <span class="k">while</span> <span class="p">(</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">elem</span><span class="p">[</span> <span class="mi">0</span> <span class="p">]</span> <span class="o">!==</span> <span class="nb">document</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="c1">// Ignore z-index if position is set to a value where z-index is ignored by the browser</span>
</span><span class='line'>              <span class="c1">// This makes behavior of this function consistent across browsers</span>
</span><span class='line'>              <span class="c1">// WebKit always returns auto if the element is positioned</span>
</span><span class='line'>              <span class="nx">position</span> <span class="o">=</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span> <span class="s2">&quot;position&quot;</span> <span class="p">);</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span> <span class="nx">position</span> <span class="o">===</span> <span class="s2">&quot;absolute&quot;</span> <span class="o">||</span> <span class="nx">position</span> <span class="o">===</span> <span class="s2">&quot;relative&quot;</span> <span class="o">||</span> <span class="nx">position</span> <span class="o">===</span> <span class="s2">&quot;fixed&quot;</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="c1">// IE returns 0 when zIndex is not specified</span>
</span><span class='line'>                  <span class="c1">// other browsers return a string</span>
</span><span class='line'>                  <span class="c1">// we ignore the case of nested elements with an explicit value of 0</span>
</span><span class='line'>                  <span class="c1">// &lt;div style=&quot;z-index: -10;&quot;&gt;&lt;div style=&quot;z-index: 0;&quot;&gt;&lt;/div&gt;&lt;/div&gt;</span>
</span><span class='line'>                  <span class="nx">value</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span> <span class="s2">&quot;zIndex&quot;</span> <span class="p">),</span> <span class="mi">10</span> <span class="p">);</span>
</span><span class='line'>                  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nb">isNaN</span><span class="p">(</span> <span class="nx">value</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">value</span> <span class="o">!==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                      <span class="k">return</span> <span class="nx">value</span><span class="p">;</span>
</span><span class='line'>                  <span class="p">}</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="nx">elem</span> <span class="o">=</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">parent</span><span class="p">();</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">uniqueId</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">id</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">this</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s2">&quot;ui-id-&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="o">++</span><span class="nx">uuid</span><span class="p">);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">});</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">removeUniqueId</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span> <span class="nx">runiqueId</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">id</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">$</span><span class="p">(</span> <span class="k">this</span> <span class="p">).</span><span class="nx">removeAttr</span><span class="p">(</span> <span class="s2">&quot;id&quot;</span> <span class="p">);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">});</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// selectors</span>
</span><span class='line'><span class="kd">function</span> <span class="nx">focusable</span><span class="p">(</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">isTabIndexNotNaN</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">map</span><span class="p">,</span> <span class="nx">mapName</span><span class="p">,</span> <span class="nx">img</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">nodeName</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span> <span class="s2">&quot;area&quot;</span> <span class="o">===</span> <span class="nx">nodeName</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">map</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span>
</span><span class='line'>      <span class="nx">mapName</span> <span class="o">=</span> <span class="nx">map</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">element</span><span class="p">.</span><span class="nx">href</span> <span class="o">||</span> <span class="o">!</span><span class="nx">mapName</span> <span class="o">||</span> <span class="nx">map</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="o">!==</span> <span class="s2">&quot;map&quot;</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nx">img</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span> <span class="s2">&quot;img[usemap=#&quot;</span> <span class="o">+</span> <span class="nx">mapName</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span> <span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
</span><span class='line'>      <span class="k">return</span> <span class="o">!!</span><span class="nx">img</span> <span class="o">&amp;&amp;</span> <span class="nx">visible</span><span class="p">(</span> <span class="nx">img</span> <span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">return</span> <span class="p">(</span> <span class="sr">/input|select|textarea|button|object/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span> <span class="nx">nodeName</span> <span class="p">)</span> <span class="o">?</span>
</span><span class='line'>      <span class="o">!</span><span class="nx">element</span><span class="p">.</span><span class="nx">disabled</span> <span class="o">:</span>
</span><span class='line'>      <span class="s2">&quot;a&quot;</span> <span class="o">===</span> <span class="nx">nodeName</span> <span class="o">?</span>
</span><span class='line'>          <span class="nx">element</span><span class="p">.</span><span class="nx">href</span> <span class="o">||</span> <span class="nx">isTabIndexNotNaN</span> <span class="o">:</span>
</span><span class='line'>          <span class="nx">isTabIndexNotNaN</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
</span><span class='line'>      <span class="c1">// the element and all of its ancestors must be visible</span>
</span><span class='line'>      <span class="nx">visible</span><span class="p">(</span> <span class="nx">element</span> <span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">visible</span><span class="p">(</span> <span class="nx">element</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">expr</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">visible</span><span class="p">(</span> <span class="nx">element</span> <span class="p">)</span> <span class="o">&amp;&amp;</span>
</span><span class='line'>      <span class="o">!</span><span class="nx">$</span><span class="p">(</span> <span class="nx">element</span> <span class="p">).</span><span class="nx">parents</span><span class="p">().</span><span class="nx">addBack</span><span class="p">().</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="s2">&quot;visibility&quot;</span> <span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;hidden&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}).</span><span class="nx">length</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span> <span class="nx">$</span><span class="p">.</span><span class="nx">expr</span><span class="p">[</span> <span class="s2">&quot;:&quot;</span> <span class="p">],</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">data</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">expr</span><span class="p">.</span><span class="nx">createPseudo</span> <span class="o">?</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">.</span><span class="nx">expr</span><span class="p">.</span><span class="nx">createPseudo</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nx">dataName</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">elem</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">return</span> <span class="o">!!</span><span class="nx">$</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span> <span class="nx">elem</span><span class="p">,</span> <span class="nx">dataName</span> <span class="p">);</span>
</span><span class='line'>          <span class="p">};</span>
</span><span class='line'>      <span class="p">})</span> <span class="o">:</span>
</span><span class='line'>      <span class="c1">// support: jQuery &lt;1.8</span>
</span><span class='line'>      <span class="kd">function</span><span class="p">(</span> <span class="nx">elem</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">match</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="o">!!</span><span class="nx">$</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span> <span class="nx">elem</span><span class="p">,</span> <span class="nx">match</span><span class="p">[</span> <span class="mi">3</span> <span class="p">]</span> <span class="p">);</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">focusable</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">element</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">focusable</span><span class="p">(</span> <span class="nx">element</span><span class="p">,</span> <span class="o">!</span><span class="nb">isNaN</span><span class="p">(</span> <span class="nx">$</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span> <span class="nx">element</span><span class="p">,</span> <span class="s2">&quot;tabindex&quot;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">);</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">tabbable</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">element</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">tabIndex</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span> <span class="nx">element</span><span class="p">,</span> <span class="s2">&quot;tabindex&quot;</span> <span class="p">),</span>
</span><span class='line'>          <span class="nx">isTabIndexNaN</span> <span class="o">=</span> <span class="nb">isNaN</span><span class="p">(</span> <span class="nx">tabIndex</span> <span class="p">);</span>
</span><span class='line'>      <span class="k">return</span> <span class="p">(</span> <span class="nx">isTabIndexNaN</span> <span class="o">||</span> <span class="nx">tabIndex</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">focusable</span><span class="p">(</span> <span class="nx">element</span><span class="p">,</span> <span class="o">!</span><span class="nx">isTabIndexNaN</span> <span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// support: jQuery &lt;1.8</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">$</span><span class="p">(</span> <span class="s2">&quot;&lt;a&gt;&quot;</span> <span class="p">).</span><span class="nx">outerWidth</span><span class="p">(</span> <span class="mi">1</span> <span class="p">).</span><span class="nx">jquery</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span> <span class="p">[</span> <span class="s2">&quot;Width&quot;</span><span class="p">,</span> <span class="s2">&quot;Height&quot;</span> <span class="p">],</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">name</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">side</span> <span class="o">=</span> <span class="nx">name</span> <span class="o">===</span> <span class="s2">&quot;Width&quot;</span> <span class="o">?</span> <span class="p">[</span> <span class="s2">&quot;Left&quot;</span><span class="p">,</span> <span class="s2">&quot;Right&quot;</span> <span class="p">]</span> <span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;Top&quot;</span><span class="p">,</span> <span class="s2">&quot;Bottom&quot;</span> <span class="p">],</span>
</span><span class='line'>          <span class="nx">type</span> <span class="o">=</span> <span class="nx">name</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">(),</span>
</span><span class='line'>          <span class="nx">orig</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">innerWidth</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">innerWidth</span><span class="p">,</span>
</span><span class='line'>              <span class="nx">innerHeight</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">,</span>
</span><span class='line'>              <span class="nx">outerWidth</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">outerWidth</span><span class="p">,</span>
</span><span class='line'>              <span class="nx">outerHeight</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">outerHeight</span>
</span><span class='line'>          <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>      <span class="kd">function</span> <span class="nx">reduce</span><span class="p">(</span> <span class="nx">elem</span><span class="p">,</span> <span class="nx">size</span><span class="p">,</span> <span class="nx">border</span><span class="p">,</span> <span class="nx">margin</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span> <span class="nx">side</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">size</span> <span class="o">-=</span> <span class="nb">parseFloat</span><span class="p">(</span> <span class="nx">$</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span> <span class="nx">elem</span><span class="p">,</span> <span class="s2">&quot;padding&quot;</span> <span class="o">+</span> <span class="k">this</span> <span class="p">)</span> <span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span> <span class="nx">border</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">size</span> <span class="o">-=</span> <span class="nb">parseFloat</span><span class="p">(</span> <span class="nx">$</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span> <span class="nx">elem</span><span class="p">,</span> <span class="s2">&quot;border&quot;</span> <span class="o">+</span> <span class="k">this</span> <span class="o">+</span> <span class="s2">&quot;Width&quot;</span> <span class="p">)</span> <span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span> <span class="nx">margin</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">size</span> <span class="o">-=</span> <span class="nb">parseFloat</span><span class="p">(</span> <span class="nx">$</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span> <span class="nx">elem</span><span class="p">,</span> <span class="s2">&quot;margin&quot;</span> <span class="o">+</span> <span class="k">this</span> <span class="p">)</span> <span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>          <span class="p">});</span>
</span><span class='line'>          <span class="k">return</span> <span class="nx">size</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">[</span> <span class="s2">&quot;inner&quot;</span> <span class="o">+</span> <span class="nx">name</span> <span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">size</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span> <span class="nx">size</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">return</span> <span class="nx">orig</span><span class="p">[</span> <span class="s2">&quot;inner&quot;</span> <span class="o">+</span> <span class="nx">name</span> <span class="p">].</span><span class="nx">call</span><span class="p">(</span> <span class="k">this</span> <span class="p">);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">$</span><span class="p">(</span> <span class="k">this</span> <span class="p">).</span><span class="nx">css</span><span class="p">(</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">reduce</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nx">size</span> <span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span> <span class="p">);</span>
</span><span class='line'>          <span class="p">});</span>
</span><span class='line'>      <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">[</span> <span class="s2">&quot;outer&quot;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">size</span><span class="p">,</span> <span class="nx">margin</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span> <span class="k">typeof</span> <span class="nx">size</span> <span class="o">!==</span> <span class="s2">&quot;number&quot;</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">return</span> <span class="nx">orig</span><span class="p">[</span> <span class="s2">&quot;outer&quot;</span> <span class="o">+</span> <span class="nx">name</span> <span class="p">].</span><span class="nx">call</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nx">size</span> <span class="p">);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">$</span><span class="p">(</span> <span class="k">this</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">reduce</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nx">size</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">margin</span> <span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span> <span class="p">);</span>
</span><span class='line'>          <span class="p">});</span>
</span><span class='line'>      <span class="p">};</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// support: jQuery &lt;1.8</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">addBack</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">addBack</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">selector</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span> <span class="nx">selector</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">prevObject</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">prevObject</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span> <span class="nx">selector</span> <span class="p">)</span>
</span><span class='line'>      <span class="p">);</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// support: jQuery 1.6.1, 1.6.2 (http://bugs.jquery.com/ticket/9413)</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span> <span class="nx">$</span><span class="p">(</span> <span class="s2">&quot;&lt;a&gt;&quot;</span> <span class="p">).</span><span class="nx">data</span><span class="p">(</span> <span class="s2">&quot;a-b&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span> <span class="p">).</span><span class="nx">removeData</span><span class="p">(</span> <span class="s2">&quot;a-b&quot;</span> <span class="p">).</span><span class="nx">data</span><span class="p">(</span> <span class="s2">&quot;a-b&quot;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">removeData</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nx">removeData</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">key</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">return</span> <span class="nx">removeData</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">camelCase</span><span class="p">(</span> <span class="nx">key</span> <span class="p">)</span> <span class="p">);</span>
</span><span class='line'>          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">return</span> <span class="nx">removeData</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="k">this</span> <span class="p">);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">};</span>
</span><span class='line'>  <span class="p">})(</span> <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">removeData</span> <span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">// deprecated</span>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">ie</span> <span class="o">=</span> <span class="o">!!</span><span class="sr">/msie [\w.]+/</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">selectstart</span> <span class="o">=</span> <span class="s2">&quot;onselectstart&quot;</span> <span class="k">in</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span> <span class="s2">&quot;div&quot;</span> <span class="p">);</span>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">disableSelection</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span> <span class="p">(</span> <span class="nx">$</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">selectstart</span> <span class="o">?</span> <span class="s2">&quot;selectstart&quot;</span> <span class="o">:</span> <span class="s2">&quot;mousedown&quot;</span> <span class="p">)</span> <span class="o">+</span>
</span><span class='line'>          <span class="s2">&quot;.ui-disableSelection&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">event</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span><span class='line'>          <span class="p">});</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">enableSelection</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">unbind</span><span class="p">(</span> <span class="s2">&quot;.ui-disableSelection&quot;</span> <span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span> <span class="nx">$</span><span class="p">.</span><span class="nx">ui</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// $.ui.plugin is deprecated.  Use the proxy pattern instead.</span>
</span><span class='line'>  <span class="nx">plugin</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">add</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">module</span><span class="p">,</span> <span class="nx">option</span><span class="p">,</span> <span class="nx">set</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span>
</span><span class='line'>              <span class="nx">proto</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">ui</span><span class="p">[</span> <span class="nx">module</span> <span class="p">].</span><span class="nx">prototype</span><span class="p">;</span>
</span><span class='line'>          <span class="k">for</span> <span class="p">(</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">set</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">proto</span><span class="p">.</span><span class="nx">plugins</span><span class="p">[</span> <span class="nx">i</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">proto</span><span class="p">.</span><span class="nx">plugins</span><span class="p">[</span> <span class="nx">i</span> <span class="p">]</span> <span class="o">||</span> <span class="p">[];</span>
</span><span class='line'>              <span class="nx">proto</span><span class="p">.</span><span class="nx">plugins</span><span class="p">[</span> <span class="nx">i</span> <span class="p">].</span><span class="nx">push</span><span class="p">(</span> <span class="p">[</span> <span class="nx">option</span><span class="p">,</span> <span class="nx">set</span><span class="p">[</span> <span class="nx">i</span> <span class="p">]</span> <span class="p">]</span> <span class="p">);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>      <span class="nx">call</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">instance</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">args</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span>
</span><span class='line'>              <span class="nx">set</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">plugins</span><span class="p">[</span> <span class="nx">name</span> <span class="p">];</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">set</span> <span class="o">||</span> <span class="o">!</span><span class="nx">instance</span><span class="p">.</span><span class="nx">element</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="nx">parentNode</span> <span class="o">||</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">element</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">===</span> <span class="mi">11</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">return</span><span class="p">;</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">for</span> <span class="p">(</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">set</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span> <span class="nx">set</span><span class="p">[</span> <span class="nx">i</span> <span class="p">][</span> <span class="mi">0</span> <span class="p">]</span> <span class="p">]</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">set</span><span class="p">[</span> <span class="nx">i</span> <span class="p">][</span> <span class="mi">1</span> <span class="p">].</span><span class="nx">apply</span><span class="p">(</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span> <span class="nx">args</span> <span class="p">);</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// only used by resizable</span>
</span><span class='line'>  <span class="nx">hasScroll</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">el</span><span class="p">,</span> <span class="nx">a</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">//If overflow is hidden, the element might have extra content, but the user wants to hide it</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span> <span class="nx">$</span><span class="p">(</span> <span class="nx">el</span> <span class="p">).</span><span class="nx">css</span><span class="p">(</span> <span class="s2">&quot;overflow&quot;</span> <span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;hidden&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">scroll</span> <span class="o">=</span> <span class="p">(</span> <span class="nx">a</span> <span class="o">&amp;&amp;</span> <span class="nx">a</span> <span class="o">===</span> <span class="s2">&quot;left&quot;</span> <span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;scrollLeft&quot;</span> <span class="o">:</span> <span class="s2">&quot;scrollTop&quot;</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">has</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span> <span class="nx">el</span><span class="p">[</span> <span class="nx">scroll</span> <span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// TODO: determine which cases actually cause this to happen</span>
</span><span class='line'>      <span class="c1">// if the element doesn&#39;t have the scroll set, see if it&#39;s possible to</span>
</span><span class='line'>      <span class="c1">// set the scroll</span>
</span><span class='line'>      <span class="nx">el</span><span class="p">[</span> <span class="nx">scroll</span> <span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>      <span class="nx">has</span> <span class="o">=</span> <span class="p">(</span> <span class="nx">el</span><span class="p">[</span> <span class="nx">scroll</span> <span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">);</span>
</span><span class='line'>      <span class="nx">el</span><span class="p">[</span> <span class="nx">scroll</span> <span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">has</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="p">})(</span> <span class="nx">jQuery</span> <span class="p">);</span>
</span><span class='line'><span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nx">$</span><span class="p">,</span> <span class="kc">undefined</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">ui</span><span class="p">,</span> <span class="p">{</span> <span class="nx">datepicker</span><span class="o">:</span> <span class="p">{</span> <span class="nx">version</span><span class="o">:</span> <span class="s2">&quot;1.10.2&quot;</span> <span class="p">}</span> <span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">PROP_NAME</span> <span class="o">=</span> <span class="s2">&quot;datepicker&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">dpuuid</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">(),</span>
</span><span class='line'>  <span class="nx">instActive</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/* Date picker manager.</span>
</span><span class='line'><span class="cm">   Use the singleton instance of this class, $.datepicker, to interact with the date picker.</span>
</span><span class='line'><span class="cm">   Settings for (groups of) date pickers are maintained in an instance object,</span>
</span><span class='line'><span class="cm">   allowing multiple different settings on the same page. */</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">Datepicker</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">_curInst</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">// The current instance in use</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">_keyEvent</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span> <span class="c1">// If the last event was a key event</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">_disabledInputs</span> <span class="o">=</span> <span class="p">[];</span> <span class="c1">// List of date picker inputs that have been disabled</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">_datepickerShowing</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span> <span class="c1">// True if the popup picker is showing , false if not</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">_inDialog</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span> <span class="c1">// True if showing within a &quot;dialog&quot;, false if not</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">_mainDivId</span> <span class="o">=</span> <span class="s2">&quot;ui-datepicker-div&quot;</span><span class="p">;</span> <span class="c1">// The ID of the main datepicker division</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">_inlineClass</span> <span class="o">=</span> <span class="s2">&quot;ui-datepicker-inline&quot;</span><span class="p">;</span> <span class="c1">// The name of the inline marker class</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">_appendClass</span> <span class="o">=</span> <span class="s2">&quot;ui-datepicker-append&quot;</span><span class="p">;</span> <span class="c1">// The name of the append marker class</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">_triggerClass</span> <span class="o">=</span> <span class="s2">&quot;ui-datepicker-trigger&quot;</span><span class="p">;</span> <span class="c1">// The name of the trigger marker class</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">_dialogClass</span> <span class="o">=</span> <span class="s2">&quot;ui-datepicker-dialog&quot;</span><span class="p">;</span> <span class="c1">// The name of the dialog marker class</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">_disableClass</span> <span class="o">=</span> <span class="s2">&quot;ui-datepicker-disabled&quot;</span><span class="p">;</span> <span class="c1">// The name of the disabled covering marker class</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">_unselectableClass</span> <span class="o">=</span> <span class="s2">&quot;ui-datepicker-unselectable&quot;</span><span class="p">;</span> <span class="c1">// The name of the unselectable cell marker class</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">_currentClass</span> <span class="o">=</span> <span class="s2">&quot;ui-datepicker-current-day&quot;</span><span class="p">;</span> <span class="c1">// The name of the current day marker class</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">_dayOverClass</span> <span class="o">=</span> <span class="s2">&quot;ui-datepicker-days-cell-over&quot;</span><span class="p">;</span> <span class="c1">// The name of the day hover marker class</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">regional</span> <span class="o">=</span> <span class="p">[];</span> <span class="c1">// Available regional settings, indexed by language code</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">regional</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">closeText</span><span class="o">:</span> <span class="s1">&#39;关闭&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">prevText</span><span class="o">:</span> <span class="s1">&#39;&amp;#x3c;上月&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">nextText</span><span class="o">:</span> <span class="s1">&#39;下月&amp;#x3e;&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">currentText</span><span class="o">:</span> <span class="s1">&#39;今天&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">monthNames</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;一月&#39;</span><span class="p">,</span><span class="s1">&#39;二月&#39;</span><span class="p">,</span><span class="s1">&#39;三月&#39;</span><span class="p">,</span><span class="s1">&#39;四月&#39;</span><span class="p">,</span><span class="s1">&#39;五月&#39;</span><span class="p">,</span><span class="s1">&#39;六月&#39;</span><span class="p">,</span><span class="s1">&#39;七月&#39;</span><span class="p">,</span><span class="s1">&#39;八月&#39;</span><span class="p">,</span><span class="s1">&#39;九月&#39;</span><span class="p">,</span><span class="s1">&#39;十月&#39;</span><span class="p">,</span><span class="s1">&#39;十一月&#39;</span><span class="p">,</span><span class="s1">&#39;十二月&#39;</span><span class="p">],</span>
</span><span class='line'>          <span class="nx">monthNamesShort</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;一&#39;</span><span class="p">,</span><span class="s1">&#39;二&#39;</span><span class="p">,</span><span class="s1">&#39;三&#39;</span><span class="p">,</span><span class="s1">&#39;四&#39;</span><span class="p">,</span><span class="s1">&#39;五&#39;</span><span class="p">,</span><span class="s1">&#39;六&#39;</span><span class="p">,</span><span class="s1">&#39;七&#39;</span><span class="p">,</span><span class="s1">&#39;八&#39;</span><span class="p">,</span><span class="s1">&#39;九&#39;</span><span class="p">,</span><span class="s1">&#39;十&#39;</span><span class="p">,</span><span class="s1">&#39;十一&#39;</span><span class="p">,</span><span class="s1">&#39;十二&#39;</span><span class="p">],</span>
</span><span class='line'>          <span class="nx">dayNames</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;星期日&#39;</span><span class="p">,</span><span class="s1">&#39;星期一&#39;</span><span class="p">,</span><span class="s1">&#39;星期二&#39;</span><span class="p">,</span><span class="s1">&#39;星期三&#39;</span><span class="p">,</span><span class="s1">&#39;星期四&#39;</span><span class="p">,</span><span class="s1">&#39;星期五&#39;</span><span class="p">,</span><span class="s1">&#39;星期六&#39;</span><span class="p">],</span>
</span><span class='line'>          <span class="nx">dayNamesShort</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;周日&#39;</span><span class="p">,</span><span class="s1">&#39;周一&#39;</span><span class="p">,</span><span class="s1">&#39;周二&#39;</span><span class="p">,</span><span class="s1">&#39;周三&#39;</span><span class="p">,</span><span class="s1">&#39;周四&#39;</span><span class="p">,</span><span class="s1">&#39;周五&#39;</span><span class="p">,</span><span class="s1">&#39;周六&#39;</span><span class="p">],</span>
</span><span class='line'>          <span class="nx">dayNamesMin</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;日&#39;</span><span class="p">,</span><span class="s1">&#39;一&#39;</span><span class="p">,</span><span class="s1">&#39;二&#39;</span><span class="p">,</span><span class="s1">&#39;三&#39;</span><span class="p">,</span><span class="s1">&#39;四&#39;</span><span class="p">,</span><span class="s1">&#39;五&#39;</span><span class="p">,</span><span class="s1">&#39;六&#39;</span><span class="p">],</span>
</span><span class='line'>          <span class="nx">weekHeader</span><span class="o">:</span> <span class="s1">&#39;周&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">dateFormat</span><span class="o">:</span> <span class="s1">&#39;yy-mm-dd&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">firstDay</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">isRTL</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">showMonthAfterYear</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">yearSuffix</span><span class="o">:</span> <span class="s1">&#39;年&#39;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">_defaults</span> <span class="o">=</span> <span class="p">{</span> <span class="c1">// Global defaults for all the date picker instances</span>
</span><span class='line'>      <span class="nx">showOn</span><span class="o">:</span> <span class="s2">&quot;focus&quot;</span><span class="p">,</span> <span class="c1">// &quot;focus&quot; for popup on focus,</span>
</span><span class='line'>          <span class="c1">// &quot;button&quot; for trigger button, or &quot;both&quot; for either</span>
</span><span class='line'>      <span class="nx">showAnim</span><span class="o">:</span> <span class="s2">&quot;fadeIn&quot;</span><span class="p">,</span> <span class="c1">// Name of jQuery animation for popup</span>
</span><span class='line'>      <span class="nx">showOptions</span><span class="o">:</span> <span class="p">{},</span> <span class="c1">// Options for enhanced animations</span>
</span><span class='line'>      <span class="nx">defaultDate</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> <span class="c1">// Used when field is blank: actual date,</span>
</span><span class='line'>          <span class="c1">// +/-number for offset from today, null for today</span>
</span><span class='line'>      <span class="nx">appendText</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="c1">// Display text following the input box, e.g. showing the format</span>
</span><span class='line'>      <span class="nx">buttonText</span><span class="o">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span> <span class="c1">// Text for trigger button</span>
</span><span class='line'>      <span class="nx">buttonImage</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="c1">// URL for trigger button image</span>
</span><span class='line'>      <span class="nx">buttonImageOnly</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="c1">// True if the image appears alone, false if it appears on a button</span>
</span><span class='line'>      <span class="nx">hideIfNoPrevNext</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="c1">// True to hide next/previous month links</span>
</span><span class='line'>          <span class="c1">// if not applicable, false to just disable them</span>
</span><span class='line'>      <span class="nx">navigationAsDateFormat</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="c1">// True if date formatting applied to prev/today/next links</span>
</span><span class='line'>      <span class="nx">gotoCurrent</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="c1">// True if today link goes back to current selection instead</span>
</span><span class='line'>      <span class="nx">changeMonth</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="c1">// True if month can be selected directly, false if only prev/next</span>
</span><span class='line'>      <span class="nx">changeYear</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="c1">// True if year can be selected directly, false if only prev/next</span>
</span><span class='line'>      <span class="nx">yearRange</span><span class="o">:</span> <span class="s2">&quot;c-10:c+10&quot;</span><span class="p">,</span> <span class="c1">// Range of years to display in drop-down,</span>
</span><span class='line'>          <span class="c1">// either relative to today&#39;s year (-nn:+nn), relative to currently displayed year</span>
</span><span class='line'>          <span class="c1">// (c-nn:c+nn), absolute (nnnn:nnnn), or a combination of the above (nnnn:-n)</span>
</span><span class='line'>      <span class="nx">showOtherMonths</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="c1">// True to show dates in other months, false to leave blank</span>
</span><span class='line'>      <span class="nx">selectOtherMonths</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="c1">// True to allow selection of dates in other months, false for unselectable</span>
</span><span class='line'>      <span class="nx">showWeek</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="c1">// True to show week of the year, false to not show it</span>
</span><span class='line'>      <span class="nx">calculateWeek</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">iso8601Week</span><span class="p">,</span> <span class="c1">// How to calculate the week of the year,</span>
</span><span class='line'>          <span class="c1">// takes a Date and returns the number of the week for it</span>
</span><span class='line'>      <span class="nx">shortYearCutoff</span><span class="o">:</span> <span class="s2">&quot;+10&quot;</span><span class="p">,</span> <span class="c1">// Short year values &lt; this are in the current century,</span>
</span><span class='line'>          <span class="c1">// &gt; this are in the previous century,</span>
</span><span class='line'>          <span class="c1">// string value starting with &quot;+&quot; for current year + value</span>
</span><span class='line'>      <span class="nx">minDate</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> <span class="c1">// The earliest selectable date, or null for no limit</span>
</span><span class='line'>      <span class="nx">maxDate</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> <span class="c1">// The latest selectable date, or null for no limit</span>
</span><span class='line'>      <span class="nx">duration</span><span class="o">:</span> <span class="s2">&quot;fast&quot;</span><span class="p">,</span> <span class="c1">// Duration of display/closure</span>
</span><span class='line'>      <span class="nx">beforeShowDay</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> <span class="c1">// Function that takes a date and returns an array with</span>
</span><span class='line'>          <span class="c1">// [0] = true if selectable, false if not, [1] = custom CSS class name(s) or &quot;&quot;,</span>
</span><span class='line'>          <span class="c1">// [2] = cell title (optional), e.g. $.datepicker.noWeekends</span>
</span><span class='line'>      <span class="nx">beforeShow</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> <span class="c1">// Function that takes an input field and</span>
</span><span class='line'>          <span class="c1">// returns a set of custom settings for the date picker</span>
</span><span class='line'>      <span class="nx">onSelect</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> <span class="c1">// Define a callback function when a date is selected</span>
</span><span class='line'>      <span class="nx">onChangeMonthYear</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> <span class="c1">// Define a callback function when the month or year is changed</span>
</span><span class='line'>      <span class="nx">onClose</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> <span class="c1">// Define a callback function when the datepicker is closed</span>
</span><span class='line'>      <span class="nx">numberOfMonths</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">// Number of months to show at a time</span>
</span><span class='line'>      <span class="nx">showCurrentAtPos</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="c1">// The position in multipe months at which to show the current month (starting at 0)</span>
</span><span class='line'>      <span class="nx">stepMonths</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">// Number of months to step back/forward</span>
</span><span class='line'>      <span class="nx">stepBigMonths</span><span class="o">:</span> <span class="mi">12</span><span class="p">,</span> <span class="c1">// Number of months to step back/forward for the big links</span>
</span><span class='line'>      <span class="nx">altField</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="c1">// Selector for an alternate field to store selected dates into</span>
</span><span class='line'>      <span class="nx">altFormat</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="c1">// The date format to use for the alternate field</span>
</span><span class='line'>      <span class="nx">constrainInput</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="c1">// The input is constrained by the current date format</span>
</span><span class='line'>      <span class="nx">showButtonPanel</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="c1">// True to show button panel, false to not show it</span>
</span><span class='line'>      <span class="nx">autoSize</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="c1">// True to size the input for the date format, false to leave as is</span>
</span><span class='line'>      <span class="nx">disabled</span><span class="o">:</span> <span class="kc">false</span> <span class="c1">// The initial disabled state</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_defaults</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">regional</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]);</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">dpDiv</span> <span class="o">=</span> <span class="nx">bindHover</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;div id=&#39;&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">_mainDivId</span> <span class="o">+</span> <span class="s2">&quot;&#39; class=&#39;ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all&#39;&gt;&lt;/div&gt;&quot;</span><span class="p">));</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Datepicker</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>  <span class="cm">/* Class name added to elements to indicate already configured with a date picker. */</span>
</span><span class='line'>  <span class="nx">markerClassName</span><span class="o">:</span> <span class="s2">&quot;hasDatepicker&quot;</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">//Keep track of the maximum number of rows displayed (see #7043)</span>
</span><span class='line'>  <span class="nx">maxRows</span><span class="o">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// TODO rename to &quot;widget&quot; when switching to widget factory</span>
</span><span class='line'>  <span class="nx">_widgetDatepicker</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Override the default settings for all instances of the date picker.</span>
</span><span class='line'><span class="cm">  * @param  settings  object - the new settings to use as defaults (anonymous object)</span>
</span><span class='line'><span class="cm">  * @return the manager object</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="nx">setDefaults</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">extendRemove</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_defaults</span><span class="p">,</span> <span class="nx">settings</span> <span class="o">||</span> <span class="p">{});</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Attach the date picker to a jQuery selection.</span>
</span><span class='line'><span class="cm">  * @param  target   element - the target input field or division or span</span>
</span><span class='line'><span class="cm">  * @param  settings  object - the new settings to use for this date picker instance (anonymous)</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="nx">_attachDatepicker</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">nodeName</span><span class="p">,</span> <span class="nx">inline</span><span class="p">,</span> <span class="nx">inst</span><span class="p">;</span>
</span><span class='line'>      <span class="nx">nodeName</span> <span class="o">=</span> <span class="nx">target</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
</span><span class='line'>      <span class="nx">inline</span> <span class="o">=</span> <span class="p">(</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s2">&quot;div&quot;</span> <span class="o">||</span> <span class="nx">nodeName</span> <span class="o">===</span> <span class="s2">&quot;span&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">target</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">uuid</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>          <span class="nx">target</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s2">&quot;dp&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">uuid</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nx">inst</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_newInst</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">target</span><span class="p">),</span> <span class="nx">inline</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">settings</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span> <span class="nx">settings</span> <span class="o">||</span> <span class="p">{});</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s2">&quot;input&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_connectDatepicker</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">inline</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_inlineDatepicker</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Create a new instance object. */</span>
</span><span class='line'>  <span class="nx">_newInst</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">inline</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">target</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">id</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/([^A-Za-z0-9_\-])/g</span><span class="p">,</span> <span class="s2">&quot;\\\\$1&quot;</span><span class="p">);</span> <span class="c1">// escape jQuery meta chars</span>
</span><span class='line'>      <span class="k">return</span> <span class="p">{</span><span class="nx">id</span><span class="o">:</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">input</span><span class="o">:</span> <span class="nx">target</span><span class="p">,</span> <span class="c1">// associated target</span>
</span><span class='line'>          <span class="nx">selectedDay</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">selectedMonth</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">selectedYear</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="c1">// current selection</span>
</span><span class='line'>          <span class="nx">drawMonth</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">drawYear</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="c1">// month being drawn</span>
</span><span class='line'>          <span class="nx">inline</span><span class="o">:</span> <span class="nx">inline</span><span class="p">,</span> <span class="c1">// is datepicker inline or not</span>
</span><span class='line'>          <span class="nx">dpDiv</span><span class="o">:</span> <span class="p">(</span><span class="o">!</span><span class="nx">inline</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">dpDiv</span> <span class="o">:</span> <span class="c1">// presentation div</span>
</span><span class='line'>          <span class="nx">bindHover</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;div class=&#39;&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">_inlineClass</span> <span class="o">+</span> <span class="s2">&quot; ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all&#39;&gt;&lt;/div&gt;&quot;</span><span class="p">)))};</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Attach the date picker to an input field. */</span>
</span><span class='line'>  <span class="nx">_connectDatepicker</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">target</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">append</span> <span class="o">=</span> <span class="nx">$</span><span class="p">([]);</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">trigger</span> <span class="o">=</span> <span class="nx">$</span><span class="p">([]);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">input</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">markerClassName</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_attachments</span><span class="p">(</span><span class="nx">input</span><span class="p">,</span> <span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">input</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">markerClassName</span><span class="p">).</span><span class="nx">keydown</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_doKeyDown</span><span class="p">).</span>
</span><span class='line'>          <span class="nx">keypress</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_doKeyPress</span><span class="p">).</span><span class="nx">keyup</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_doKeyUp</span><span class="p">);</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_autoSize</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">PROP_NAME</span><span class="p">,</span> <span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>      <span class="c1">//If disabled option is true, disable the datepicker once it has been attached to the input (see ticket #5665)</span>
</span><span class='line'>      <span class="k">if</span><span class="p">(</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">disabled</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_disableDatepicker</span><span class="p">(</span> <span class="nx">target</span> <span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Make attachments based on settings. */</span>
</span><span class='line'>  <span class="nx">_attachments</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">input</span><span class="p">,</span> <span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">showOn</span><span class="p">,</span> <span class="nx">buttonText</span><span class="p">,</span> <span class="nx">buttonImage</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">appendText</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;appendText&quot;</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">isRTL</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;isRTL&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">append</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">append</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">appendText</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">append</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;span class=&#39;&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">_appendClass</span> <span class="o">+</span> <span class="s2">&quot;&#39;&gt;&quot;</span> <span class="o">+</span> <span class="nx">appendText</span> <span class="o">+</span> <span class="s2">&quot;&lt;/span&gt;&quot;</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">input</span><span class="p">[</span><span class="nx">isRTL</span> <span class="o">?</span> <span class="s2">&quot;before&quot;</span> <span class="o">:</span> <span class="s2">&quot;after&quot;</span><span class="p">](</span><span class="nx">inst</span><span class="p">.</span><span class="nx">append</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">input</span><span class="p">.</span><span class="nx">unbind</span><span class="p">(</span><span class="s2">&quot;focus&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_showDatepicker</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">trigger</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">trigger</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">showOn</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;showOn&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">showOn</span> <span class="o">===</span> <span class="s2">&quot;focus&quot;</span> <span class="o">||</span> <span class="nx">showOn</span> <span class="o">===</span> <span class="s2">&quot;both&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// pop-up date picker when in the marked field</span>
</span><span class='line'>          <span class="nx">input</span><span class="p">.</span><span class="nx">focus</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_showDatepicker</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">showOn</span> <span class="o">===</span> <span class="s2">&quot;button&quot;</span> <span class="o">||</span> <span class="nx">showOn</span> <span class="o">===</span> <span class="s2">&quot;both&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// pop-up date picker when button clicked</span>
</span><span class='line'>          <span class="nx">buttonText</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;buttonText&quot;</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">buttonImage</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;buttonImage&quot;</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">trigger</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;buttonImageOnly&quot;</span><span class="p">)</span> <span class="o">?</span>
</span><span class='line'>              <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;img/&gt;&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_triggerClass</span><span class="p">).</span>
</span><span class='line'>                  <span class="nx">attr</span><span class="p">({</span> <span class="nx">src</span><span class="o">:</span> <span class="nx">buttonImage</span><span class="p">,</span> <span class="nx">alt</span><span class="o">:</span> <span class="nx">buttonText</span><span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="nx">buttonText</span> <span class="p">})</span> <span class="o">:</span>
</span><span class='line'>              <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;button type=&#39;button&#39;&gt;&lt;/button&gt;&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_triggerClass</span><span class="p">).</span>
</span><span class='line'>                  <span class="nx">html</span><span class="p">(</span><span class="o">!</span><span class="nx">buttonImage</span> <span class="o">?</span> <span class="nx">buttonText</span> <span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;img/&gt;&quot;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span>
</span><span class='line'>                  <span class="p">{</span> <span class="nx">src</span><span class="o">:</span><span class="nx">buttonImage</span><span class="p">,</span> <span class="nx">alt</span><span class="o">:</span><span class="nx">buttonText</span><span class="p">,</span> <span class="nx">title</span><span class="o">:</span><span class="nx">buttonText</span> <span class="p">})));</span>
</span><span class='line'>          <span class="nx">input</span><span class="p">[</span><span class="nx">isRTL</span> <span class="o">?</span> <span class="s2">&quot;before&quot;</span> <span class="o">:</span> <span class="s2">&quot;after&quot;</span><span class="p">](</span><span class="nx">inst</span><span class="p">.</span><span class="nx">trigger</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">trigger</span><span class="p">.</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_datepickerShowing</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_lastInput</span> <span class="o">===</span> <span class="nx">input</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_hideDatepicker</span><span class="p">();</span>
</span><span class='line'>              <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_datepickerShowing</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_lastInput</span> <span class="o">!==</span> <span class="nx">input</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_hideDatepicker</span><span class="p">();</span>
</span><span class='line'>                  <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_showDatepicker</span><span class="p">(</span><span class="nx">input</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span><span class='line'>              <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_showDatepicker</span><span class="p">(</span><span class="nx">input</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>          <span class="p">});</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Apply the maximum length for the date format. */</span>
</span><span class='line'>  <span class="nx">_autoSize</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;autoSize&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">inst</span><span class="p">.</span><span class="nx">inline</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">findMax</span><span class="p">,</span> <span class="nx">max</span><span class="p">,</span> <span class="nx">maxI</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span>
</span><span class='line'>              <span class="nx">date</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="mi">2009</span><span class="p">,</span> <span class="mi">12</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="c1">// Ensure double digits</span>
</span><span class='line'>              <span class="nx">dateFormat</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;dateFormat&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="nx">dateFormat</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/[DM]/</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">findMax</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">names</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>                  <span class="nx">maxI</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>                  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">names</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                      <span class="k">if</span> <span class="p">(</span><span class="nx">names</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="nx">max</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                          <span class="nx">max</span> <span class="o">=</span> <span class="nx">names</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span>
</span><span class='line'>                          <span class="nx">maxI</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>
</span><span class='line'>                      <span class="p">}</span>
</span><span class='line'>                  <span class="p">}</span>
</span><span class='line'>                  <span class="k">return</span> <span class="nx">maxI</span><span class="p">;</span>
</span><span class='line'>              <span class="p">};</span>
</span><span class='line'>              <span class="nx">date</span><span class="p">.</span><span class="nx">setMonth</span><span class="p">(</span><span class="nx">findMax</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="p">(</span><span class="nx">dateFormat</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/MM/</span><span class="p">)</span> <span class="o">?</span>
</span><span class='line'>                  <span class="s2">&quot;monthNames&quot;</span> <span class="o">:</span> <span class="s2">&quot;monthNamesShort&quot;</span><span class="p">))));</span>
</span><span class='line'>              <span class="nx">date</span><span class="p">.</span><span class="nx">setDate</span><span class="p">(</span><span class="nx">findMax</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="p">(</span><span class="nx">dateFormat</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/DD/</span><span class="p">)</span> <span class="o">?</span>
</span><span class='line'>                  <span class="s2">&quot;dayNames&quot;</span> <span class="o">:</span> <span class="s2">&quot;dayNamesShort&quot;</span><span class="p">)))</span> <span class="o">+</span> <span class="mi">20</span> <span class="o">-</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getDay</span><span class="p">());</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;size&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_formatDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">date</span><span class="p">).</span><span class="nx">length</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Attach an inline date picker to a div. */</span>
</span><span class='line'>  <span class="nx">_inlineDatepicker</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">divSpan</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">target</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">divSpan</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">markerClassName</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nx">divSpan</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">markerClassName</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">PROP_NAME</span><span class="p">,</span> <span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_setDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getDefaultDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">),</span> <span class="kc">true</span><span class="p">);</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_updateDatepicker</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_updateAlternate</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>      <span class="c1">//If disabled option is true, disable the datepicker before showing it (see ticket #5665)</span>
</span><span class='line'>      <span class="k">if</span><span class="p">(</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">disabled</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_disableDatepicker</span><span class="p">(</span> <span class="nx">target</span> <span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="c1">// Set display:block in place of inst.dpDiv.show() which won&#39;t work on disconnected elements</span>
</span><span class='line'>      <span class="c1">// http://bugs.jqueryui.com/ticket/7552 - A Datepicker created on a detached div has zero height</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span> <span class="s2">&quot;display&quot;</span><span class="p">,</span> <span class="s2">&quot;block&quot;</span> <span class="p">);</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Pop-up the date picker in a &quot;dialog&quot; box.</span>
</span><span class='line'><span class="cm">  * @param  input element - ignored</span>
</span><span class='line'><span class="cm">  * @param  date string or Date - the initial date to display</span>
</span><span class='line'><span class="cm">  * @param  onSelect  function - the function to call when a date is selected</span>
</span><span class='line'><span class="cm">  * @param  settings  object - update the dialog date picker instance&#39;s settings (anonymous object)</span>
</span><span class='line'><span class="cm">  * @param  pos int[2] - coordinates for the dialog&#39;s position within the screen or</span>
</span><span class='line'><span class="cm">  *                  event - with x/y coordinates or</span>
</span><span class='line'><span class="cm">  *                  leave empty for default (screen centre)</span>
</span><span class='line'><span class="cm">  * @return the manager object</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="nx">_dialogDatepicker</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">input</span><span class="p">,</span> <span class="nx">date</span><span class="p">,</span> <span class="nx">onSelect</span><span class="p">,</span> <span class="nx">settings</span><span class="p">,</span> <span class="nx">pos</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">browserWidth</span><span class="p">,</span> <span class="nx">browserHeight</span><span class="p">,</span> <span class="nx">scrollX</span><span class="p">,</span> <span class="nx">scrollY</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">inst</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_dialogInst</span><span class="p">;</span> <span class="c1">// internal instance</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">uuid</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>          <span class="nx">id</span> <span class="o">=</span> <span class="s2">&quot;dp&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">uuid</span><span class="p">;</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_dialogInput</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;input type=&#39;text&#39; id=&#39;&quot;</span> <span class="o">+</span> <span class="nx">id</span> <span class="o">+</span>
</span><span class='line'>              <span class="s2">&quot;&#39; style=&#39;position: absolute; top: -100px; width: 0px;&#39;/&gt;&quot;</span><span class="p">);</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_dialogInput</span><span class="p">.</span><span class="nx">keydown</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_doKeyDown</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_dialogInput</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">inst</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_dialogInst</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_newInst</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_dialogInput</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">settings</span> <span class="o">=</span> <span class="p">{};</span>
</span><span class='line'>          <span class="nx">$</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_dialogInput</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">PROP_NAME</span><span class="p">,</span> <span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nx">extendRemove</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">settings</span> <span class="o">||</span> <span class="p">{});</span>
</span><span class='line'>      <span class="nx">date</span> <span class="o">=</span> <span class="p">(</span><span class="nx">date</span> <span class="o">&amp;&amp;</span> <span class="nx">date</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">===</span> <span class="nb">Date</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">_formatDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">date</span><span class="p">)</span> <span class="o">:</span> <span class="nx">date</span><span class="p">);</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_dialogInput</span><span class="p">.</span><span class="nx">val</span><span class="p">(</span><span class="nx">date</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_pos</span> <span class="o">=</span> <span class="p">(</span><span class="nx">pos</span> <span class="o">?</span> <span class="p">(</span><span class="nx">pos</span><span class="p">.</span><span class="nx">length</span> <span class="o">?</span> <span class="nx">pos</span> <span class="o">:</span> <span class="p">[</span><span class="nx">pos</span><span class="p">.</span><span class="nx">pageX</span><span class="p">,</span> <span class="nx">pos</span><span class="p">.</span><span class="nx">pageY</span><span class="p">])</span> <span class="o">:</span> <span class="kc">null</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_pos</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">browserWidth</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">clientWidth</span><span class="p">;</span>
</span><span class='line'>          <span class="nx">browserHeight</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">clientHeight</span><span class="p">;</span>
</span><span class='line'>          <span class="nx">scrollX</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">scrollLeft</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="p">;</span>
</span><span class='line'>          <span class="nx">scrollY</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">;</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_pos</span> <span class="o">=</span> <span class="c1">// should use actual width/height below</span>
</span><span class='line'>              <span class="p">[(</span><span class="nx">browserWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">100</span> <span class="o">+</span> <span class="nx">scrollX</span><span class="p">,</span> <span class="p">(</span><span class="nx">browserHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">150</span> <span class="o">+</span> <span class="nx">scrollY</span><span class="p">];</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// move input on screen for focus, but hidden behind dialog</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_dialogInput</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">20</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">onSelect</span> <span class="o">=</span> <span class="nx">onSelect</span><span class="p">;</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_inDialog</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_dialogClass</span><span class="p">);</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_showDatepicker</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_dialogInput</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">blockUI</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">$</span><span class="p">.</span><span class="nx">blockUI</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_dialogInput</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">PROP_NAME</span><span class="p">,</span> <span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Detach a datepicker from its control.</span>
</span><span class='line'><span class="cm">  * @param  target   element - the target input field or division or span</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="nx">_destroyDatepicker</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">nodeName</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">$target</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">target</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">inst</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">PROP_NAME</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">$target</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">markerClassName</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">nodeName</span> <span class="o">=</span> <span class="nx">target</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">.</span><span class="nx">removeData</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">PROP_NAME</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s2">&quot;input&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">append</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">trigger</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
</span><span class='line'>          <span class="nx">$target</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">markerClassName</span><span class="p">).</span>
</span><span class='line'>              <span class="nx">unbind</span><span class="p">(</span><span class="s2">&quot;focus&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_showDatepicker</span><span class="p">).</span>
</span><span class='line'>              <span class="nx">unbind</span><span class="p">(</span><span class="s2">&quot;keydown&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_doKeyDown</span><span class="p">).</span>
</span><span class='line'>              <span class="nx">unbind</span><span class="p">(</span><span class="s2">&quot;keypress&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_doKeyPress</span><span class="p">).</span>
</span><span class='line'>              <span class="nx">unbind</span><span class="p">(</span><span class="s2">&quot;keyup&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_doKeyUp</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s2">&quot;div&quot;</span> <span class="o">||</span> <span class="nx">nodeName</span> <span class="o">===</span> <span class="s2">&quot;span&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">$target</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">markerClassName</span><span class="p">).</span><span class="nx">empty</span><span class="p">();</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Enable the date picker to a jQuery selection.</span>
</span><span class='line'><span class="cm">  * @param  target   element - the target input field or division or span</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="nx">_enableDatepicker</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">nodeName</span><span class="p">,</span> <span class="nx">inline</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">$target</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">target</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">inst</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">PROP_NAME</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">$target</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">markerClassName</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">nodeName</span> <span class="o">=</span> <span class="nx">target</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s2">&quot;input&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">target</span><span class="p">.</span><span class="nx">disabled</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">trigger</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">).</span>
</span><span class='line'>              <span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">disabled</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span> <span class="p">}).</span><span class="nx">end</span><span class="p">().</span>
</span><span class='line'>              <span class="nx">filter</span><span class="p">(</span><span class="s2">&quot;img&quot;</span><span class="p">).</span><span class="nx">css</span><span class="p">({</span><span class="nx">opacity</span><span class="o">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span> <span class="nx">cursor</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">});</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s2">&quot;div&quot;</span> <span class="o">||</span> <span class="nx">nodeName</span> <span class="o">===</span> <span class="s2">&quot;span&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">inline</span> <span class="o">=</span> <span class="nx">$target</span><span class="p">.</span><span class="nx">children</span><span class="p">(</span><span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">_inlineClass</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">inline</span><span class="p">.</span><span class="nx">children</span><span class="p">().</span><span class="nx">removeClass</span><span class="p">(</span><span class="s2">&quot;ui-state-disabled&quot;</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">inline</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;select.ui-datepicker-month, select.ui-datepicker-year&quot;</span><span class="p">).</span>
</span><span class='line'>              <span class="nx">prop</span><span class="p">(</span><span class="s2">&quot;disabled&quot;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_disabledInputs</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_disabledInputs</span><span class="p">,</span>
</span><span class='line'>          <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="p">(</span><span class="nx">value</span> <span class="o">===</span> <span class="nx">target</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="nx">value</span><span class="p">);</span> <span class="p">});</span> <span class="c1">// delete entry</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Disable the date picker to a jQuery selection.</span>
</span><span class='line'><span class="cm">  * @param  target   element - the target input field or division or span</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="nx">_disableDatepicker</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">nodeName</span><span class="p">,</span> <span class="nx">inline</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">$target</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">target</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">inst</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">PROP_NAME</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">$target</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">markerClassName</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">nodeName</span> <span class="o">=</span> <span class="nx">target</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s2">&quot;input&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">target</span><span class="p">.</span><span class="nx">disabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">trigger</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">).</span>
</span><span class='line'>              <span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">disabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="p">}).</span><span class="nx">end</span><span class="p">().</span>
</span><span class='line'>              <span class="nx">filter</span><span class="p">(</span><span class="s2">&quot;img&quot;</span><span class="p">).</span><span class="nx">css</span><span class="p">({</span><span class="nx">opacity</span><span class="o">:</span> <span class="s2">&quot;0.5&quot;</span><span class="p">,</span> <span class="nx">cursor</span><span class="o">:</span> <span class="s2">&quot;default&quot;</span><span class="p">});</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s2">&quot;div&quot;</span> <span class="o">||</span> <span class="nx">nodeName</span> <span class="o">===</span> <span class="s2">&quot;span&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">inline</span> <span class="o">=</span> <span class="nx">$target</span><span class="p">.</span><span class="nx">children</span><span class="p">(</span><span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">_inlineClass</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">inline</span><span class="p">.</span><span class="nx">children</span><span class="p">().</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;ui-state-disabled&quot;</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">inline</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;select.ui-datepicker-month, select.ui-datepicker-year&quot;</span><span class="p">).</span>
</span><span class='line'>              <span class="nx">prop</span><span class="p">(</span><span class="s2">&quot;disabled&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_disabledInputs</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_disabledInputs</span><span class="p">,</span>
</span><span class='line'>          <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="p">(</span><span class="nx">value</span> <span class="o">===</span> <span class="nx">target</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="nx">value</span><span class="p">);</span> <span class="p">});</span> <span class="c1">// delete entry</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_disabledInputs</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">_disabledInputs</span><span class="p">.</span><span class="nx">length</span><span class="p">]</span> <span class="o">=</span> <span class="nx">target</span><span class="p">;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Is the first field in a jQuery collection disabled as a datepicker?</span>
</span><span class='line'><span class="cm">  * @param  target   element - the target input field or division or span</span>
</span><span class='line'><span class="cm">  * @return boolean - true if disabled, false if enabled</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="nx">_isDisabledDatepicker</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_disabledInputs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_disabledInputs</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Retrieve the instance data for the target control.</span>
</span><span class='line'><span class="cm">  * @param  target  element - the target input field or division or span</span>
</span><span class='line'><span class="cm">  * @return  object - the associated instance data</span>
</span><span class='line'><span class="cm">  * @throws  error if a jQuery problem getting data</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="nx">_getInst</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">try</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">PROP_NAME</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">throw</span> <span class="s2">&quot;Missing instance data for this datepicker&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Update or retrieve the settings for a date picker attached to an input field or division.</span>
</span><span class='line'><span class="cm">  * @param  target  element - the target input field or division or span</span>
</span><span class='line'><span class="cm">  * @param  name object - the new settings to update or</span>
</span><span class='line'><span class="cm">  *              string - the name of the setting to change or retrieve,</span>
</span><span class='line'><span class="cm">  *              when retrieving also &quot;all&quot; for all instance settings or</span>
</span><span class='line'><span class="cm">  *              &quot;defaults&quot; for all global defaults</span>
</span><span class='line'><span class="cm">  * @param  value   any - the new value for the setting</span>
</span><span class='line'><span class="cm">  *              (omit if above is an object or to retrieve a value)</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="nx">_optionDatepicker</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">settings</span><span class="p">,</span> <span class="nx">date</span><span class="p">,</span> <span class="nx">minDate</span><span class="p">,</span> <span class="nx">maxDate</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">inst</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getInst</span><span class="p">(</span><span class="nx">target</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">name</span> <span class="o">===</span> <span class="s2">&quot;string&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="p">(</span><span class="nx">name</span> <span class="o">===</span> <span class="s2">&quot;defaults&quot;</span> <span class="o">?</span> <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_defaults</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>              <span class="p">(</span><span class="nx">inst</span> <span class="o">?</span> <span class="p">(</span><span class="nx">name</span> <span class="o">===</span> <span class="s2">&quot;all&quot;</span> <span class="o">?</span> <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">settings</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>              <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">name</span><span class="p">))</span> <span class="o">:</span> <span class="kc">null</span><span class="p">));</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">settings</span> <span class="o">=</span> <span class="nx">name</span> <span class="o">||</span> <span class="p">{};</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">name</span> <span class="o">===</span> <span class="s2">&quot;string&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">settings</span> <span class="o">=</span> <span class="p">{};</span>
</span><span class='line'>          <span class="nx">settings</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_curInst</span> <span class="o">===</span> <span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">this</span><span class="p">.</span><span class="nx">_hideDatepicker</span><span class="p">();</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>          <span class="nx">date</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getDateDatepicker</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">minDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getMinMaxDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">maxDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getMinMaxDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">extendRemove</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">settings</span><span class="p">);</span>
</span><span class='line'>          <span class="c1">// reformat the old minDate/maxDate values if dateFormat changes and a new minDate/maxDate isn&#39;t provided</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="nx">minDate</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">dateFormat</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="o">&amp;&amp;</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">minDate</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">inst</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">minDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_formatDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">minDate</span><span class="p">);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="nx">maxDate</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">dateFormat</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="o">&amp;&amp;</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">maxDate</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">inst</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">maxDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_formatDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">maxDate</span><span class="p">);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span> <span class="s2">&quot;disabled&quot;</span> <span class="k">in</span> <span class="nx">settings</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">disabled</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="k">this</span><span class="p">.</span><span class="nx">_disableDatepicker</span><span class="p">(</span><span class="nx">target</span><span class="p">);</span>
</span><span class='line'>              <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                  <span class="k">this</span><span class="p">.</span><span class="nx">_enableDatepicker</span><span class="p">(</span><span class="nx">target</span><span class="p">);</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_attachments</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">target</span><span class="p">),</span> <span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_autoSize</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_setDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">date</span><span class="p">);</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_updateAlternate</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_updateDatepicker</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// change method deprecated</span>
</span><span class='line'>  <span class="nx">_changeDatepicker</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_optionDatepicker</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Redraw the date picker attached to an input field or division.</span>
</span><span class='line'><span class="cm">  * @param  target  element - the target input field or division or span</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="nx">_refreshDatepicker</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">inst</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getInst</span><span class="p">(</span><span class="nx">target</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_updateDatepicker</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Set the dates for a jQuery selection.</span>
</span><span class='line'><span class="cm">  * @param  target element - the target input field or division or span</span>
</span><span class='line'><span class="cm">  * @param  date Date - the new date</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="nx">_setDateDatepicker</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">date</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">inst</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getInst</span><span class="p">(</span><span class="nx">target</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_setDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">date</span><span class="p">);</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_updateDatepicker</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_updateAlternate</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Get the date(s) for the first entry in a jQuery selection.</span>
</span><span class='line'><span class="cm">  * @param  target element - the target input field or division or span</span>
</span><span class='line'><span class="cm">  * @param  noDefault boolean - true if no default date is to be used</span>
</span><span class='line'><span class="cm">  * @return Date - the current date</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="nx">_getDateDatepicker</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">noDefault</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">inst</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getInst</span><span class="p">(</span><span class="nx">target</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">inst</span><span class="p">.</span><span class="nx">inline</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_setDateFromField</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">noDefault</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">return</span> <span class="p">(</span><span class="nx">inst</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">)</span> <span class="o">:</span> <span class="kc">null</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Handle keystrokes. */</span>
</span><span class='line'>  <span class="nx">_doKeyDown</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">onSelect</span><span class="p">,</span> <span class="nx">dateStr</span><span class="p">,</span> <span class="nx">sel</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">inst</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_getInst</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">handled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">isRTL</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="s2">&quot;.ui-datepicker-rtl&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">_keyEvent</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_datepickerShowing</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">switch</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">keyCode</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">case</span> <span class="mi">9</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_hideDatepicker</span><span class="p">();</span>
</span><span class='line'>                      <span class="nx">handled</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>                      <span class="k">break</span><span class="p">;</span> <span class="c1">// hide on tab out</span>
</span><span class='line'>              <span class="k">case</span> <span class="mi">13</span><span class="o">:</span> <span class="nx">sel</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;td.&quot;</span> <span class="o">+</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_dayOverClass</span> <span class="o">+</span> <span class="s2">&quot;:not(.&quot;</span> <span class="o">+</span>
</span><span class='line'>                                  <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_currentClass</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">);</span>
</span><span class='line'>                      <span class="k">if</span> <span class="p">(</span><span class="nx">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>                          <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_selectDay</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedMonth</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedYear</span><span class="p">,</span> <span class="nx">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span><span class='line'>                      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>                      <span class="nx">onSelect</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;onSelect&quot;</span><span class="p">);</span>
</span><span class='line'>                      <span class="k">if</span> <span class="p">(</span><span class="nx">onSelect</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                          <span class="nx">dateStr</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_formatDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>                          <span class="c1">// trigger custom callback</span>
</span><span class='line'>                          <span class="nx">onSelect</span><span class="p">.</span><span class="nx">apply</span><span class="p">((</span><span class="nx">inst</span><span class="p">.</span><span class="nx">input</span> <span class="o">?</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">:</span> <span class="kc">null</span><span class="p">),</span> <span class="p">[</span><span class="nx">dateStr</span><span class="p">,</span> <span class="nx">inst</span><span class="p">]);</span>
</span><span class='line'>                      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                          <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_hideDatepicker</span><span class="p">();</span>
</span><span class='line'>                      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>                      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span> <span class="c1">// don&#39;t submit the form</span>
</span><span class='line'>              <span class="k">case</span> <span class="mi">27</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_hideDatepicker</span><span class="p">();</span>
</span><span class='line'>                      <span class="k">break</span><span class="p">;</span> <span class="c1">// hide on escape</span>
</span><span class='line'>              <span class="k">case</span> <span class="mi">33</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_adjustDate</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">ctrlKey</span> <span class="o">?</span>
</span><span class='line'>                          <span class="o">-</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;stepBigMonths&quot;</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>                          <span class="o">-</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;stepMonths&quot;</span><span class="p">)),</span> <span class="s2">&quot;M&quot;</span><span class="p">);</span>
</span><span class='line'>                      <span class="k">break</span><span class="p">;</span> <span class="c1">// previous month/year on page up/+ ctrl</span>
</span><span class='line'>              <span class="k">case</span> <span class="mi">34</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_adjustDate</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">ctrlKey</span> <span class="o">?</span>
</span><span class='line'>                          <span class="o">+</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;stepBigMonths&quot;</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>                          <span class="o">+</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;stepMonths&quot;</span><span class="p">)),</span> <span class="s2">&quot;M&quot;</span><span class="p">);</span>
</span><span class='line'>                      <span class="k">break</span><span class="p">;</span> <span class="c1">// next month/year on page down/+ ctrl</span>
</span><span class='line'>              <span class="k">case</span> <span class="mi">35</span><span class="o">:</span> <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">ctrlKey</span> <span class="o">||</span> <span class="nx">event</span><span class="p">.</span><span class="nx">metaKey</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                          <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_clearDate</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">);</span>
</span><span class='line'>                      <span class="p">}</span>
</span><span class='line'>                      <span class="nx">handled</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">ctrlKey</span> <span class="o">||</span> <span class="nx">event</span><span class="p">.</span><span class="nx">metaKey</span><span class="p">;</span>
</span><span class='line'>                      <span class="k">break</span><span class="p">;</span> <span class="c1">// clear on ctrl or command +end</span>
</span><span class='line'>              <span class="k">case</span> <span class="mi">36</span><span class="o">:</span> <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">ctrlKey</span> <span class="o">||</span> <span class="nx">event</span><span class="p">.</span><span class="nx">metaKey</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                          <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_gotoToday</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">);</span>
</span><span class='line'>                      <span class="p">}</span>
</span><span class='line'>                      <span class="nx">handled</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">ctrlKey</span> <span class="o">||</span> <span class="nx">event</span><span class="p">.</span><span class="nx">metaKey</span><span class="p">;</span>
</span><span class='line'>                      <span class="k">break</span><span class="p">;</span> <span class="c1">// current on ctrl or command +home</span>
</span><span class='line'>              <span class="k">case</span> <span class="mi">37</span><span class="o">:</span> <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">ctrlKey</span> <span class="o">||</span> <span class="nx">event</span><span class="p">.</span><span class="nx">metaKey</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                          <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_adjustDate</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span> <span class="p">(</span><span class="nx">isRTL</span> <span class="o">?</span> <span class="o">+</span><span class="mi">1</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;D&quot;</span><span class="p">);</span>
</span><span class='line'>                      <span class="p">}</span>
</span><span class='line'>                      <span class="nx">handled</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">ctrlKey</span> <span class="o">||</span> <span class="nx">event</span><span class="p">.</span><span class="nx">metaKey</span><span class="p">;</span>
</span><span class='line'>                      <span class="c1">// -1 day on ctrl or command +left</span>
</span><span class='line'>                      <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">originalEvent</span><span class="p">.</span><span class="nx">altKey</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                          <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_adjustDate</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">ctrlKey</span> <span class="o">?</span>
</span><span class='line'>                              <span class="o">-</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;stepBigMonths&quot;</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>                              <span class="o">-</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;stepMonths&quot;</span><span class="p">)),</span> <span class="s2">&quot;M&quot;</span><span class="p">);</span>
</span><span class='line'>                      <span class="p">}</span>
</span><span class='line'>                      <span class="c1">// next month/year on alt +left on Mac</span>
</span><span class='line'>                      <span class="k">break</span><span class="p">;</span>
</span><span class='line'>              <span class="k">case</span> <span class="mi">38</span><span class="o">:</span> <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">ctrlKey</span> <span class="o">||</span> <span class="nx">event</span><span class="p">.</span><span class="nx">metaKey</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                          <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_adjustDate</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">);</span>
</span><span class='line'>                      <span class="p">}</span>
</span><span class='line'>                      <span class="nx">handled</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">ctrlKey</span> <span class="o">||</span> <span class="nx">event</span><span class="p">.</span><span class="nx">metaKey</span><span class="p">;</span>
</span><span class='line'>                      <span class="k">break</span><span class="p">;</span> <span class="c1">// -1 week on ctrl or command +up</span>
</span><span class='line'>              <span class="k">case</span> <span class="mi">39</span><span class="o">:</span> <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">ctrlKey</span> <span class="o">||</span> <span class="nx">event</span><span class="p">.</span><span class="nx">metaKey</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                          <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_adjustDate</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span> <span class="p">(</span><span class="nx">isRTL</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;D&quot;</span><span class="p">);</span>
</span><span class='line'>                      <span class="p">}</span>
</span><span class='line'>                      <span class="nx">handled</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">ctrlKey</span> <span class="o">||</span> <span class="nx">event</span><span class="p">.</span><span class="nx">metaKey</span><span class="p">;</span>
</span><span class='line'>                      <span class="c1">// +1 day on ctrl or command +right</span>
</span><span class='line'>                      <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">originalEvent</span><span class="p">.</span><span class="nx">altKey</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                          <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_adjustDate</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">ctrlKey</span> <span class="o">?</span>
</span><span class='line'>                              <span class="o">+</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;stepBigMonths&quot;</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>                              <span class="o">+</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;stepMonths&quot;</span><span class="p">)),</span> <span class="s2">&quot;M&quot;</span><span class="p">);</span>
</span><span class='line'>                      <span class="p">}</span>
</span><span class='line'>                      <span class="c1">// next month/year on alt +right</span>
</span><span class='line'>                      <span class="k">break</span><span class="p">;</span>
</span><span class='line'>              <span class="k">case</span> <span class="mi">40</span><span class="o">:</span> <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">ctrlKey</span> <span class="o">||</span> <span class="nx">event</span><span class="p">.</span><span class="nx">metaKey</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                          <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_adjustDate</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span> <span class="o">+</span><span class="mi">7</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">);</span>
</span><span class='line'>                      <span class="p">}</span>
</span><span class='line'>                      <span class="nx">handled</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">ctrlKey</span> <span class="o">||</span> <span class="nx">event</span><span class="p">.</span><span class="nx">metaKey</span><span class="p">;</span>
</span><span class='line'>                      <span class="k">break</span><span class="p">;</span> <span class="c1">// +1 week on ctrl or command +down</span>
</span><span class='line'>              <span class="k">default</span><span class="o">:</span> <span class="nx">handled</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">keyCode</span> <span class="o">===</span> <span class="mi">36</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span><span class="p">.</span><span class="nx">ctrlKey</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// display the date picker on ctrl+home</span>
</span><span class='line'>          <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_showDatepicker</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">handled</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">handled</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span><span class='line'>          <span class="nx">event</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Filter entered characters - based on date format. */</span>
</span><span class='line'>  <span class="nx">_doKeyPress</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">chars</span><span class="p">,</span> <span class="nx">chr</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">inst</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_getInst</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;constrainInput&quot;</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">chars</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_possibleChars</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;dateFormat&quot;</span><span class="p">));</span>
</span><span class='line'>          <span class="nx">chr</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">charCode</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="nx">event</span><span class="p">.</span><span class="nx">keyCode</span> <span class="o">:</span> <span class="nx">event</span><span class="p">.</span><span class="nx">charCode</span><span class="p">);</span>
</span><span class='line'>          <span class="k">return</span> <span class="nx">event</span><span class="p">.</span><span class="nx">ctrlKey</span> <span class="o">||</span> <span class="nx">event</span><span class="p">.</span><span class="nx">metaKey</span> <span class="o">||</span> <span class="p">(</span><span class="nx">chr</span> <span class="o">&lt;</span> <span class="s2">&quot; &quot;</span> <span class="o">||</span> <span class="o">!</span><span class="nx">chars</span> <span class="o">||</span> <span class="nx">chars</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">chr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Synchronise manual entry and field/alternate field. */</span>
</span><span class='line'>  <span class="nx">_doKeyUp</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">date</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">inst</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_getInst</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">()</span> <span class="o">!==</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">lastVal</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">try</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">date</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">parseDate</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;dateFormat&quot;</span><span class="p">),</span>
</span><span class='line'>                  <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">input</span> <span class="o">?</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">()</span> <span class="o">:</span> <span class="kc">null</span><span class="p">),</span>
</span><span class='line'>                  <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_getFormatConfig</span><span class="p">(</span><span class="nx">inst</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// only if valid</span>
</span><span class='line'>                  <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_setDateFromField</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>                  <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_updateAlternate</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>                  <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_updateDatepicker</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Pop-up the date picker for a given input field.</span>
</span><span class='line'><span class="cm">  * If false returned from beforeShow event handler do not show.</span>
</span><span class='line'><span class="cm">  * @param  input  element - the input field attached to the date picker or</span>
</span><span class='line'><span class="cm">  *                  event - if triggered by focus</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="nx">_showDatepicker</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">input</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">target</span> <span class="o">||</span> <span class="nx">input</span><span class="p">;</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">input</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="o">!==</span> <span class="s2">&quot;input&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// find from button/image trigger</span>
</span><span class='line'>          <span class="nx">input</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="nx">input</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_isDisabledDatepicker</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="o">||</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_lastInput</span> <span class="o">===</span> <span class="nx">input</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// already here</span>
</span><span class='line'>          <span class="k">return</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">inst</span><span class="p">,</span> <span class="nx">beforeShow</span><span class="p">,</span> <span class="nx">beforeShowSettings</span><span class="p">,</span> <span class="nx">isFixed</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">offset</span><span class="p">,</span> <span class="nx">showAnim</span><span class="p">,</span> <span class="nx">duration</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">inst</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_getInst</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_curInst</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_curInst</span> <span class="o">!==</span> <span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_curInst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">.</span><span class="nx">stop</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span> <span class="nx">inst</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_datepickerShowing</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_hideDatepicker</span><span class="p">(</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_curInst</span><span class="p">.</span><span class="nx">input</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">beforeShow</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;beforeShow&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">beforeShowSettings</span> <span class="o">=</span> <span class="nx">beforeShow</span> <span class="o">?</span> <span class="nx">beforeShow</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">input</span><span class="p">,</span> <span class="p">[</span><span class="nx">input</span><span class="p">,</span> <span class="nx">inst</span><span class="p">])</span> <span class="o">:</span> <span class="p">{};</span>
</span><span class='line'>      <span class="k">if</span><span class="p">(</span><span class="nx">beforeShowSettings</span> <span class="o">===</span> <span class="kc">false</span><span class="p">){</span>
</span><span class='line'>          <span class="k">return</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nx">extendRemove</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">beforeShowSettings</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">lastVal</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_lastInput</span> <span class="o">=</span> <span class="nx">input</span><span class="p">;</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_setDateFromField</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_inDialog</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// hide cursor</span>
</span><span class='line'>          <span class="nx">input</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_pos</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// position below input</span>
</span><span class='line'>          <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_pos</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_findPos</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="p">;</span> <span class="c1">// add the height</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">isFixed</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">(</span><span class="nx">input</span><span class="p">).</span><span class="nx">parents</span><span class="p">().</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">isFixed</span> <span class="o">|=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;fixed&quot;</span><span class="p">;</span>
</span><span class='line'>          <span class="k">return</span> <span class="o">!</span><span class="nx">isFixed</span><span class="p">;</span>
</span><span class='line'>      <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">offset</span> <span class="o">=</span> <span class="p">{</span><span class="nx">left</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">top</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]};</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_pos</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span><span class='line'>      <span class="c1">//to avoid flashes on Firefox</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">.</span><span class="nx">empty</span><span class="p">();</span>
</span><span class='line'>      <span class="c1">// determine sizing offscreen</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">.</span><span class="nx">css</span><span class="p">({</span><span class="nx">position</span><span class="o">:</span> <span class="s2">&quot;absolute&quot;</span><span class="p">,</span> <span class="nx">display</span><span class="o">:</span> <span class="s2">&quot;block&quot;</span><span class="p">,</span> <span class="nx">top</span><span class="o">:</span> <span class="s2">&quot;-1000px&quot;</span><span class="p">});</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_updateDatepicker</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>      <span class="c1">// fix width for dynamic number of date pickers</span>
</span><span class='line'>      <span class="c1">// and adjust position before showing</span>
</span><span class='line'>      <span class="nx">offset</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_checkOffset</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">offset</span><span class="p">,</span> <span class="nx">isFixed</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">.</span><span class="nx">css</span><span class="p">({</span><span class="nx">position</span><span class="o">:</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_inDialog</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">blockUI</span> <span class="o">?</span>
</span><span class='line'>          <span class="s2">&quot;static&quot;</span> <span class="o">:</span> <span class="p">(</span><span class="nx">isFixed</span> <span class="o">?</span> <span class="s2">&quot;fixed&quot;</span> <span class="o">:</span> <span class="s2">&quot;absolute&quot;</span><span class="p">)),</span> <span class="nx">display</span><span class="o">:</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">left</span><span class="o">:</span> <span class="nx">offset</span><span class="p">.</span><span class="nx">left</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span><span class="p">,</span> <span class="nx">top</span><span class="o">:</span> <span class="nx">offset</span><span class="p">.</span><span class="nx">top</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span><span class="p">});</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inst</span><span class="p">.</span><span class="nx">inline</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">showAnim</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;showAnim&quot;</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">duration</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;duration&quot;</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">.</span><span class="nx">zIndex</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">input</span><span class="p">).</span><span class="nx">zIndex</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_datepickerShowing</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span> <span class="nx">$</span><span class="p">.</span><span class="nx">effects</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">effects</span><span class="p">.</span><span class="nx">effect</span><span class="p">[</span> <span class="nx">showAnim</span> <span class="p">]</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">.</span><span class="nx">show</span><span class="p">(</span><span class="nx">showAnim</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;showOptions&quot;</span><span class="p">),</span> <span class="nx">duration</span><span class="p">);</span>
</span><span class='line'>          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">[</span><span class="nx">showAnim</span> <span class="o">||</span> <span class="s2">&quot;show&quot;</span><span class="p">](</span><span class="nx">showAnim</span> <span class="o">?</span> <span class="nx">duration</span> <span class="o">:</span> <span class="kc">null</span><span class="p">);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="s2">&quot;:visible&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="s2">&quot;:disabled&quot;</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_curInst</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Generate the date picker content. */</span>
</span><span class='line'>  <span class="nx">_updateDatepicker</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">maxRows</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="c1">//Reset the max number of rows being displayed (see #7043)</span>
</span><span class='line'>      <span class="nx">instActive</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">;</span> <span class="c1">// for delegate hover events</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">.</span><span class="nx">empty</span><span class="p">().</span><span class="nx">append</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_generateHTML</span><span class="p">(</span><span class="nx">inst</span><span class="p">));</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_attachHandlers</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">_dayOverClass</span> <span class="o">+</span> <span class="s2">&quot; a&quot;</span><span class="p">).</span><span class="nx">mouseover</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">origyearshtml</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">numMonths</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getNumberOfMonths</span><span class="p">(</span><span class="nx">inst</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">cols</span> <span class="o">=</span> <span class="nx">numMonths</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
</span><span class='line'>          <span class="nx">width</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="s2">&quot;ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4&quot;</span><span class="p">).</span><span class="nx">width</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">cols</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;ui-datepicker-multi-&quot;</span> <span class="o">+</span> <span class="nx">cols</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">width</span> <span class="o">*</span> <span class="nx">cols</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;em&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">[(</span><span class="nx">numMonths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!==</span> <span class="mi">1</span> <span class="o">||</span> <span class="nx">numMonths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!==</span> <span class="mi">1</span> <span class="o">?</span> <span class="s2">&quot;add&quot;</span> <span class="o">:</span> <span class="s2">&quot;remove&quot;</span><span class="p">)</span> <span class="o">+</span>
</span><span class='line'>          <span class="s2">&quot;Class&quot;</span><span class="p">](</span><span class="s2">&quot;ui-datepicker-multi&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">[(</span><span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;isRTL&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;add&quot;</span> <span class="o">:</span> <span class="s2">&quot;remove&quot;</span><span class="p">)</span> <span class="o">+</span>
</span><span class='line'>          <span class="s2">&quot;Class&quot;</span><span class="p">](</span><span class="s2">&quot;ui-datepicker-rtl&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// #6694 - don&#39;t focus the input if it&#39;s already focused</span>
</span><span class='line'>      <span class="c1">// this breaks the change event in IE</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span> <span class="o">===</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_curInst</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_datepickerShowing</span> <span class="o">&amp;&amp;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span> <span class="o">&amp;&amp;</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="s2">&quot;:visible&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="s2">&quot;:disabled&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!==</span> <span class="nb">document</span><span class="p">.</span><span class="nx">activeElement</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// deffered render of the years select (to avoid flashes on Firefox)</span>
</span><span class='line'>      <span class="k">if</span><span class="p">(</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">yearshtml</span> <span class="p">){</span>
</span><span class='line'>          <span class="nx">origyearshtml</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">yearshtml</span><span class="p">;</span>
</span><span class='line'>          <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>              <span class="c1">//assure that inst.yearshtml didn&#39;t change.</span>
</span><span class='line'>              <span class="k">if</span><span class="p">(</span> <span class="nx">origyearshtml</span> <span class="o">===</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">yearshtml</span> <span class="o">&amp;&amp;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">yearshtml</span> <span class="p">){</span>
</span><span class='line'>                  <span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;select.ui-datepicker-year:first&quot;</span><span class="p">).</span><span class="nx">replaceWith</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">yearshtml</span><span class="p">);</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="nx">origyearshtml</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">yearshtml</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span><span class='line'>          <span class="p">},</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Retrieve the size of left and top borders for an element.</span>
</span><span class='line'><span class="cm">  * @param  elem  (jQuery object) the element of interest</span>
</span><span class='line'><span class="cm">  * @return  (number[2]) the left and top borders</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="nx">_getBorders</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elem</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">convert</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="p">{</span><span class="nx">thin</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">medium</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">thick</span><span class="o">:</span> <span class="mi">3</span><span class="p">}[</span><span class="nx">value</span><span class="p">]</span> <span class="o">||</span> <span class="nx">value</span><span class="p">;</span>
</span><span class='line'>      <span class="p">};</span>
</span><span class='line'>      <span class="k">return</span> <span class="p">[</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">convert</span><span class="p">(</span><span class="nx">elem</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;border-left-width&quot;</span><span class="p">))),</span>
</span><span class='line'>          <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">convert</span><span class="p">(</span><span class="nx">elem</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;border-top-width&quot;</span><span class="p">)))];</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Check positioning to remain on screen. */</span>
</span><span class='line'>  <span class="nx">_checkOffset</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">offset</span><span class="p">,</span> <span class="nx">isFixed</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">dpWidth</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">.</span><span class="nx">outerWidth</span><span class="p">(),</span>
</span><span class='line'>          <span class="nx">dpHeight</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">.</span><span class="nx">outerHeight</span><span class="p">(),</span>
</span><span class='line'>          <span class="nx">inputWidth</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span> <span class="o">?</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">outerWidth</span><span class="p">()</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">inputHeight</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span> <span class="o">?</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">outerHeight</span><span class="p">()</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">viewWidth</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">clientWidth</span> <span class="o">+</span> <span class="p">(</span><span class="nx">isFixed</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">scrollLeft</span><span class="p">()),</span>
</span><span class='line'>          <span class="nx">viewHeight</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">clientHeight</span> <span class="o">+</span> <span class="p">(</span><span class="nx">isFixed</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">scrollTop</span><span class="p">());</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">offset</span><span class="p">.</span><span class="nx">left</span> <span class="o">-=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;isRTL&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="nx">dpWidth</span> <span class="o">-</span> <span class="nx">inputWidth</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">offset</span><span class="p">.</span><span class="nx">left</span> <span class="o">-=</span> <span class="p">(</span><span class="nx">isFixed</span> <span class="o">&amp;&amp;</span> <span class="nx">offset</span><span class="p">.</span><span class="nx">left</span> <span class="o">===</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">offset</span><span class="p">().</span><span class="nx">left</span><span class="p">)</span> <span class="o">?</span> <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">scrollLeft</span><span class="p">()</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>      <span class="nx">offset</span><span class="p">.</span><span class="nx">top</span> <span class="o">-=</span> <span class="p">(</span><span class="nx">isFixed</span> <span class="o">&amp;&amp;</span> <span class="nx">offset</span><span class="p">.</span><span class="nx">top</span> <span class="o">===</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">offset</span><span class="p">().</span><span class="nx">top</span> <span class="o">+</span> <span class="nx">inputHeight</span><span class="p">))</span> <span class="o">?</span> <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">scrollTop</span><span class="p">()</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// now check if datepicker is showing outside window viewport - move to a better place if so.</span>
</span><span class='line'>      <span class="nx">offset</span><span class="p">.</span><span class="nx">left</span> <span class="o">-=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">offset</span><span class="p">.</span><span class="nx">left</span><span class="p">,</span> <span class="p">(</span><span class="nx">offset</span><span class="p">.</span><span class="nx">left</span> <span class="o">+</span> <span class="nx">dpWidth</span> <span class="o">&gt;</span> <span class="nx">viewWidth</span> <span class="o">&amp;&amp;</span> <span class="nx">viewWidth</span> <span class="o">&gt;</span> <span class="nx">dpWidth</span><span class="p">)</span> <span class="o">?</span>
</span><span class='line'>          <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">offset</span><span class="p">.</span><span class="nx">left</span> <span class="o">+</span> <span class="nx">dpWidth</span> <span class="o">-</span> <span class="nx">viewWidth</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">offset</span><span class="p">.</span><span class="nx">top</span> <span class="o">-=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">offset</span><span class="p">.</span><span class="nx">top</span><span class="p">,</span> <span class="p">(</span><span class="nx">offset</span><span class="p">.</span><span class="nx">top</span> <span class="o">+</span> <span class="nx">dpHeight</span> <span class="o">&gt;</span> <span class="nx">viewHeight</span> <span class="o">&amp;&amp;</span> <span class="nx">viewHeight</span> <span class="o">&gt;</span> <span class="nx">dpHeight</span><span class="p">)</span> <span class="o">?</span>
</span><span class='line'>          <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">dpHeight</span> <span class="o">+</span> <span class="nx">inputHeight</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">return</span> <span class="nx">offset</span><span class="p">;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Find an object&#39;s position on the screen. */</span>
</span><span class='line'>  <span class="nx">_findPos</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">position</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">inst</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getInst</span><span class="p">(</span><span class="nx">obj</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">isRTL</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;isRTL&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">while</span> <span class="p">(</span><span class="nx">obj</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s2">&quot;hidden&quot;</span> <span class="o">||</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">!==</span> <span class="mi">1</span> <span class="o">||</span> <span class="nx">$</span><span class="p">.</span><span class="nx">expr</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">hidden</span><span class="p">(</span><span class="nx">obj</span><span class="p">)))</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">obj</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">isRTL</span> <span class="o">?</span> <span class="s2">&quot;previousSibling&quot;</span> <span class="o">:</span> <span class="s2">&quot;nextSibling&quot;</span><span class="p">];</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">position</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">obj</span><span class="p">).</span><span class="nx">offset</span><span class="p">();</span>
</span><span class='line'>      <span class="k">return</span> <span class="p">[</span><span class="nx">position</span><span class="p">.</span><span class="nx">left</span><span class="p">,</span> <span class="nx">position</span><span class="p">.</span><span class="nx">top</span><span class="p">];</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Hide the date picker from view.</span>
</span><span class='line'><span class="cm">  * @param  input  element - the input field attached to the date picker</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="nx">_hideDatepicker</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">showAnim</span><span class="p">,</span> <span class="nx">duration</span><span class="p">,</span> <span class="nx">postProcess</span><span class="p">,</span> <span class="nx">onClose</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">inst</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_curInst</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inst</span> <span class="o">||</span> <span class="p">(</span><span class="nx">input</span> <span class="o">&amp;&amp;</span> <span class="nx">inst</span> <span class="o">!==</span> <span class="nx">$</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">input</span><span class="p">,</span> <span class="nx">PROP_NAME</span><span class="p">)))</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_datepickerShowing</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">showAnim</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;showAnim&quot;</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">duration</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;duration&quot;</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">postProcess</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_tidyDialog</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>          <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>          <span class="c1">// DEPRECATED: after BC for 1.8.x $.effects[ showAnim ] is not needed</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span> <span class="nx">$</span><span class="p">.</span><span class="nx">effects</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="nx">$</span><span class="p">.</span><span class="nx">effects</span><span class="p">.</span><span class="nx">effect</span><span class="p">[</span> <span class="nx">showAnim</span> <span class="p">]</span> <span class="o">||</span> <span class="nx">$</span><span class="p">.</span><span class="nx">effects</span><span class="p">[</span> <span class="nx">showAnim</span> <span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">.</span><span class="nx">hide</span><span class="p">(</span><span class="nx">showAnim</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;showOptions&quot;</span><span class="p">),</span> <span class="nx">duration</span><span class="p">,</span> <span class="nx">postProcess</span><span class="p">);</span>
</span><span class='line'>          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">[(</span><span class="nx">showAnim</span> <span class="o">===</span> <span class="s2">&quot;slideDown&quot;</span> <span class="o">?</span> <span class="s2">&quot;slideUp&quot;</span> <span class="o">:</span>
</span><span class='line'>                  <span class="p">(</span><span class="nx">showAnim</span> <span class="o">===</span> <span class="s2">&quot;fadeIn&quot;</span> <span class="o">?</span> <span class="s2">&quot;fadeOut&quot;</span> <span class="o">:</span> <span class="s2">&quot;hide&quot;</span><span class="p">))]((</span><span class="nx">showAnim</span> <span class="o">?</span> <span class="nx">duration</span> <span class="o">:</span> <span class="kc">null</span><span class="p">),</span> <span class="nx">postProcess</span><span class="p">);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">showAnim</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">postProcess</span><span class="p">();</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_datepickerShowing</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>          <span class="nx">onClose</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;onClose&quot;</span><span class="p">);</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="nx">onClose</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">onClose</span><span class="p">.</span><span class="nx">apply</span><span class="p">((</span><span class="nx">inst</span><span class="p">.</span><span class="nx">input</span> <span class="o">?</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">:</span> <span class="kc">null</span><span class="p">),</span> <span class="p">[(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">input</span> <span class="o">?</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">()</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="nx">inst</span><span class="p">]);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_lastInput</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_inDialog</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">this</span><span class="p">.</span><span class="nx">_dialogInput</span><span class="p">.</span><span class="nx">css</span><span class="p">({</span> <span class="nx">position</span><span class="o">:</span> <span class="s2">&quot;absolute&quot;</span><span class="p">,</span> <span class="nx">left</span><span class="o">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="nx">top</span><span class="o">:</span> <span class="s2">&quot;-100px&quot;</span> <span class="p">});</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">blockUI</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">$</span><span class="p">.</span><span class="nx">unblockUI</span><span class="p">();</span>
</span><span class='line'>                  <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">);</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_inDialog</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Tidy up after a dialog display. */</span>
</span><span class='line'>  <span class="nx">_tidyDialog</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_dialogClass</span><span class="p">).</span><span class="nx">unbind</span><span class="p">(</span><span class="s2">&quot;.ui-datepicker-calendar&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Close date picker if clicked elsewhere. */</span>
</span><span class='line'>  <span class="nx">_checkExternalClick</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_curInst</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">$target</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">inst</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_getInst</span><span class="p">(</span><span class="nx">$target</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span> <span class="p">(</span> <span class="p">(</span> <span class="nx">$target</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">id</span> <span class="o">!==</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_mainDivId</span> <span class="o">&amp;&amp;</span>
</span><span class='line'>              <span class="nx">$target</span><span class="p">.</span><span class="nx">parents</span><span class="p">(</span><span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_mainDivId</span><span class="p">).</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span>
</span><span class='line'>              <span class="o">!</span><span class="nx">$target</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">markerClassName</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
</span><span class='line'>              <span class="o">!</span><span class="nx">$target</span><span class="p">.</span><span class="nx">closest</span><span class="p">(</span><span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_triggerClass</span><span class="p">).</span><span class="nx">length</span> <span class="o">&amp;&amp;</span>
</span><span class='line'>              <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_datepickerShowing</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_inDialog</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">blockUI</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="o">||</span>
</span><span class='line'>          <span class="p">(</span> <span class="nx">$target</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">markerClassName</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_curInst</span> <span class="o">!==</span> <span class="nx">inst</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_hideDatepicker</span><span class="p">();</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Adjust one of the date sub-fields. */</span>
</span><span class='line'>  <span class="nx">_adjustDate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">offset</span><span class="p">,</span> <span class="nx">period</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">target</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">id</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">inst</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getInst</span><span class="p">(</span><span class="nx">target</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_isDisabledDatepicker</span><span class="p">(</span><span class="nx">target</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_adjustInstDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">offset</span> <span class="o">+</span>
</span><span class='line'>          <span class="p">(</span><span class="nx">period</span> <span class="o">===</span> <span class="s2">&quot;M&quot;</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;showCurrentAtPos&quot;</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">),</span> <span class="c1">// undo positioning</span>
</span><span class='line'>          <span class="nx">period</span><span class="p">);</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_updateDatepicker</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Action for current link. */</span>
</span><span class='line'>  <span class="nx">_gotoToday</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">date</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">target</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">id</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">inst</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getInst</span><span class="p">(</span><span class="nx">target</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;gotoCurrent&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">currentDay</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedDay</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">currentDay</span><span class="p">;</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">drawMonth</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedMonth</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">currentMonth</span><span class="p">;</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">drawYear</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedYear</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">currentYear</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">date</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedDay</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">();</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">drawMonth</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedMonth</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">();</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">drawYear</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedYear</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">();</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_notifyChange</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_adjustDate</span><span class="p">(</span><span class="nx">target</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Action for selecting a new month/year. */</span>
</span><span class='line'>  <span class="nx">_selectMonthYear</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">select</span><span class="p">,</span> <span class="nx">period</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">target</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">id</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">inst</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getInst</span><span class="p">(</span><span class="nx">target</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">inst</span><span class="p">[</span><span class="s2">&quot;selected&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">period</span> <span class="o">===</span> <span class="s2">&quot;M&quot;</span> <span class="o">?</span> <span class="s2">&quot;Month&quot;</span> <span class="o">:</span> <span class="s2">&quot;Year&quot;</span><span class="p">)]</span> <span class="o">=</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">[</span><span class="s2">&quot;draw&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">period</span> <span class="o">===</span> <span class="s2">&quot;M&quot;</span> <span class="o">?</span> <span class="s2">&quot;Month&quot;</span> <span class="o">:</span> <span class="s2">&quot;Year&quot;</span><span class="p">)]</span> <span class="o">=</span>
</span><span class='line'>          <span class="nb">parseInt</span><span class="p">(</span><span class="nx">select</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">select</span><span class="p">.</span><span class="nx">selectedIndex</span><span class="p">].</span><span class="nx">value</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_notifyChange</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_adjustDate</span><span class="p">(</span><span class="nx">target</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Action for selecting a day. */</span>
</span><span class='line'>  <span class="nx">_selectDay</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">month</span><span class="p">,</span> <span class="nx">year</span><span class="p">,</span> <span class="nx">td</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">inst</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">target</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">td</span><span class="p">).</span><span class="nx">hasClass</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_unselectableClass</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">_isDisabledDatepicker</span><span class="p">(</span><span class="nx">target</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">inst</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getInst</span><span class="p">(</span><span class="nx">target</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedDay</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">currentDay</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="nx">td</span><span class="p">).</span><span class="nx">html</span><span class="p">();</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedMonth</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">currentMonth</span> <span class="o">=</span> <span class="nx">month</span><span class="p">;</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedYear</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">currentYear</span> <span class="o">=</span> <span class="nx">year</span><span class="p">;</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_selectDate</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_formatDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">currentDay</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">currentMonth</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">currentYear</span><span class="p">));</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Erase the input field and hide the date picker. */</span>
</span><span class='line'>  <span class="nx">_clearDate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">target</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_selectDate</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Update the input field with the selected date. */</span>
</span><span class='line'>  <span class="nx">_selectDate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">dateStr</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">onSelect</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">target</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">id</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">inst</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getInst</span><span class="p">(</span><span class="nx">target</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">dateStr</span> <span class="o">=</span> <span class="p">(</span><span class="nx">dateStr</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">?</span> <span class="nx">dateStr</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">_formatDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">));</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">(</span><span class="nx">dateStr</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_updateAlternate</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">onSelect</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;onSelect&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">onSelect</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">onSelect</span><span class="p">.</span><span class="nx">apply</span><span class="p">((</span><span class="nx">inst</span><span class="p">.</span><span class="nx">input</span> <span class="o">?</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">:</span> <span class="kc">null</span><span class="p">),</span> <span class="p">[</span><span class="nx">dateStr</span><span class="p">,</span> <span class="nx">inst</span><span class="p">]);</span>  <span class="c1">// trigger custom callback</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;change&quot;</span><span class="p">);</span> <span class="c1">// fire the change event</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">inline</span><span class="p">){</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_updateDatepicker</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_hideDatepicker</span><span class="p">();</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_lastInput</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!==</span> <span class="s2">&quot;object&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span> <span class="c1">// restore focus</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_lastInput</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Update any alternate field to synchronise with the main field. */</span>
</span><span class='line'>  <span class="nx">_updateAlternate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">altFormat</span><span class="p">,</span> <span class="nx">date</span><span class="p">,</span> <span class="nx">dateStr</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">altField</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;altField&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">altField</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// update alternate field too</span>
</span><span class='line'>          <span class="nx">altFormat</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;altFormat&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;dateFormat&quot;</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">date</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">dateStr</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">formatDate</span><span class="p">(</span><span class="nx">altFormat</span><span class="p">,</span> <span class="nx">date</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getFormatConfig</span><span class="p">(</span><span class="nx">inst</span><span class="p">));</span>
</span><span class='line'>          <span class="nx">$</span><span class="p">(</span><span class="nx">altField</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">val</span><span class="p">(</span><span class="nx">dateStr</span><span class="p">);</span> <span class="p">});</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Set as beforeShowDay function to prevent selection of weekends.</span>
</span><span class='line'><span class="cm">  * @param  date  Date - the date to customise</span>
</span><span class='line'><span class="cm">  * @return [boolean, string] - is this date selectable?, what is its CSS class?</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="nx">noWeekends</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">day</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getDay</span><span class="p">();</span>
</span><span class='line'>      <span class="k">return</span> <span class="p">[(</span><span class="nx">day</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">day</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">),</span> <span class="s2">&quot;&quot;</span><span class="p">];</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Set as calculateWeek to determine the week of the year based on the ISO 8601 definition.</span>
</span><span class='line'><span class="cm">  * @param  date  Date - the date to get the week for</span>
</span><span class='line'><span class="cm">  * @return  number - the number of the week within the year that contains this date</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="nx">iso8601Week</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">time</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">checkDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getTime</span><span class="p">());</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// Find Thursday of this week starting on Monday</span>
</span><span class='line'>      <span class="nx">checkDate</span><span class="p">.</span><span class="nx">setDate</span><span class="p">(</span><span class="nx">checkDate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">-</span> <span class="p">(</span><span class="nx">checkDate</span><span class="p">.</span><span class="nx">getDay</span><span class="p">()</span> <span class="o">||</span> <span class="mi">7</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">time</span> <span class="o">=</span> <span class="nx">checkDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">();</span>
</span><span class='line'>      <span class="nx">checkDate</span><span class="p">.</span><span class="nx">setMonth</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="c1">// Compare with Jan 1</span>
</span><span class='line'>      <span class="nx">checkDate</span><span class="p">.</span><span class="nx">setDate</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'>      <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">((</span><span class="nx">time</span> <span class="o">-</span> <span class="nx">checkDate</span><span class="p">)</span> <span class="o">/</span> <span class="mi">86400000</span><span class="p">)</span> <span class="o">/</span> <span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Parse a string value into a date object.</span>
</span><span class='line'><span class="cm">  * See formatDate below for the possible formats.</span>
</span><span class='line'><span class="cm">  *</span>
</span><span class='line'><span class="cm">  * @param  format string - the expected format of the date</span>
</span><span class='line'><span class="cm">  * @param  value string - the date in the above format</span>
</span><span class='line'><span class="cm">  * @param  settings Object - attributes include:</span>
</span><span class='line'><span class="cm">  *                  shortYearCutoff  number - the cutoff year for determining the century (optional)</span>
</span><span class='line'><span class="cm">  *                  dayNamesShort   string[7] - abbreviated names of the days from Sunday (optional)</span>
</span><span class='line'><span class="cm">  *                  dayNames        string[7] - names of the days from Sunday (optional)</span>
</span><span class='line'><span class="cm">  *                  monthNamesShort string[12] - abbreviated names of the months (optional)</span>
</span><span class='line'><span class="cm">  *                  monthNames      string[12] - names of the months (optional)</span>
</span><span class='line'><span class="cm">  * @return  Date - the extracted date value or null if value is blank</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="nx">parseDate</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">format</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">format</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">value</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">throw</span> <span class="s2">&quot;Invalid arguments&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">value</span> <span class="o">=</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">value</span> <span class="o">===</span> <span class="s2">&quot;object&quot;</span> <span class="o">?</span> <span class="nx">value</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span> <span class="o">:</span> <span class="nx">value</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">===</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">iFormat</span><span class="p">,</span> <span class="nx">dim</span><span class="p">,</span> <span class="nx">extra</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">iValue</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">shortYearCutoffTemp</span> <span class="o">=</span> <span class="p">(</span><span class="nx">settings</span> <span class="o">?</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">shortYearCutoff</span> <span class="o">:</span> <span class="kc">null</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">_defaults</span><span class="p">.</span><span class="nx">shortYearCutoff</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">shortYearCutoff</span> <span class="o">=</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">shortYearCutoffTemp</span> <span class="o">!==</span> <span class="s2">&quot;string&quot;</span> <span class="o">?</span> <span class="nx">shortYearCutoffTemp</span> <span class="o">:</span>
</span><span class='line'>              <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">shortYearCutoffTemp</span><span class="p">,</span> <span class="mi">10</span><span class="p">)),</span>
</span><span class='line'>          <span class="nx">dayNamesShort</span> <span class="o">=</span> <span class="p">(</span><span class="nx">settings</span> <span class="o">?</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">dayNamesShort</span> <span class="o">:</span> <span class="kc">null</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">_defaults</span><span class="p">.</span><span class="nx">dayNamesShort</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">dayNames</span> <span class="o">=</span> <span class="p">(</span><span class="nx">settings</span> <span class="o">?</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">dayNames</span> <span class="o">:</span> <span class="kc">null</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">_defaults</span><span class="p">.</span><span class="nx">dayNames</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">monthNamesShort</span> <span class="o">=</span> <span class="p">(</span><span class="nx">settings</span> <span class="o">?</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">monthNamesShort</span> <span class="o">:</span> <span class="kc">null</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">_defaults</span><span class="p">.</span><span class="nx">monthNamesShort</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">monthNames</span> <span class="o">=</span> <span class="p">(</span><span class="nx">settings</span> <span class="o">?</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">monthNames</span> <span class="o">:</span> <span class="kc">null</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">_defaults</span><span class="p">.</span><span class="nx">monthNames</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">year</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">month</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">day</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">doy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">literal</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">date</span><span class="p">,</span>
</span><span class='line'>          <span class="c1">// Check whether a format character is doubled</span>
</span><span class='line'>          <span class="nx">lookAhead</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">match</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="kd">var</span> <span class="nx">matches</span> <span class="o">=</span> <span class="p">(</span><span class="nx">iFormat</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nx">format</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">format</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">iFormat</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">===</span> <span class="nx">match</span><span class="p">);</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span><span class="nx">matches</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">iFormat</span><span class="o">++</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="k">return</span> <span class="nx">matches</span><span class="p">;</span>
</span><span class='line'>          <span class="p">},</span>
</span><span class='line'>          <span class="c1">// Extract a number from the string value</span>
</span><span class='line'>          <span class="nx">getNumber</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">match</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="kd">var</span> <span class="nx">isDoubled</span> <span class="o">=</span> <span class="nx">lookAhead</span><span class="p">(</span><span class="nx">match</span><span class="p">),</span>
</span><span class='line'>                  <span class="nx">size</span> <span class="o">=</span> <span class="p">(</span><span class="nx">match</span> <span class="o">===</span> <span class="s2">&quot;@&quot;</span> <span class="o">?</span> <span class="mi">14</span> <span class="o">:</span> <span class="p">(</span><span class="nx">match</span> <span class="o">===</span> <span class="s2">&quot;!&quot;</span> <span class="o">?</span> <span class="mi">20</span> <span class="o">:</span>
</span><span class='line'>                  <span class="p">(</span><span class="nx">match</span> <span class="o">===</span> <span class="s2">&quot;y&quot;</span> <span class="o">&amp;&amp;</span> <span class="nx">isDoubled</span> <span class="o">?</span> <span class="mi">4</span> <span class="o">:</span> <span class="p">(</span><span class="nx">match</span> <span class="o">===</span> <span class="s2">&quot;o&quot;</span> <span class="o">?</span> <span class="mi">3</span> <span class="o">:</span> <span class="mi">2</span><span class="p">)))),</span>
</span><span class='line'>                  <span class="nx">digits</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s2">&quot;^\\d{1,&quot;</span> <span class="o">+</span> <span class="nx">size</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span><span class="p">),</span>
</span><span class='line'>                  <span class="nx">num</span> <span class="o">=</span> <span class="nx">value</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">iValue</span><span class="p">).</span><span class="nx">match</span><span class="p">(</span><span class="nx">digits</span><span class="p">);</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">num</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="k">throw</span> <span class="s2">&quot;Missing number at position &quot;</span> <span class="o">+</span> <span class="nx">iValue</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="nx">iValue</span> <span class="o">+=</span> <span class="nx">num</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span>
</span><span class='line'>              <span class="k">return</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">num</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">10</span><span class="p">);</span>
</span><span class='line'>          <span class="p">},</span>
</span><span class='line'>          <span class="c1">// Extract a name from the string value and convert to an index</span>
</span><span class='line'>          <span class="nx">getName</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">match</span><span class="p">,</span> <span class="nx">shortNames</span><span class="p">,</span> <span class="nx">longNames</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
</span><span class='line'>                  <span class="nx">names</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">lookAhead</span><span class="p">(</span><span class="nx">match</span><span class="p">)</span> <span class="o">?</span> <span class="nx">longNames</span> <span class="o">:</span> <span class="nx">shortNames</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">k</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                      <span class="k">return</span> <span class="p">[</span> <span class="p">[</span><span class="nx">k</span><span class="p">,</span> <span class="nx">v</span><span class="p">]</span> <span class="p">];</span>
</span><span class='line'>                  <span class="p">}).</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                      <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">length</span> <span class="o">-</span> <span class="nx">b</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">length</span><span class="p">);</span>
</span><span class='line'>                  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>              <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">names</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">pair</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span><span class='line'>                  <span class="k">if</span> <span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">iValue</span><span class="p">,</span> <span class="nx">name</span><span class="p">.</span><span class="nx">length</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="o">===</span> <span class="nx">name</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">())</span> <span class="p">{</span>
</span><span class='line'>                      <span class="nx">index</span> <span class="o">=</span> <span class="nx">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</span><span class='line'>                      <span class="nx">iValue</span> <span class="o">+=</span> <span class="nx">name</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
</span><span class='line'>                      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>                  <span class="p">}</span>
</span><span class='line'>              <span class="p">});</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="k">return</span> <span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                  <span class="k">throw</span> <span class="s2">&quot;Unknown name at position &quot;</span> <span class="o">+</span> <span class="nx">iValue</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>          <span class="p">},</span>
</span><span class='line'>          <span class="c1">// Confirm that a literal character matches the string value</span>
</span><span class='line'>          <span class="nx">checkLiteral</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">iValue</span><span class="p">)</span> <span class="o">!==</span> <span class="nx">format</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">iFormat</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>                  <span class="k">throw</span> <span class="s2">&quot;Unexpected literal at position &quot;</span> <span class="o">+</span> <span class="nx">iValue</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="nx">iValue</span><span class="o">++</span><span class="p">;</span>
</span><span class='line'>          <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">for</span> <span class="p">(</span><span class="nx">iFormat</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">iFormat</span> <span class="o">&lt;</span> <span class="nx">format</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">iFormat</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="nx">literal</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span><span class="nx">format</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">iFormat</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">lookAhead</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">literal</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">checkLiteral</span><span class="p">();</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">switch</span> <span class="p">(</span><span class="nx">format</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">iFormat</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>                  <span class="k">case</span> <span class="s2">&quot;d&quot;</span><span class="o">:</span>
</span><span class='line'>                      <span class="nx">day</span> <span class="o">=</span> <span class="nx">getNumber</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">);</span>
</span><span class='line'>                      <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                  <span class="k">case</span> <span class="s2">&quot;D&quot;</span><span class="o">:</span>
</span><span class='line'>                      <span class="nx">getName</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="nx">dayNamesShort</span><span class="p">,</span> <span class="nx">dayNames</span><span class="p">);</span>
</span><span class='line'>                      <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                  <span class="k">case</span> <span class="s2">&quot;o&quot;</span><span class="o">:</span>
</span><span class='line'>                      <span class="nx">doy</span> <span class="o">=</span> <span class="nx">getNumber</span><span class="p">(</span><span class="s2">&quot;o&quot;</span><span class="p">);</span>
</span><span class='line'>                      <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                  <span class="k">case</span> <span class="s2">&quot;m&quot;</span><span class="o">:</span>
</span><span class='line'>                      <span class="nx">month</span> <span class="o">=</span> <span class="nx">getNumber</span><span class="p">(</span><span class="s2">&quot;m&quot;</span><span class="p">);</span>
</span><span class='line'>                      <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                  <span class="k">case</span> <span class="s2">&quot;M&quot;</span><span class="o">:</span>
</span><span class='line'>                      <span class="nx">month</span> <span class="o">=</span> <span class="nx">getName</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="nx">monthNamesShort</span><span class="p">,</span> <span class="nx">monthNames</span><span class="p">);</span>
</span><span class='line'>                      <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                  <span class="k">case</span> <span class="s2">&quot;y&quot;</span><span class="o">:</span>
</span><span class='line'>                      <span class="nx">year</span> <span class="o">=</span> <span class="nx">getNumber</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">);</span>
</span><span class='line'>                      <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                  <span class="k">case</span> <span class="s2">&quot;@&quot;</span><span class="o">:</span>
</span><span class='line'>                      <span class="nx">date</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">getNumber</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">));</span>
</span><span class='line'>                      <span class="nx">year</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">();</span>
</span><span class='line'>                      <span class="nx">month</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>                      <span class="nx">day</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">();</span>
</span><span class='line'>                      <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                  <span class="k">case</span> <span class="s2">&quot;!&quot;</span><span class="o">:</span>
</span><span class='line'>                      <span class="nx">date</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">((</span><span class="nx">getNumber</span><span class="p">(</span><span class="s2">&quot;!&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">_ticksTo1970</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">);</span>
</span><span class='line'>                      <span class="nx">year</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">();</span>
</span><span class='line'>                      <span class="nx">month</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>                      <span class="nx">day</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">();</span>
</span><span class='line'>                      <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                  <span class="k">case</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">:</span>
</span><span class='line'>                      <span class="k">if</span> <span class="p">(</span><span class="nx">lookAhead</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)){</span>
</span><span class='line'>                          <span class="nx">checkLiteral</span><span class="p">();</span>
</span><span class='line'>                      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                          <span class="nx">literal</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>                      <span class="p">}</span>
</span><span class='line'>                      <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                  <span class="k">default</span><span class="o">:</span>
</span><span class='line'>                      <span class="nx">checkLiteral</span><span class="p">();</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">iValue</span> <span class="o">&lt;</span> <span class="nx">value</span><span class="p">.</span><span class="nx">length</span><span class="p">){</span>
</span><span class='line'>          <span class="nx">extra</span> <span class="o">=</span> <span class="nx">value</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">iValue</span><span class="p">);</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="sr">/^\s+/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">extra</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">throw</span> <span class="s2">&quot;Extra/unparsed characters found in date: &quot;</span> <span class="o">+</span> <span class="nx">extra</span><span class="p">;</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">year</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">year</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getFullYear</span><span class="p">();</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">year</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">year</span> <span class="o">+=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">-</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">+</span>
</span><span class='line'>              <span class="p">(</span><span class="nx">year</span> <span class="o">&lt;=</span> <span class="nx">shortYearCutoff</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="o">-</span><span class="mi">100</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">doy</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">month</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>          <span class="nx">day</span> <span class="o">=</span> <span class="nx">doy</span><span class="p">;</span>
</span><span class='line'>          <span class="k">do</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">dim</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getDaysInMonth</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">month</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span><span class="nx">day</span> <span class="o">&lt;=</span> <span class="nx">dim</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="k">break</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="nx">month</span><span class="o">++</span><span class="p">;</span>
</span><span class='line'>              <span class="nx">day</span> <span class="o">-=</span> <span class="nx">dim</span><span class="p">;</span>
</span><span class='line'>          <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">date</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_daylightSavingAdjust</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">month</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">day</span><span class="p">));</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">!==</span> <span class="nx">year</span> <span class="o">||</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">!==</span> <span class="nx">month</span> <span class="o">||</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="o">!==</span> <span class="nx">day</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">throw</span> <span class="s2">&quot;Invalid date&quot;</span><span class="p">;</span> <span class="c1">// E.g. 31/02/00</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">date</span><span class="p">;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Standard date formats. */</span>
</span><span class='line'>  <span class="nx">ATOM</span><span class="o">:</span> <span class="s2">&quot;yy-mm-dd&quot;</span><span class="p">,</span> <span class="c1">// RFC 3339 (ISO 8601)</span>
</span><span class='line'>  <span class="nx">COOKIE</span><span class="o">:</span> <span class="s2">&quot;D, dd M yy&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">ISO_8601</span><span class="o">:</span> <span class="s2">&quot;yy-mm-dd&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">RFC_822</span><span class="o">:</span> <span class="s2">&quot;D, d M y&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">RFC_850</span><span class="o">:</span> <span class="s2">&quot;DD, dd-M-y&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">RFC_1036</span><span class="o">:</span> <span class="s2">&quot;D, d M y&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">RFC_1123</span><span class="o">:</span> <span class="s2">&quot;D, d M yy&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">RFC_2822</span><span class="o">:</span> <span class="s2">&quot;D, d M yy&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">RSS</span><span class="o">:</span> <span class="s2">&quot;D, d M y&quot;</span><span class="p">,</span> <span class="c1">// RFC 822</span>
</span><span class='line'>  <span class="nx">TICKS</span><span class="o">:</span> <span class="s2">&quot;!&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">TIMESTAMP</span><span class="o">:</span> <span class="s2">&quot;@&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">W3C</span><span class="o">:</span> <span class="s2">&quot;yy-mm-dd&quot;</span><span class="p">,</span> <span class="c1">// ISO 8601</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">_ticksTo1970</span><span class="o">:</span> <span class="p">(((</span><span class="mi">1970</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">365</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="mi">1970</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="mi">1970</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">+</span>
</span><span class='line'>      <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="mi">1970</span> <span class="o">/</span> <span class="mi">400</span><span class="p">))</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">10000000</span><span class="p">),</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Format a date object into a string value.</span>
</span><span class='line'><span class="cm">  * The format can be combinations of the following:</span>
</span><span class='line'><span class="cm">  * d  - day of month (no leading zero)</span>
</span><span class='line'><span class="cm">  * dd - day of month (two digit)</span>
</span><span class='line'><span class="cm">  * o  - day of year (no leading zeros)</span>
</span><span class='line'><span class="cm">  * oo - day of year (three digit)</span>
</span><span class='line'><span class="cm">  * D  - day name short</span>
</span><span class='line'><span class="cm">  * DD - day name long</span>
</span><span class='line'><span class="cm">  * m  - month of year (no leading zero)</span>
</span><span class='line'><span class="cm">  * mm - month of year (two digit)</span>
</span><span class='line'><span class="cm">  * M  - month name short</span>
</span><span class='line'><span class="cm">  * MM - month name long</span>
</span><span class='line'><span class="cm">  * y  - year (two digit)</span>
</span><span class='line'><span class="cm">  * yy - year (four digit)</span>
</span><span class='line'><span class="cm">  * @ - Unix timestamp (ms since 01/01/1970)</span>
</span><span class='line'><span class="cm">  * ! - Windows ticks (100ns since 01/01/0001)</span>
</span><span class='line'><span class="cm">  * &quot;...&quot; - literal text</span>
</span><span class='line'><span class="cm">  * &#39;&#39; - single quote</span>
</span><span class='line'><span class="cm">  *</span>
</span><span class='line'><span class="cm">  * @param  format string - the desired format of the date</span>
</span><span class='line'><span class="cm">  * @param  date Date - the date value to format</span>
</span><span class='line'><span class="cm">  * @param  settings Object - attributes include:</span>
</span><span class='line'><span class="cm">  *                  dayNamesShort   string[7] - abbreviated names of the days from Sunday (optional)</span>
</span><span class='line'><span class="cm">  *                  dayNames        string[7] - names of the days from Sunday (optional)</span>
</span><span class='line'><span class="cm">  *                  monthNamesShort string[12] - abbreviated names of the months (optional)</span>
</span><span class='line'><span class="cm">  *                  monthNames      string[12] - names of the months (optional)</span>
</span><span class='line'><span class="cm">  * @return  string - the date in the above format</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="nx">formatDate</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">format</span><span class="p">,</span> <span class="nx">date</span><span class="p">,</span> <span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">iFormat</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">dayNamesShort</span> <span class="o">=</span> <span class="p">(</span><span class="nx">settings</span> <span class="o">?</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">dayNamesShort</span> <span class="o">:</span> <span class="kc">null</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">_defaults</span><span class="p">.</span><span class="nx">dayNamesShort</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">dayNames</span> <span class="o">=</span> <span class="p">(</span><span class="nx">settings</span> <span class="o">?</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">dayNames</span> <span class="o">:</span> <span class="kc">null</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">_defaults</span><span class="p">.</span><span class="nx">dayNames</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">monthNamesShort</span> <span class="o">=</span> <span class="p">(</span><span class="nx">settings</span> <span class="o">?</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">monthNamesShort</span> <span class="o">:</span> <span class="kc">null</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">_defaults</span><span class="p">.</span><span class="nx">monthNamesShort</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">monthNames</span> <span class="o">=</span> <span class="p">(</span><span class="nx">settings</span> <span class="o">?</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">monthNames</span> <span class="o">:</span> <span class="kc">null</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">_defaults</span><span class="p">.</span><span class="nx">monthNames</span><span class="p">,</span>
</span><span class='line'>          <span class="c1">// Check whether a format character is doubled</span>
</span><span class='line'>          <span class="nx">lookAhead</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">match</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="kd">var</span> <span class="nx">matches</span> <span class="o">=</span> <span class="p">(</span><span class="nx">iFormat</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nx">format</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">format</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">iFormat</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">===</span> <span class="nx">match</span><span class="p">);</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span><span class="nx">matches</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">iFormat</span><span class="o">++</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="k">return</span> <span class="nx">matches</span><span class="p">;</span>
</span><span class='line'>          <span class="p">},</span>
</span><span class='line'>          <span class="c1">// Format a number, with leading zero if necessary</span>
</span><span class='line'>          <span class="nx">formatNumber</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">match</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="kd">var</span> <span class="nx">num</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="o">+</span> <span class="nx">value</span><span class="p">;</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span><span class="nx">lookAhead</span><span class="p">(</span><span class="nx">match</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>                  <span class="k">while</span> <span class="p">(</span><span class="nx">num</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                      <span class="nx">num</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span> <span class="o">+</span> <span class="nx">num</span><span class="p">;</span>
</span><span class='line'>                  <span class="p">}</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="k">return</span> <span class="nx">num</span><span class="p">;</span>
</span><span class='line'>          <span class="p">},</span>
</span><span class='line'>          <span class="c1">// Format a name, short or long as requested</span>
</span><span class='line'>          <span class="nx">formatName</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">match</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">shortNames</span><span class="p">,</span> <span class="nx">longNames</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">return</span> <span class="p">(</span><span class="nx">lookAhead</span><span class="p">(</span><span class="nx">match</span><span class="p">)</span> <span class="o">?</span> <span class="nx">longNames</span><span class="p">[</span><span class="nx">value</span><span class="p">]</span> <span class="o">:</span> <span class="nx">shortNames</span><span class="p">[</span><span class="nx">value</span><span class="p">]);</span>
</span><span class='line'>          <span class="p">},</span>
</span><span class='line'>          <span class="nx">output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">literal</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">for</span> <span class="p">(</span><span class="nx">iFormat</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">iFormat</span> <span class="o">&lt;</span> <span class="nx">format</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">iFormat</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span><span class="nx">literal</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="k">if</span> <span class="p">(</span><span class="nx">format</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">iFormat</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">lookAhead</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>                      <span class="nx">literal</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>                  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                      <span class="nx">output</span> <span class="o">+=</span> <span class="nx">format</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">iFormat</span><span class="p">);</span>
</span><span class='line'>                  <span class="p">}</span>
</span><span class='line'>              <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                  <span class="k">switch</span> <span class="p">(</span><span class="nx">format</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">iFormat</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>                      <span class="k">case</span> <span class="s2">&quot;d&quot;</span><span class="o">:</span>
</span><span class='line'>                          <span class="nx">output</span> <span class="o">+=</span> <span class="nx">formatNumber</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">(),</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>                          <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                      <span class="k">case</span> <span class="s2">&quot;D&quot;</span><span class="o">:</span>
</span><span class='line'>                          <span class="nx">output</span> <span class="o">+=</span> <span class="nx">formatName</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getDay</span><span class="p">(),</span> <span class="nx">dayNamesShort</span><span class="p">,</span> <span class="nx">dayNames</span><span class="p">);</span>
</span><span class='line'>                          <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                      <span class="k">case</span> <span class="s2">&quot;o&quot;</span><span class="o">:</span>
</span><span class='line'>                          <span class="nx">output</span> <span class="o">+=</span> <span class="nx">formatNumber</span><span class="p">(</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
</span><span class='line'>                              <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">((</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">(),</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()).</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">-</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">).</span><span class="nx">getTime</span><span class="p">())</span> <span class="o">/</span> <span class="mi">86400000</span><span class="p">),</span> <span class="mi">3</span><span class="p">);</span>
</span><span class='line'>                          <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                      <span class="k">case</span> <span class="s2">&quot;m&quot;</span><span class="o">:</span>
</span><span class='line'>                          <span class="nx">output</span> <span class="o">+=</span> <span class="nx">formatNumber</span><span class="p">(</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>                          <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                      <span class="k">case</span> <span class="s2">&quot;M&quot;</span><span class="o">:</span>
</span><span class='line'>                          <span class="nx">output</span> <span class="o">+=</span> <span class="nx">formatName</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">(),</span> <span class="nx">monthNamesShort</span><span class="p">,</span> <span class="nx">monthNames</span><span class="p">);</span>
</span><span class='line'>                          <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                      <span class="k">case</span> <span class="s2">&quot;y&quot;</span><span class="o">:</span>
</span><span class='line'>                          <span class="nx">output</span> <span class="o">+=</span> <span class="p">(</span><span class="nx">lookAhead</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">:</span>
</span><span class='line'>                              <span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getYear</span><span class="p">()</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="o">?</span> <span class="s2">&quot;0&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getYear</span><span class="p">()</span> <span class="o">%</span> <span class="mi">100</span><span class="p">);</span>
</span><span class='line'>                          <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                      <span class="k">case</span> <span class="s2">&quot;@&quot;</span><span class="o">:</span>
</span><span class='line'>                          <span class="nx">output</span> <span class="o">+=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getTime</span><span class="p">();</span>
</span><span class='line'>                          <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                      <span class="k">case</span> <span class="s2">&quot;!&quot;</span><span class="o">:</span>
</span><span class='line'>                          <span class="nx">output</span> <span class="o">+=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">*</span> <span class="mi">10000</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">_ticksTo1970</span><span class="p">;</span>
</span><span class='line'>                          <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                      <span class="k">case</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">:</span>
</span><span class='line'>                          <span class="k">if</span> <span class="p">(</span><span class="nx">lookAhead</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>                              <span class="nx">output</span> <span class="o">+=</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
</span><span class='line'>                          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                              <span class="nx">literal</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>                          <span class="p">}</span>
</span><span class='line'>                          <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                      <span class="k">default</span><span class="o">:</span>
</span><span class='line'>                          <span class="nx">output</span> <span class="o">+=</span> <span class="nx">format</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">iFormat</span><span class="p">);</span>
</span><span class='line'>                  <span class="p">}</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">output</span><span class="p">;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Extract all possible characters from the date format. */</span>
</span><span class='line'>  <span class="nx">_possibleChars</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">format</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">iFormat</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">chars</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">literal</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
</span><span class='line'>          <span class="c1">// Check whether a format character is doubled</span>
</span><span class='line'>          <span class="nx">lookAhead</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">match</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="kd">var</span> <span class="nx">matches</span> <span class="o">=</span> <span class="p">(</span><span class="nx">iFormat</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nx">format</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">format</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">iFormat</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">===</span> <span class="nx">match</span><span class="p">);</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span><span class="nx">matches</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">iFormat</span><span class="o">++</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="k">return</span> <span class="nx">matches</span><span class="p">;</span>
</span><span class='line'>          <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">for</span> <span class="p">(</span><span class="nx">iFormat</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">iFormat</span> <span class="o">&lt;</span> <span class="nx">format</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">iFormat</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="nx">literal</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span><span class="nx">format</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">iFormat</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">lookAhead</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">literal</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">chars</span> <span class="o">+=</span> <span class="nx">format</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">iFormat</span><span class="p">);</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">switch</span> <span class="p">(</span><span class="nx">format</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">iFormat</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>                  <span class="k">case</span> <span class="s2">&quot;d&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;m&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;y&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;@&quot;</span><span class="o">:</span>
</span><span class='line'>                      <span class="nx">chars</span> <span class="o">+=</span> <span class="s2">&quot;0123456789&quot;</span><span class="p">;</span>
</span><span class='line'>                      <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                  <span class="k">case</span> <span class="s2">&quot;D&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;M&quot;</span><span class="o">:</span>
</span><span class='line'>                      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">// Accept anything</span>
</span><span class='line'>                  <span class="k">case</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">:</span>
</span><span class='line'>                      <span class="k">if</span> <span class="p">(</span><span class="nx">lookAhead</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>                          <span class="nx">chars</span> <span class="o">+=</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
</span><span class='line'>                      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                          <span class="nx">literal</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>                      <span class="p">}</span>
</span><span class='line'>                      <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                  <span class="k">default</span><span class="o">:</span>
</span><span class='line'>                      <span class="nx">chars</span> <span class="o">+=</span> <span class="nx">format</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">iFormat</span><span class="p">);</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">chars</span><span class="p">;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Get a setting value, defaulting if necessary. */</span>
</span><span class='line'>  <span class="nx">_get</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">settings</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="o">?</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">settings</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">_defaults</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Parse existing date and initialise date picker. */</span>
</span><span class='line'>  <span class="nx">_setDateFromField</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">noDefault</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">()</span> <span class="o">===</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">lastVal</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">dateFormat</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;dateFormat&quot;</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">dates</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">lastVal</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span> <span class="o">?</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">()</span> <span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">defaultDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getDefaultDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">date</span> <span class="o">=</span> <span class="nx">defaultDate</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">settings</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getFormatConfig</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">try</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">date</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseDate</span><span class="p">(</span><span class="nx">dateFormat</span><span class="p">,</span> <span class="nx">dates</span><span class="p">,</span> <span class="nx">settings</span><span class="p">)</span> <span class="o">||</span> <span class="nx">defaultDate</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">dates</span> <span class="o">=</span> <span class="p">(</span><span class="nx">noDefault</span> <span class="o">?</span> <span class="s2">&quot;&quot;</span> <span class="o">:</span> <span class="nx">dates</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedDay</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">();</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">drawMonth</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedMonth</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">();</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">drawYear</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedYear</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">();</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">currentDay</span> <span class="o">=</span> <span class="p">(</span><span class="nx">dates</span> <span class="o">?</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">currentMonth</span> <span class="o">=</span> <span class="p">(</span><span class="nx">dates</span> <span class="o">?</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">currentYear</span> <span class="o">=</span> <span class="p">(</span><span class="nx">dates</span> <span class="o">?</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_adjustInstDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Retrieve the default date shown on opening. */</span>
</span><span class='line'>  <span class="nx">_getDefaultDate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_restrictMinMax</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_determineDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;defaultDate&quot;</span><span class="p">),</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()));</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* A date may be specified as an exact value or a relative one. */</span>
</span><span class='line'>  <span class="nx">_determineDate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">date</span><span class="p">,</span> <span class="nx">defaultDate</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">offsetNumeric</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">offset</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="kd">var</span> <span class="nx">date</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
</span><span class='line'>              <span class="nx">date</span><span class="p">.</span><span class="nx">setDate</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="o">+</span> <span class="nx">offset</span><span class="p">);</span>
</span><span class='line'>              <span class="k">return</span> <span class="nx">date</span><span class="p">;</span>
</span><span class='line'>          <span class="p">},</span>
</span><span class='line'>          <span class="nx">offsetString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">offset</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">try</span> <span class="p">{</span>
</span><span class='line'>                  <span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">parseDate</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;dateFormat&quot;</span><span class="p">),</span>
</span><span class='line'>                      <span class="nx">offset</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_getFormatConfig</span><span class="p">(</span><span class="nx">inst</span><span class="p">));</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="c1">// Ignore</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>              <span class="kd">var</span> <span class="nx">date</span> <span class="o">=</span> <span class="p">(</span><span class="nx">offset</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^c/</span><span class="p">)</span> <span class="o">?</span>
</span><span class='line'>                  <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_getDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">)</span> <span class="o">:</span> <span class="kc">null</span><span class="p">)</span> <span class="o">||</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span>
</span><span class='line'>                  <span class="nx">year</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span>
</span><span class='line'>                  <span class="nx">month</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">(),</span>
</span><span class='line'>                  <span class="nx">day</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">(),</span>
</span><span class='line'>                  <span class="nx">pattern</span> <span class="o">=</span> <span class="sr">/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g</span><span class="p">,</span>
</span><span class='line'>                  <span class="nx">matches</span> <span class="o">=</span> <span class="nx">pattern</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">offset</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>              <span class="k">while</span> <span class="p">(</span><span class="nx">matches</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="k">switch</span> <span class="p">(</span><span class="nx">matches</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">||</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                      <span class="k">case</span> <span class="s2">&quot;d&quot;</span> <span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;D&quot;</span> <span class="o">:</span>
</span><span class='line'>                          <span class="nx">day</span> <span class="o">+=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">matches</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">10</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                      <span class="k">case</span> <span class="s2">&quot;w&quot;</span> <span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;W&quot;</span> <span class="o">:</span>
</span><span class='line'>                          <span class="nx">day</span> <span class="o">+=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">matches</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="mi">7</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                      <span class="k">case</span> <span class="s2">&quot;m&quot;</span> <span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;M&quot;</span> <span class="o">:</span>
</span><span class='line'>                          <span class="nx">month</span> <span class="o">+=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">matches</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">10</span><span class="p">);</span>
</span><span class='line'>                          <span class="nx">day</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">day</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_getDaysInMonth</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">month</span><span class="p">));</span>
</span><span class='line'>                          <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                      <span class="k">case</span> <span class="s2">&quot;y&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;Y&quot;</span> <span class="o">:</span>
</span><span class='line'>                          <span class="nx">year</span> <span class="o">+=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">matches</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">10</span><span class="p">);</span>
</span><span class='line'>                          <span class="nx">day</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">day</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_getDaysInMonth</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">month</span><span class="p">));</span>
</span><span class='line'>                          <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                  <span class="p">}</span>
</span><span class='line'>                  <span class="nx">matches</span> <span class="o">=</span> <span class="nx">pattern</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">offset</span><span class="p">);</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">month</span><span class="p">,</span> <span class="nx">day</span><span class="p">);</span>
</span><span class='line'>          <span class="p">},</span>
</span><span class='line'>          <span class="nx">newDate</span> <span class="o">=</span> <span class="p">(</span><span class="nx">date</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">date</span> <span class="o">===</span> <span class="s2">&quot;&quot;</span> <span class="o">?</span> <span class="nx">defaultDate</span> <span class="o">:</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">date</span> <span class="o">===</span> <span class="s2">&quot;string&quot;</span> <span class="o">?</span> <span class="nx">offsetString</span><span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>              <span class="p">(</span><span class="k">typeof</span> <span class="nx">date</span> <span class="o">===</span> <span class="s2">&quot;number&quot;</span> <span class="o">?</span> <span class="p">(</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="o">?</span> <span class="nx">defaultDate</span> <span class="o">:</span> <span class="nx">offsetNumeric</span><span class="p">(</span><span class="nx">date</span><span class="p">))</span> <span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()))));</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">newDate</span> <span class="o">=</span> <span class="p">(</span><span class="nx">newDate</span> <span class="o">&amp;&amp;</span> <span class="nx">newDate</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span> <span class="o">===</span> <span class="s2">&quot;Invalid Date&quot;</span> <span class="o">?</span> <span class="nx">defaultDate</span> <span class="o">:</span> <span class="nx">newDate</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">newDate</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">newDate</span><span class="p">.</span><span class="nx">setHours</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">newDate</span><span class="p">.</span><span class="nx">setMinutes</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">newDate</span><span class="p">.</span><span class="nx">setSeconds</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">newDate</span><span class="p">.</span><span class="nx">setMilliseconds</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_daylightSavingAdjust</span><span class="p">(</span><span class="nx">newDate</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Handle switch to/from daylight saving.</span>
</span><span class='line'><span class="cm">  * Hours may be non-zero on daylight saving cut-over:</span>
</span><span class='line'><span class="cm">  * &gt; 12 when midnight changeover, but then cannot generate</span>
</span><span class='line'><span class="cm">  * midnight datetime, so jump to 1AM, otherwise reset.</span>
</span><span class='line'><span class="cm">  * @param  date  (Date) the date to check</span>
</span><span class='line'><span class="cm">  * @return  (Date) the corrected date</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="nx">_daylightSavingAdjust</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nx">date</span><span class="p">.</span><span class="nx">setHours</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getHours</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">12</span> <span class="o">?</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getHours</span><span class="p">()</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">date</span><span class="p">;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Set the date(s) directly. */</span>
</span><span class='line'>  <span class="nx">_setDate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">date</span><span class="p">,</span> <span class="nx">noChange</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">clear</span> <span class="o">=</span> <span class="o">!</span><span class="nx">date</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">origMonth</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedMonth</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">origYear</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedYear</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">newDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_restrictMinMax</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_determineDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">date</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()));</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedDay</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">currentDay</span> <span class="o">=</span> <span class="nx">newDate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">();</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">drawMonth</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedMonth</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">currentMonth</span> <span class="o">=</span> <span class="nx">newDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">();</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">drawYear</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedYear</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">currentYear</span> <span class="o">=</span> <span class="nx">newDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">();</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">((</span><span class="nx">origMonth</span> <span class="o">!==</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedMonth</span> <span class="o">||</span> <span class="nx">origYear</span> <span class="o">!==</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedYear</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">noChange</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_notifyChange</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_adjustInstDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">(</span><span class="nx">clear</span> <span class="o">?</span> <span class="s2">&quot;&quot;</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">_formatDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">));</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Retrieve the date(s) directly. */</span>
</span><span class='line'>  <span class="nx">_getDate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">startDate</span> <span class="o">=</span> <span class="p">(</span><span class="o">!</span><span class="nx">inst</span><span class="p">.</span><span class="nx">currentYear</span> <span class="o">||</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">input</span> <span class="o">&amp;&amp;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">()</span> <span class="o">===</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_daylightSavingAdjust</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">currentYear</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">currentMonth</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">currentDay</span><span class="p">)));</span>
</span><span class='line'>          <span class="k">return</span> <span class="nx">startDate</span><span class="p">;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Attach the onxxx handlers.  These are declared statically so</span>
</span><span class='line'><span class="cm">  * they work with static code transformers like Caja.</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="nx">_attachHandlers</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">stepMonths</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;stepMonths&quot;</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">id</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span> <span class="sr">/\\\\/g</span><span class="p">,</span> <span class="s2">&quot;\\&quot;</span> <span class="p">);</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;[data-handler]&quot;</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">handler</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">prev</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nb">window</span><span class="p">[</span><span class="s2">&quot;DP_jQuery_&quot;</span> <span class="o">+</span> <span class="nx">dpuuid</span><span class="p">].</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_adjustDate</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="o">-</span><span class="nx">stepMonths</span><span class="p">,</span> <span class="s2">&quot;M&quot;</span><span class="p">);</span>
</span><span class='line'>              <span class="p">},</span>
</span><span class='line'>              <span class="nx">next</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nb">window</span><span class="p">[</span><span class="s2">&quot;DP_jQuery_&quot;</span> <span class="o">+</span> <span class="nx">dpuuid</span><span class="p">].</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_adjustDate</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="o">+</span><span class="nx">stepMonths</span><span class="p">,</span> <span class="s2">&quot;M&quot;</span><span class="p">);</span>
</span><span class='line'>              <span class="p">},</span>
</span><span class='line'>              <span class="nx">hide</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nb">window</span><span class="p">[</span><span class="s2">&quot;DP_jQuery_&quot;</span> <span class="o">+</span> <span class="nx">dpuuid</span><span class="p">].</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_hideDatepicker</span><span class="p">();</span>
</span><span class='line'>              <span class="p">},</span>
</span><span class='line'>              <span class="nx">today</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nb">window</span><span class="p">[</span><span class="s2">&quot;DP_jQuery_&quot;</span> <span class="o">+</span> <span class="nx">dpuuid</span><span class="p">].</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_gotoToday</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
</span><span class='line'>              <span class="p">},</span>
</span><span class='line'>              <span class="nx">selectDay</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nb">window</span><span class="p">[</span><span class="s2">&quot;DP_jQuery_&quot;</span> <span class="o">+</span> <span class="nx">dpuuid</span><span class="p">].</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_selectDay</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;data-month&quot;</span><span class="p">),</span> <span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;data-year&quot;</span><span class="p">),</span> <span class="k">this</span><span class="p">);</span>
</span><span class='line'>                  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>              <span class="p">},</span>
</span><span class='line'>              <span class="nx">selectMonth</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nb">window</span><span class="p">[</span><span class="s2">&quot;DP_jQuery_&quot;</span> <span class="o">+</span> <span class="nx">dpuuid</span><span class="p">].</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_selectMonthYear</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="s2">&quot;M&quot;</span><span class="p">);</span>
</span><span class='line'>                  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>              <span class="p">},</span>
</span><span class='line'>              <span class="nx">selectYear</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nb">window</span><span class="p">[</span><span class="s2">&quot;DP_jQuery_&quot;</span> <span class="o">+</span> <span class="nx">dpuuid</span><span class="p">].</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_selectMonthYear</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">);</span>
</span><span class='line'>                  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>          <span class="p">};</span>
</span><span class='line'>          <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;data-event&quot;</span><span class="p">),</span> <span class="nx">handler</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;data-handler&quot;</span><span class="p">)]);</span>
</span><span class='line'>      <span class="p">});</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Generate the HTML for the current state of the date picker. */</span>
</span><span class='line'>  <span class="nx">_generateHTML</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">maxDraw</span><span class="p">,</span> <span class="nx">prevText</span><span class="p">,</span> <span class="nx">prev</span><span class="p">,</span> <span class="nx">nextText</span><span class="p">,</span> <span class="nx">next</span><span class="p">,</span> <span class="nx">currentText</span><span class="p">,</span> <span class="nx">gotoDate</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">controls</span><span class="p">,</span> <span class="nx">buttonPanel</span><span class="p">,</span> <span class="nx">firstDay</span><span class="p">,</span> <span class="nx">showWeek</span><span class="p">,</span> <span class="nx">dayNames</span><span class="p">,</span> <span class="nx">dayNamesMin</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">monthNames</span><span class="p">,</span> <span class="nx">monthNamesShort</span><span class="p">,</span> <span class="nx">beforeShowDay</span><span class="p">,</span> <span class="nx">showOtherMonths</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">selectOtherMonths</span><span class="p">,</span> <span class="nx">defaultDate</span><span class="p">,</span> <span class="nx">html</span><span class="p">,</span> <span class="nx">dow</span><span class="p">,</span> <span class="nx">row</span><span class="p">,</span> <span class="nx">group</span><span class="p">,</span> <span class="nx">col</span><span class="p">,</span> <span class="nx">selectedDate</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">cornerClass</span><span class="p">,</span> <span class="nx">calender</span><span class="p">,</span> <span class="nx">thead</span><span class="p">,</span> <span class="nx">day</span><span class="p">,</span> <span class="nx">daysInMonth</span><span class="p">,</span> <span class="nx">leadDays</span><span class="p">,</span> <span class="nx">curRows</span><span class="p">,</span> <span class="nx">numRows</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">printDate</span><span class="p">,</span> <span class="nx">dRow</span><span class="p">,</span> <span class="nx">tbody</span><span class="p">,</span> <span class="nx">daySettings</span><span class="p">,</span> <span class="nx">otherMonth</span><span class="p">,</span> <span class="nx">unselectable</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">tempDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span>
</span><span class='line'>          <span class="nx">today</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_daylightSavingAdjust</span><span class="p">(</span>
</span><span class='line'>              <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">tempDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="nx">tempDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">(),</span> <span class="nx">tempDate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">())),</span> <span class="c1">// clear time</span>
</span><span class='line'>          <span class="nx">isRTL</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;isRTL&quot;</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">showButtonPanel</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;showButtonPanel&quot;</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">hideIfNoPrevNext</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;hideIfNoPrevNext&quot;</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">navigationAsDateFormat</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;navigationAsDateFormat&quot;</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">numMonths</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getNumberOfMonths</span><span class="p">(</span><span class="nx">inst</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">showCurrentAtPos</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;showCurrentAtPos&quot;</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">stepMonths</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;stepMonths&quot;</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">isMultiMonth</span> <span class="o">=</span> <span class="p">(</span><span class="nx">numMonths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!==</span> <span class="mi">1</span> <span class="o">||</span> <span class="nx">numMonths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!==</span> <span class="mi">1</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">currentDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_daylightSavingAdjust</span><span class="p">((</span><span class="o">!</span><span class="nx">inst</span><span class="p">.</span><span class="nx">currentDay</span> <span class="o">?</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="mi">9999</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>              <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">currentYear</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">currentMonth</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">currentDay</span><span class="p">))),</span>
</span><span class='line'>          <span class="nx">minDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getMinMaxDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">maxDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getMinMaxDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">drawMonth</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">drawMonth</span> <span class="o">-</span> <span class="nx">showCurrentAtPos</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">drawYear</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">drawYear</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">drawMonth</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">drawMonth</span> <span class="o">+=</span> <span class="mi">12</span><span class="p">;</span>
</span><span class='line'>          <span class="nx">drawYear</span><span class="o">--</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">maxDate</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">maxDraw</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_daylightSavingAdjust</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">maxDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span>
</span><span class='line'>              <span class="nx">maxDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="nx">numMonths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nx">numMonths</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">maxDate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()));</span>
</span><span class='line'>          <span class="nx">maxDraw</span> <span class="o">=</span> <span class="p">(</span><span class="nx">minDate</span> <span class="o">&amp;&amp;</span> <span class="nx">maxDraw</span> <span class="o">&lt;</span> <span class="nx">minDate</span> <span class="o">?</span> <span class="nx">minDate</span> <span class="o">:</span> <span class="nx">maxDraw</span><span class="p">);</span>
</span><span class='line'>          <span class="k">while</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_daylightSavingAdjust</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">drawYear</span><span class="p">,</span> <span class="nx">drawMonth</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">&gt;</span> <span class="nx">maxDraw</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">drawMonth</span><span class="o">--</span><span class="p">;</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span><span class="nx">drawMonth</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">drawMonth</span> <span class="o">=</span> <span class="mi">11</span><span class="p">;</span>
</span><span class='line'>                  <span class="nx">drawYear</span><span class="o">--</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">drawMonth</span> <span class="o">=</span> <span class="nx">drawMonth</span><span class="p">;</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">drawYear</span> <span class="o">=</span> <span class="nx">drawYear</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">prevText</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;prevText&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">prevText</span> <span class="o">=</span> <span class="p">(</span><span class="o">!</span><span class="nx">navigationAsDateFormat</span> <span class="o">?</span> <span class="nx">prevText</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">formatDate</span><span class="p">(</span><span class="nx">prevText</span><span class="p">,</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_daylightSavingAdjust</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">drawYear</span><span class="p">,</span> <span class="nx">drawMonth</span> <span class="o">-</span> <span class="nx">stepMonths</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_getFormatConfig</span><span class="p">(</span><span class="nx">inst</span><span class="p">)));</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">prev</span> <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_canAdjustMonth</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nx">drawYear</span><span class="p">,</span> <span class="nx">drawMonth</span><span class="p">)</span> <span class="o">?</span>
</span><span class='line'>          <span class="s2">&quot;&lt;a class=&#39;ui-datepicker-prev ui-corner-all&#39; data-handler=&#39;prev&#39; data-event=&#39;click&#39;&quot;</span> <span class="o">+</span>
</span><span class='line'>          <span class="s2">&quot; title=&#39;&quot;</span> <span class="o">+</span> <span class="nx">prevText</span> <span class="o">+</span> <span class="s2">&quot;&#39;&gt;&lt;span class=&#39;ui-icon ui-icon-circle-triangle-&quot;</span> <span class="o">+</span> <span class="p">(</span> <span class="nx">isRTL</span> <span class="o">?</span> <span class="s2">&quot;e&quot;</span> <span class="o">:</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&gt;&quot;</span> <span class="o">+</span> <span class="nx">prevText</span> <span class="o">+</span> <span class="s2">&quot;&lt;/span&gt;&lt;/a&gt;&quot;</span> <span class="o">:</span>
</span><span class='line'>          <span class="p">(</span><span class="nx">hideIfNoPrevNext</span> <span class="o">?</span> <span class="s2">&quot;&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;a class=&#39;ui-datepicker-prev ui-corner-all ui-state-disabled&#39; title=&#39;&quot;</span><span class="o">+</span> <span class="nx">prevText</span> <span class="o">+</span><span class="s2">&quot;&#39;&gt;&lt;span class=&#39;ui-icon ui-icon-circle-triangle-&quot;</span> <span class="o">+</span> <span class="p">(</span> <span class="nx">isRTL</span> <span class="o">?</span> <span class="s2">&quot;e&quot;</span> <span class="o">:</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&gt;&quot;</span> <span class="o">+</span> <span class="nx">prevText</span> <span class="o">+</span> <span class="s2">&quot;&lt;/span&gt;&lt;/a&gt;&quot;</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">nextText</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;nextText&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">nextText</span> <span class="o">=</span> <span class="p">(</span><span class="o">!</span><span class="nx">navigationAsDateFormat</span> <span class="o">?</span> <span class="nx">nextText</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">formatDate</span><span class="p">(</span><span class="nx">nextText</span><span class="p">,</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_daylightSavingAdjust</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">drawYear</span><span class="p">,</span> <span class="nx">drawMonth</span> <span class="o">+</span> <span class="nx">stepMonths</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_getFormatConfig</span><span class="p">(</span><span class="nx">inst</span><span class="p">)));</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">next</span> <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_canAdjustMonth</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nx">drawYear</span><span class="p">,</span> <span class="nx">drawMonth</span><span class="p">)</span> <span class="o">?</span>
</span><span class='line'>          <span class="s2">&quot;&lt;a class=&#39;ui-datepicker-next ui-corner-all&#39; data-handler=&#39;next&#39; data-event=&#39;click&#39;&quot;</span> <span class="o">+</span>
</span><span class='line'>          <span class="s2">&quot; title=&#39;&quot;</span> <span class="o">+</span> <span class="nx">nextText</span> <span class="o">+</span> <span class="s2">&quot;&#39;&gt;&lt;span class=&#39;ui-icon ui-icon-circle-triangle-&quot;</span> <span class="o">+</span> <span class="p">(</span> <span class="nx">isRTL</span> <span class="o">?</span> <span class="s2">&quot;w&quot;</span> <span class="o">:</span> <span class="s2">&quot;e&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&gt;&quot;</span> <span class="o">+</span> <span class="nx">nextText</span> <span class="o">+</span> <span class="s2">&quot;&lt;/span&gt;&lt;/a&gt;&quot;</span> <span class="o">:</span>
</span><span class='line'>          <span class="p">(</span><span class="nx">hideIfNoPrevNext</span> <span class="o">?</span> <span class="s2">&quot;&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;a class=&#39;ui-datepicker-next ui-corner-all ui-state-disabled&#39; title=&#39;&quot;</span><span class="o">+</span> <span class="nx">nextText</span> <span class="o">+</span> <span class="s2">&quot;&#39;&gt;&lt;span class=&#39;ui-icon ui-icon-circle-triangle-&quot;</span> <span class="o">+</span> <span class="p">(</span> <span class="nx">isRTL</span> <span class="o">?</span> <span class="s2">&quot;w&quot;</span> <span class="o">:</span> <span class="s2">&quot;e&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&gt;&quot;</span> <span class="o">+</span> <span class="nx">nextText</span> <span class="o">+</span> <span class="s2">&quot;&lt;/span&gt;&lt;/a&gt;&quot;</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">currentText</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;currentText&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">gotoDate</span> <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;gotoCurrent&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">currentDay</span> <span class="o">?</span> <span class="nx">currentDate</span> <span class="o">:</span> <span class="nx">today</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">currentText</span> <span class="o">=</span> <span class="p">(</span><span class="o">!</span><span class="nx">navigationAsDateFormat</span> <span class="o">?</span> <span class="nx">currentText</span> <span class="o">:</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">formatDate</span><span class="p">(</span><span class="nx">currentText</span><span class="p">,</span> <span class="nx">gotoDate</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getFormatConfig</span><span class="p">(</span><span class="nx">inst</span><span class="p">)));</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">controls</span> <span class="o">=</span> <span class="p">(</span><span class="o">!</span><span class="nx">inst</span><span class="p">.</span><span class="nx">inline</span> <span class="o">?</span> <span class="s2">&quot;&lt;button type=&#39;button&#39; class=&#39;ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all&#39; data-handler=&#39;hide&#39; data-event=&#39;click&#39;&gt;&quot;</span> <span class="o">+</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;closeText&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&lt;/button&gt;&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">buttonPanel</span> <span class="o">=</span> <span class="p">(</span><span class="nx">showButtonPanel</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;&lt;div class=&#39;ui-datepicker-buttonpane ui-widget-content&#39;&gt;&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">isRTL</span> <span class="o">?</span> <span class="nx">controls</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span>
</span><span class='line'>          <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_isInRange</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">gotoDate</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;&lt;button type=&#39;button&#39; class=&#39;ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all&#39; data-handler=&#39;today&#39; data-event=&#39;click&#39;&quot;</span> <span class="o">+</span>
</span><span class='line'>          <span class="s2">&quot;&gt;&quot;</span> <span class="o">+</span> <span class="nx">currentText</span> <span class="o">+</span> <span class="s2">&quot;&lt;/button&gt;&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">isRTL</span> <span class="o">?</span> <span class="s2">&quot;&quot;</span> <span class="o">:</span> <span class="nx">controls</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&lt;/div&gt;&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">firstDay</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;firstDay&quot;</span><span class="p">),</span><span class="mi">10</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">firstDay</span> <span class="o">=</span> <span class="p">(</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">firstDay</span><span class="p">)</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="nx">firstDay</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">showWeek</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;showWeek&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">dayNames</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;dayNames&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">dayNamesMin</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;dayNamesMin&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">monthNames</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;monthNames&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">monthNamesShort</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;monthNamesShort&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">beforeShowDay</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;beforeShowDay&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">showOtherMonths</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;showOtherMonths&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">selectOtherMonths</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;selectOtherMonths&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">defaultDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getDefaultDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">html</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="nx">dow</span><span class="p">;</span>
</span><span class='line'>      <span class="k">for</span> <span class="p">(</span><span class="nx">row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">row</span> <span class="o">&lt;</span> <span class="nx">numMonths</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="nx">row</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">group</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">maxRows</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
</span><span class='line'>          <span class="k">for</span> <span class="p">(</span><span class="nx">col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">col</span> <span class="o">&lt;</span> <span class="nx">numMonths</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="nx">col</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">selectedDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_daylightSavingAdjust</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">drawYear</span><span class="p">,</span> <span class="nx">drawMonth</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedDay</span><span class="p">));</span>
</span><span class='line'>              <span class="nx">cornerClass</span> <span class="o">=</span> <span class="s2">&quot; ui-corner-all&quot;</span><span class="p">;</span>
</span><span class='line'>              <span class="nx">calender</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span><span class="nx">isMultiMonth</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">calender</span> <span class="o">+=</span> <span class="s2">&quot;&lt;div class=&#39;ui-datepicker-group&quot;</span><span class="p">;</span>
</span><span class='line'>                  <span class="k">if</span> <span class="p">(</span><span class="nx">numMonths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                      <span class="k">switch</span> <span class="p">(</span><span class="nx">col</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                          <span class="k">case</span> <span class="mi">0</span><span class="o">:</span> <span class="nx">calender</span> <span class="o">+=</span> <span class="s2">&quot; ui-datepicker-group-first&quot;</span><span class="p">;</span>
</span><span class='line'>                              <span class="nx">cornerClass</span> <span class="o">=</span> <span class="s2">&quot; ui-corner-&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">isRTL</span> <span class="o">?</span> <span class="s2">&quot;right&quot;</span> <span class="o">:</span> <span class="s2">&quot;left&quot;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                          <span class="k">case</span> <span class="nx">numMonths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="o">:</span> <span class="nx">calender</span> <span class="o">+=</span> <span class="s2">&quot; ui-datepicker-group-last&quot;</span><span class="p">;</span>
</span><span class='line'>                              <span class="nx">cornerClass</span> <span class="o">=</span> <span class="s2">&quot; ui-corner-&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">isRTL</span> <span class="o">?</span> <span class="s2">&quot;left&quot;</span> <span class="o">:</span> <span class="s2">&quot;right&quot;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                          <span class="k">default</span><span class="o">:</span> <span class="nx">calender</span> <span class="o">+=</span> <span class="s2">&quot; ui-datepicker-group-middle&quot;</span><span class="p">;</span> <span class="nx">cornerClass</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                      <span class="p">}</span>
</span><span class='line'>                  <span class="p">}</span>
</span><span class='line'>                  <span class="nx">calender</span> <span class="o">+=</span> <span class="s2">&quot;&#39;&gt;&quot;</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="nx">calender</span> <span class="o">+=</span> <span class="s2">&quot;&lt;div class=&#39;ui-datepicker-header ui-widget-header ui-helper-clearfix&quot;</span> <span class="o">+</span> <span class="nx">cornerClass</span> <span class="o">+</span> <span class="s2">&quot;&#39;&gt;&quot;</span> <span class="o">+</span>
</span><span class='line'>                  <span class="p">(</span><span class="sr">/all|left/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">cornerClass</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">row</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">?</span> <span class="p">(</span><span class="nx">isRTL</span> <span class="o">?</span> <span class="nx">next</span> <span class="o">:</span> <span class="nx">prev</span><span class="p">)</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span>
</span><span class='line'>                  <span class="p">(</span><span class="sr">/all|right/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">cornerClass</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">row</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">?</span> <span class="p">(</span><span class="nx">isRTL</span> <span class="o">?</span> <span class="nx">prev</span> <span class="o">:</span> <span class="nx">next</span><span class="p">)</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span>
</span><span class='line'>                  <span class="k">this</span><span class="p">.</span><span class="nx">_generateMonthYearHeader</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">drawMonth</span><span class="p">,</span> <span class="nx">drawYear</span><span class="p">,</span> <span class="nx">minDate</span><span class="p">,</span> <span class="nx">maxDate</span><span class="p">,</span>
</span><span class='line'>                  <span class="nx">row</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">col</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">monthNames</span><span class="p">,</span> <span class="nx">monthNamesShort</span><span class="p">)</span> <span class="o">+</span> <span class="c1">// draw month headers</span>
</span><span class='line'>                  <span class="s2">&quot;&lt;/div&gt;&lt;table class=&#39;ui-datepicker-calendar&#39;&gt;&lt;thead&gt;&quot;</span> <span class="o">+</span>
</span><span class='line'>                  <span class="s2">&quot;&lt;tr&gt;&quot;</span><span class="p">;</span>
</span><span class='line'>              <span class="nx">thead</span> <span class="o">=</span> <span class="p">(</span><span class="nx">showWeek</span> <span class="o">?</span> <span class="s2">&quot;&lt;th class=&#39;ui-datepicker-week-col&#39;&gt;&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;weekHeader&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&lt;/th&gt;&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
</span><span class='line'>              <span class="k">for</span> <span class="p">(</span><span class="nx">dow</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">dow</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">;</span> <span class="nx">dow</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// days of the week</span>
</span><span class='line'>                  <span class="nx">day</span> <span class="o">=</span> <span class="p">(</span><span class="nx">dow</span> <span class="o">+</span> <span class="nx">firstDay</span><span class="p">)</span> <span class="o">%</span> <span class="mi">7</span><span class="p">;</span>
</span><span class='line'>                  <span class="nx">thead</span> <span class="o">+=</span> <span class="s2">&quot;&lt;th&quot;</span> <span class="o">+</span> <span class="p">((</span><span class="nx">dow</span> <span class="o">+</span> <span class="nx">firstDay</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span> <span class="o">%</span> <span class="mi">7</span> <span class="o">&gt;=</span> <span class="mi">5</span> <span class="o">?</span> <span class="s2">&quot; class=&#39;ui-datepicker-week-end&#39;&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&gt;&quot;</span> <span class="o">+</span>
</span><span class='line'>                      <span class="s2">&quot;&lt;span title=&#39;&quot;</span> <span class="o">+</span> <span class="nx">dayNames</span><span class="p">[</span><span class="nx">day</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&#39;&gt;&quot;</span> <span class="o">+</span> <span class="nx">dayNamesMin</span><span class="p">[</span><span class="nx">day</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&lt;/span&gt;&lt;/th&gt;&quot;</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="nx">calender</span> <span class="o">+=</span> <span class="nx">thead</span> <span class="o">+</span> <span class="s2">&quot;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&quot;</span><span class="p">;</span>
</span><span class='line'>              <span class="nx">daysInMonth</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getDaysInMonth</span><span class="p">(</span><span class="nx">drawYear</span><span class="p">,</span> <span class="nx">drawMonth</span><span class="p">);</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span><span class="nx">drawYear</span> <span class="o">===</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedYear</span> <span class="o">&amp;&amp;</span> <span class="nx">drawMonth</span> <span class="o">===</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedMonth</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedDay</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">selectedDay</span><span class="p">,</span> <span class="nx">daysInMonth</span><span class="p">);</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="nx">leadDays</span> <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_getFirstDayOfMonth</span><span class="p">(</span><span class="nx">drawYear</span><span class="p">,</span> <span class="nx">drawMonth</span><span class="p">)</span> <span class="o">-</span> <span class="nx">firstDay</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span> <span class="o">%</span> <span class="mi">7</span><span class="p">;</span>
</span><span class='line'>              <span class="nx">curRows</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">((</span><span class="nx">leadDays</span> <span class="o">+</span> <span class="nx">daysInMonth</span><span class="p">)</span> <span class="o">/</span> <span class="mi">7</span><span class="p">);</span> <span class="c1">// calculate the number of rows to generate</span>
</span><span class='line'>              <span class="nx">numRows</span> <span class="o">=</span> <span class="p">(</span><span class="nx">isMultiMonth</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">maxRows</span> <span class="o">&gt;</span> <span class="nx">curRows</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">maxRows</span> <span class="o">:</span> <span class="nx">curRows</span> <span class="o">:</span> <span class="nx">curRows</span><span class="p">);</span> <span class="c1">//If multiple months, use the higher number of rows (see #7043)</span>
</span><span class='line'>              <span class="k">this</span><span class="p">.</span><span class="nx">maxRows</span> <span class="o">=</span> <span class="nx">numRows</span><span class="p">;</span>
</span><span class='line'>              <span class="nx">printDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_daylightSavingAdjust</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">drawYear</span><span class="p">,</span> <span class="nx">drawMonth</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="nx">leadDays</span><span class="p">));</span>
</span><span class='line'>              <span class="k">for</span> <span class="p">(</span><span class="nx">dRow</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">dRow</span> <span class="o">&lt;</span> <span class="nx">numRows</span><span class="p">;</span> <span class="nx">dRow</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// create date picker rows</span>
</span><span class='line'>                  <span class="nx">calender</span> <span class="o">+=</span> <span class="s2">&quot;&lt;tr&gt;&quot;</span><span class="p">;</span>
</span><span class='line'>                  <span class="nx">tbody</span> <span class="o">=</span> <span class="p">(</span><span class="o">!</span><span class="nx">showWeek</span> <span class="o">?</span> <span class="s2">&quot;&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;td class=&#39;ui-datepicker-week-col&#39;&gt;&quot;</span> <span class="o">+</span>
</span><span class='line'>                      <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;calculateWeek&quot;</span><span class="p">)(</span><span class="nx">printDate</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&lt;/td&gt;&quot;</span><span class="p">);</span>
</span><span class='line'>                  <span class="k">for</span> <span class="p">(</span><span class="nx">dow</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">dow</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">;</span> <span class="nx">dow</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// create date picker days</span>
</span><span class='line'>                      <span class="nx">daySettings</span> <span class="o">=</span> <span class="p">(</span><span class="nx">beforeShowDay</span> <span class="o">?</span>
</span><span class='line'>                          <span class="nx">beforeShowDay</span><span class="p">.</span><span class="nx">apply</span><span class="p">((</span><span class="nx">inst</span><span class="p">.</span><span class="nx">input</span> <span class="o">?</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">:</span> <span class="kc">null</span><span class="p">),</span> <span class="p">[</span><span class="nx">printDate</span><span class="p">])</span> <span class="o">:</span> <span class="p">[</span><span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]);</span>
</span><span class='line'>                      <span class="nx">otherMonth</span> <span class="o">=</span> <span class="p">(</span><span class="nx">printDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">!==</span> <span class="nx">drawMonth</span><span class="p">);</span>
</span><span class='line'>                      <span class="nx">unselectable</span> <span class="o">=</span> <span class="p">(</span><span class="nx">otherMonth</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">selectOtherMonths</span><span class="p">)</span> <span class="o">||</span> <span class="o">!</span><span class="nx">daySettings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span>
</span><span class='line'>                          <span class="p">(</span><span class="nx">minDate</span> <span class="o">&amp;&amp;</span> <span class="nx">printDate</span> <span class="o">&lt;</span> <span class="nx">minDate</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nx">maxDate</span> <span class="o">&amp;&amp;</span> <span class="nx">printDate</span> <span class="o">&gt;</span> <span class="nx">maxDate</span><span class="p">);</span>
</span><span class='line'>                      <span class="nx">tbody</span> <span class="o">+=</span> <span class="s2">&quot;&lt;td class=&#39;&quot;</span> <span class="o">+</span>
</span><span class='line'>                          <span class="p">((</span><span class="nx">dow</span> <span class="o">+</span> <span class="nx">firstDay</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span> <span class="o">%</span> <span class="mi">7</span> <span class="o">&gt;=</span> <span class="mi">5</span> <span class="o">?</span> <span class="s2">&quot; ui-datepicker-week-end&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="c1">// highlight weekends</span>
</span><span class='line'>                          <span class="p">(</span><span class="nx">otherMonth</span> <span class="o">?</span> <span class="s2">&quot; ui-datepicker-other-month&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="c1">// highlight days from other months</span>
</span><span class='line'>                          <span class="p">((</span><span class="nx">printDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">===</span> <span class="nx">selectedDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">drawMonth</span> <span class="o">===</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedMonth</span> <span class="o">&amp;&amp;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">_keyEvent</span><span class="p">)</span> <span class="o">||</span> <span class="c1">// user pressed key</span>
</span><span class='line'>                          <span class="p">(</span><span class="nx">defaultDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">===</span> <span class="nx">printDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">defaultDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">===</span> <span class="nx">selectedDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">())</span> <span class="o">?</span>
</span><span class='line'>                          <span class="c1">// or defaultDate is current printedDate and defaultDate is selectedDate</span>
</span><span class='line'>                          <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">_dayOverClass</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="c1">// highlight selected day</span>
</span><span class='line'>                          <span class="p">(</span><span class="nx">unselectable</span> <span class="o">?</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">_unselectableClass</span> <span class="o">+</span> <span class="s2">&quot; ui-state-disabled&quot;</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span>  <span class="c1">// highlight unselectable days</span>
</span><span class='line'>                          <span class="p">(</span><span class="nx">otherMonth</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">showOtherMonths</span> <span class="o">?</span> <span class="s2">&quot;&quot;</span> <span class="o">:</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">daySettings</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="c1">// highlight custom dates</span>
</span><span class='line'>                          <span class="p">(</span><span class="nx">printDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">===</span> <span class="nx">currentDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">?</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">_currentClass</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="c1">// highlight selected day</span>
</span><span class='line'>                          <span class="p">(</span><span class="nx">printDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">===</span> <span class="nx">today</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">?</span> <span class="s2">&quot; ui-datepicker-today&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="c1">// highlight today (if different)</span>
</span><span class='line'>                          <span class="p">((</span><span class="o">!</span><span class="nx">otherMonth</span> <span class="o">||</span> <span class="nx">showOtherMonths</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">daySettings</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">?</span> <span class="s2">&quot; title=&#39;&quot;</span> <span class="o">+</span> <span class="nx">daySettings</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&#39;/g</span><span class="p">,</span> <span class="s2">&quot;&amp;#39;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="c1">// cell title</span>
</span><span class='line'>                          <span class="p">(</span><span class="nx">unselectable</span> <span class="o">?</span> <span class="s2">&quot;&quot;</span> <span class="o">:</span> <span class="s2">&quot; data-handler=&#39;selectDay&#39; data-event=&#39;click&#39; data-month=&#39;&quot;</span> <span class="o">+</span> <span class="nx">printDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; data-year=&#39;&quot;</span> <span class="o">+</span> <span class="nx">printDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&gt;&quot;</span> <span class="o">+</span> <span class="c1">// actions</span>
</span><span class='line'>                          <span class="p">(</span><span class="nx">otherMonth</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">showOtherMonths</span> <span class="o">?</span> <span class="s2">&quot;&amp;#xa0;&quot;</span> <span class="o">:</span> <span class="c1">// display for other months</span>
</span><span class='line'>                          <span class="p">(</span><span class="nx">unselectable</span> <span class="o">?</span> <span class="s2">&quot;&lt;span class=&#39;ui-state-default&#39;&gt;&quot;</span> <span class="o">+</span> <span class="nx">printDate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&lt;/span&gt;&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;a class=&#39;ui-state-default&quot;</span> <span class="o">+</span>
</span><span class='line'>                          <span class="p">(</span><span class="nx">printDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">===</span> <span class="nx">today</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">?</span> <span class="s2">&quot; ui-state-highlight&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span>
</span><span class='line'>                          <span class="p">(</span><span class="nx">printDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">===</span> <span class="nx">currentDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">?</span> <span class="s2">&quot; ui-state-active&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="c1">// highlight selected day</span>
</span><span class='line'>                          <span class="p">(</span><span class="nx">otherMonth</span> <span class="o">?</span> <span class="s2">&quot; ui-priority-secondary&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="c1">// distinguish dates from other months</span>
</span><span class='line'>                          <span class="s2">&quot;&#39; href=&#39;#&#39;&gt;&quot;</span> <span class="o">+</span> <span class="nx">printDate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&lt;/a&gt;&quot;</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;&lt;/td&gt;&quot;</span><span class="p">;</span> <span class="c1">// display selectable date</span>
</span><span class='line'>                      <span class="nx">printDate</span><span class="p">.</span><span class="nx">setDate</span><span class="p">(</span><span class="nx">printDate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>                      <span class="nx">printDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_daylightSavingAdjust</span><span class="p">(</span><span class="nx">printDate</span><span class="p">);</span>
</span><span class='line'>                  <span class="p">}</span>
</span><span class='line'>                  <span class="nx">calender</span> <span class="o">+=</span> <span class="nx">tbody</span> <span class="o">+</span> <span class="s2">&quot;&lt;/tr&gt;&quot;</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="nx">drawMonth</span><span class="o">++</span><span class="p">;</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span><span class="nx">drawMonth</span> <span class="o">&gt;</span> <span class="mi">11</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">drawMonth</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>                  <span class="nx">drawYear</span><span class="o">++</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="nx">calender</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/tbody&gt;&lt;/table&gt;&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">isMultiMonth</span> <span class="o">?</span> <span class="s2">&quot;&lt;/div&gt;&quot;</span> <span class="o">+</span>
</span><span class='line'>                          <span class="p">((</span><span class="nx">numMonths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">col</span> <span class="o">===</span> <span class="nx">numMonths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;&lt;div class=&#39;ui-datepicker-row-break&#39;&gt;&lt;/div&gt;&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
</span><span class='line'>              <span class="nx">group</span> <span class="o">+=</span> <span class="nx">calender</span><span class="p">;</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="nx">html</span> <span class="o">+=</span> <span class="nx">group</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nx">html</span> <span class="o">+=</span> <span class="nx">buttonPanel</span><span class="p">;</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">_keyEvent</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">html</span><span class="p">;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Generate the month and year header. */</span>
</span><span class='line'>  <span class="nx">_generateMonthYearHeader</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">drawMonth</span><span class="p">,</span> <span class="nx">drawYear</span><span class="p">,</span> <span class="nx">minDate</span><span class="p">,</span> <span class="nx">maxDate</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">secondary</span><span class="p">,</span> <span class="nx">monthNames</span><span class="p">,</span> <span class="nx">monthNamesShort</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">inMinYear</span><span class="p">,</span> <span class="nx">inMaxYear</span><span class="p">,</span> <span class="nx">month</span><span class="p">,</span> <span class="nx">years</span><span class="p">,</span> <span class="nx">thisYear</span><span class="p">,</span> <span class="nx">determineYear</span><span class="p">,</span> <span class="nx">year</span><span class="p">,</span> <span class="nx">endYear</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">changeMonth</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;changeMonth&quot;</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">changeYear</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;changeYear&quot;</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">showMonthAfterYear</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;showMonthAfterYear&quot;</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">html</span> <span class="o">=</span> <span class="s2">&quot;&lt;div class=&#39;ui-datepicker-title&#39;&gt;&quot;</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">monthHtml</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// month selection</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">secondary</span> <span class="o">||</span> <span class="o">!</span><span class="nx">changeMonth</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">monthHtml</span> <span class="o">+=</span> <span class="s2">&quot;&lt;span class=&#39;ui-datepicker-month&#39;&gt;&quot;</span> <span class="o">+</span> <span class="nx">monthNames</span><span class="p">[</span><span class="nx">drawMonth</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&lt;/span&gt;&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">inMinYear</span> <span class="o">=</span> <span class="p">(</span><span class="nx">minDate</span> <span class="o">&amp;&amp;</span> <span class="nx">minDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">===</span> <span class="nx">drawYear</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">inMaxYear</span> <span class="o">=</span> <span class="p">(</span><span class="nx">maxDate</span> <span class="o">&amp;&amp;</span> <span class="nx">maxDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">===</span> <span class="nx">drawYear</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">monthHtml</span> <span class="o">+=</span> <span class="s2">&quot;&lt;select class=&#39;ui-datepicker-month&#39; data-handler=&#39;selectMonth&#39; data-event=&#39;change&#39;&gt;&quot;</span><span class="p">;</span>
</span><span class='line'>          <span class="k">for</span> <span class="p">(</span> <span class="nx">month</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">month</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="p">;</span> <span class="nx">month</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nx">inMinYear</span> <span class="o">||</span> <span class="nx">month</span> <span class="o">&gt;=</span> <span class="nx">minDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">())</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="nx">inMaxYear</span> <span class="o">||</span> <span class="nx">month</span> <span class="o">&lt;=</span> <span class="nx">maxDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()))</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">monthHtml</span> <span class="o">+=</span> <span class="s2">&quot;&lt;option value=&#39;&quot;</span> <span class="o">+</span> <span class="nx">month</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span>
</span><span class='line'>                      <span class="p">(</span><span class="nx">month</span> <span class="o">===</span> <span class="nx">drawMonth</span> <span class="o">?</span> <span class="s2">&quot; selected=&#39;selected&#39;&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span>
</span><span class='line'>                      <span class="s2">&quot;&gt;&quot;</span> <span class="o">+</span> <span class="nx">monthNamesShort</span><span class="p">[</span><span class="nx">month</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&lt;/option&gt;&quot;</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="nx">monthHtml</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/select&gt;&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">showMonthAfterYear</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">html</span> <span class="o">+=</span> <span class="nx">monthHtml</span> <span class="o">+</span> <span class="p">(</span><span class="nx">secondary</span> <span class="o">||</span> <span class="o">!</span><span class="p">(</span><span class="nx">changeMonth</span> <span class="o">&amp;&amp;</span> <span class="nx">changeYear</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;&amp;#xa0;&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// year selection</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">inst</span><span class="p">.</span><span class="nx">yearshtml</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">yearshtml</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="nx">secondary</span> <span class="o">||</span> <span class="o">!</span><span class="nx">changeYear</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">html</span> <span class="o">+=</span> <span class="s2">&quot;&lt;span class=&#39;ui-datepicker-year&#39;&gt;&quot;</span> <span class="o">+</span> <span class="nx">drawYear</span> <span class="o">+</span> <span class="s2">&quot;&lt;/span&gt;&quot;</span><span class="p">;</span>
</span><span class='line'>          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>              <span class="c1">// determine range of years to display</span>
</span><span class='line'>              <span class="nx">years</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;yearRange&quot;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">);</span>
</span><span class='line'>              <span class="nx">thisYear</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getFullYear</span><span class="p">();</span>
</span><span class='line'>              <span class="nx">determineYear</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="kd">var</span> <span class="nx">year</span> <span class="o">=</span> <span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/c[+\-].*/</span><span class="p">)</span> <span class="o">?</span> <span class="nx">drawYear</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>                      <span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/[+\-].*/</span><span class="p">)</span> <span class="o">?</span> <span class="nx">thisYear</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>                      <span class="nb">parseInt</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="mi">10</span><span class="p">)));</span>
</span><span class='line'>                  <span class="k">return</span> <span class="p">(</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">year</span><span class="p">)</span> <span class="o">?</span> <span class="nx">thisYear</span> <span class="o">:</span> <span class="nx">year</span><span class="p">);</span>
</span><span class='line'>              <span class="p">};</span>
</span><span class='line'>              <span class="nx">year</span> <span class="o">=</span> <span class="nx">determineYear</span><span class="p">(</span><span class="nx">years</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span><span class='line'>              <span class="nx">endYear</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">determineYear</span><span class="p">(</span><span class="nx">years</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">||</span> <span class="s2">&quot;&quot;</span><span class="p">));</span>
</span><span class='line'>              <span class="nx">year</span> <span class="o">=</span> <span class="p">(</span><span class="nx">minDate</span> <span class="o">?</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">minDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">())</span> <span class="o">:</span> <span class="nx">year</span><span class="p">);</span>
</span><span class='line'>              <span class="nx">endYear</span> <span class="o">=</span> <span class="p">(</span><span class="nx">maxDate</span> <span class="o">?</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">endYear</span><span class="p">,</span> <span class="nx">maxDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">())</span> <span class="o">:</span> <span class="nx">endYear</span><span class="p">);</span>
</span><span class='line'>              <span class="nx">inst</span><span class="p">.</span><span class="nx">yearshtml</span> <span class="o">+=</span> <span class="s2">&quot;&lt;select class=&#39;ui-datepicker-year&#39; data-handler=&#39;selectYear&#39; data-event=&#39;change&#39;&gt;&quot;</span><span class="p">;</span>
</span><span class='line'>              <span class="k">for</span> <span class="p">(;</span> <span class="nx">year</span> <span class="o">&lt;=</span> <span class="nx">endYear</span><span class="p">;</span> <span class="nx">year</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">inst</span><span class="p">.</span><span class="nx">yearshtml</span> <span class="o">+=</span> <span class="s2">&quot;&lt;option value=&#39;&quot;</span> <span class="o">+</span> <span class="nx">year</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span>
</span><span class='line'>                      <span class="p">(</span><span class="nx">year</span> <span class="o">===</span> <span class="nx">drawYear</span> <span class="o">?</span> <span class="s2">&quot; selected=&#39;selected&#39;&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span>
</span><span class='line'>                      <span class="s2">&quot;&gt;&quot;</span> <span class="o">+</span> <span class="nx">year</span> <span class="o">+</span> <span class="s2">&quot;&lt;/option&gt;&quot;</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="nx">inst</span><span class="p">.</span><span class="nx">yearshtml</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/select&gt;&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>              <span class="nx">html</span> <span class="o">+=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">yearshtml</span><span class="p">;</span>
</span><span class='line'>              <span class="nx">inst</span><span class="p">.</span><span class="nx">yearshtml</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">html</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;yearSuffix&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">showMonthAfterYear</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">html</span> <span class="o">+=</span> <span class="p">(</span><span class="nx">secondary</span> <span class="o">||</span> <span class="o">!</span><span class="p">(</span><span class="nx">changeMonth</span> <span class="o">&amp;&amp;</span> <span class="nx">changeYear</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;&amp;#xa0;&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">monthHtml</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nx">html</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/div&gt;&quot;</span><span class="p">;</span> <span class="c1">// Close datepicker_header</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">html</span><span class="p">;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Adjust one of the date sub-fields. */</span>
</span><span class='line'>  <span class="nx">_adjustInstDate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">offset</span><span class="p">,</span> <span class="nx">period</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">year</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">drawYear</span> <span class="o">+</span> <span class="p">(</span><span class="nx">period</span> <span class="o">===</span> <span class="s2">&quot;Y&quot;</span> <span class="o">?</span> <span class="nx">offset</span> <span class="o">:</span> <span class="mi">0</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">month</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">drawMonth</span> <span class="o">+</span> <span class="p">(</span><span class="nx">period</span> <span class="o">===</span> <span class="s2">&quot;M&quot;</span> <span class="o">?</span> <span class="nx">offset</span> <span class="o">:</span> <span class="mi">0</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">day</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">selectedDay</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getDaysInMonth</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">month</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="nx">period</span> <span class="o">===</span> <span class="s2">&quot;D&quot;</span> <span class="o">?</span> <span class="nx">offset</span> <span class="o">:</span> <span class="mi">0</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">date</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_restrictMinMax</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_daylightSavingAdjust</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">month</span><span class="p">,</span> <span class="nx">day</span><span class="p">)));</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedDay</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">();</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">drawMonth</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedMonth</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">();</span>
</span><span class='line'>      <span class="nx">inst</span><span class="p">.</span><span class="nx">drawYear</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedYear</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">();</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">period</span> <span class="o">===</span> <span class="s2">&quot;M&quot;</span> <span class="o">||</span> <span class="nx">period</span> <span class="o">===</span> <span class="s2">&quot;Y&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_notifyChange</span><span class="p">(</span><span class="nx">inst</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Ensure a date is within any min/max bounds. */</span>
</span><span class='line'>  <span class="nx">_restrictMinMax</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">date</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">minDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getMinMaxDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">maxDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getMinMaxDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">newDate</span> <span class="o">=</span> <span class="p">(</span><span class="nx">minDate</span> <span class="o">&amp;&amp;</span> <span class="nx">date</span> <span class="o">&lt;</span> <span class="nx">minDate</span> <span class="o">?</span> <span class="nx">minDate</span> <span class="o">:</span> <span class="nx">date</span><span class="p">);</span>
</span><span class='line'>      <span class="k">return</span> <span class="p">(</span><span class="nx">maxDate</span> <span class="o">&amp;&amp;</span> <span class="nx">newDate</span> <span class="o">&gt;</span> <span class="nx">maxDate</span> <span class="o">?</span> <span class="nx">maxDate</span> <span class="o">:</span> <span class="nx">newDate</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Notify change of month/year. */</span>
</span><span class='line'>  <span class="nx">_notifyChange</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">onChange</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;onChangeMonthYear&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">onChange</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">onChange</span><span class="p">.</span><span class="nx">apply</span><span class="p">((</span><span class="nx">inst</span><span class="p">.</span><span class="nx">input</span> <span class="o">?</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">input</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">:</span> <span class="kc">null</span><span class="p">),</span>
</span><span class='line'>              <span class="p">[</span><span class="nx">inst</span><span class="p">.</span><span class="nx">selectedYear</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedMonth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">inst</span><span class="p">]);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Determine the number of months to show. */</span>
</span><span class='line'>  <span class="nx">_getNumberOfMonths</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">numMonths</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;numberOfMonths&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="k">return</span> <span class="p">(</span><span class="nx">numMonths</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">:</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">numMonths</span> <span class="o">===</span> <span class="s2">&quot;number&quot;</span> <span class="o">?</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="nx">numMonths</span><span class="p">]</span> <span class="o">:</span> <span class="nx">numMonths</span><span class="p">));</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Determine the current maximum date - ensure no time components are set. */</span>
</span><span class='line'>  <span class="nx">_getMinMaxDate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">minMax</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_determineDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">minMax</span> <span class="o">+</span> <span class="s2">&quot;Date&quot;</span><span class="p">),</span> <span class="kc">null</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Find the number of days in a given month. */</span>
</span><span class='line'>  <span class="nx">_getDaysInMonth</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">month</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="mi">32</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">_daylightSavingAdjust</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">month</span><span class="p">,</span> <span class="mi">32</span><span class="p">)).</span><span class="nx">getDate</span><span class="p">();</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Find the day of the week of the first of a month. */</span>
</span><span class='line'>  <span class="nx">_getFirstDayOfMonth</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">month</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">month</span><span class="p">,</span> <span class="mi">1</span><span class="p">).</span><span class="nx">getDay</span><span class="p">();</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Determines if we should allow a &quot;next/prev&quot; month display change. */</span>
</span><span class='line'>  <span class="nx">_canAdjustMonth</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">offset</span><span class="p">,</span> <span class="nx">curYear</span><span class="p">,</span> <span class="nx">curMonth</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">numMonths</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getNumberOfMonths</span><span class="p">(</span><span class="nx">inst</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">date</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_daylightSavingAdjust</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">curYear</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">curMonth</span> <span class="o">+</span> <span class="p">(</span><span class="nx">offset</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">offset</span> <span class="o">:</span> <span class="nx">numMonths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nx">numMonths</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">1</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">offset</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">date</span><span class="p">.</span><span class="nx">setDate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_getDaysInMonth</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()));</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_isInRange</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">date</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Is the given date in the accepted range? */</span>
</span><span class='line'>  <span class="nx">_isInRange</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">date</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">yearSplit</span><span class="p">,</span> <span class="nx">currentYear</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">minDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getMinMaxDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">maxDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getMinMaxDate</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">minYear</span> <span class="o">=</span> <span class="kc">null</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">maxYear</span> <span class="o">=</span> <span class="kc">null</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">years</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;yearRange&quot;</span><span class="p">);</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="nx">years</span><span class="p">){</span>
</span><span class='line'>              <span class="nx">yearSplit</span> <span class="o">=</span> <span class="nx">years</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">);</span>
</span><span class='line'>              <span class="nx">currentYear</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getFullYear</span><span class="p">();</span>
</span><span class='line'>              <span class="nx">minYear</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">yearSplit</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">10</span><span class="p">);</span>
</span><span class='line'>              <span class="nx">maxYear</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">yearSplit</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">10</span><span class="p">);</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span> <span class="nx">yearSplit</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">match</span><span class="p">(</span><span class="sr">/[+\-].*/</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">minYear</span> <span class="o">+=</span> <span class="nx">currentYear</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span> <span class="nx">yearSplit</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">match</span><span class="p">(</span><span class="sr">/[+\-].*/</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">maxYear</span> <span class="o">+=</span> <span class="nx">currentYear</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">return</span> <span class="p">((</span><span class="o">!</span><span class="nx">minDate</span> <span class="o">||</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="nx">minDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">())</span> <span class="o">&amp;&amp;</span>
</span><span class='line'>          <span class="p">(</span><span class="o">!</span><span class="nx">maxDate</span> <span class="o">||</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="nx">maxDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">())</span> <span class="o">&amp;&amp;</span>
</span><span class='line'>          <span class="p">(</span><span class="o">!</span><span class="nx">minYear</span> <span class="o">||</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="nx">minYear</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
</span><span class='line'>          <span class="p">(</span><span class="o">!</span><span class="nx">maxYear</span> <span class="o">||</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="nx">maxYear</span><span class="p">));</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Provide the configuration settings for formatting/parsing. */</span>
</span><span class='line'>  <span class="nx">_getFormatConfig</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">shortYearCutoff</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;shortYearCutoff&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">shortYearCutoff</span> <span class="o">=</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">shortYearCutoff</span> <span class="o">!==</span> <span class="s2">&quot;string&quot;</span> <span class="o">?</span> <span class="nx">shortYearCutoff</span> <span class="o">:</span>
</span><span class='line'>          <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">shortYearCutoff</span><span class="p">,</span> <span class="mi">10</span><span class="p">));</span>
</span><span class='line'>      <span class="k">return</span> <span class="p">{</span><span class="nx">shortYearCutoff</span><span class="o">:</span> <span class="nx">shortYearCutoff</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">dayNamesShort</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;dayNamesShort&quot;</span><span class="p">),</span> <span class="nx">dayNames</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;dayNames&quot;</span><span class="p">),</span>
</span><span class='line'>          <span class="nx">monthNamesShort</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;monthNamesShort&quot;</span><span class="p">),</span> <span class="nx">monthNames</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;monthNames&quot;</span><span class="p">)};</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Format the given date for display. */</span>
</span><span class='line'>  <span class="nx">_formatDate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">day</span><span class="p">,</span> <span class="nx">month</span><span class="p">,</span> <span class="nx">year</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">day</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">currentDay</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedDay</span><span class="p">;</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">currentMonth</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedMonth</span><span class="p">;</span>
</span><span class='line'>          <span class="nx">inst</span><span class="p">.</span><span class="nx">currentYear</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">selectedYear</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">date</span> <span class="o">=</span> <span class="p">(</span><span class="nx">day</span> <span class="o">?</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">day</span> <span class="o">===</span> <span class="s2">&quot;object&quot;</span> <span class="o">?</span> <span class="nx">day</span> <span class="o">:</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_daylightSavingAdjust</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">month</span><span class="p">,</span> <span class="nx">day</span><span class="p">)))</span> <span class="o">:</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">_daylightSavingAdjust</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">currentYear</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">currentMonth</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">currentDay</span><span class="p">)));</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">formatDate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;dateFormat&quot;</span><span class="p">),</span> <span class="nx">date</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getFormatConfig</span><span class="p">(</span><span class="nx">inst</span><span class="p">));</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/*</span>
</span><span class='line'><span class="cm"> * Bind hover events for datepicker elements.</span>
</span><span class='line'><span class="cm"> * Done via delegate so the binding only occurs once in the lifetime of the parent div.</span>
</span><span class='line'><span class="cm"> * Global instActive, set by _updateDatepicker allows the handlers to find their way back to the active picker.</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="kd">function</span> <span class="nx">bindHover</span><span class="p">(</span><span class="nx">dpDiv</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">selector</span> <span class="o">=</span> <span class="s2">&quot;button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">dpDiv</span><span class="p">.</span><span class="nx">delegate</span><span class="p">(</span><span class="nx">selector</span><span class="p">,</span> <span class="s2">&quot;mouseout&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s2">&quot;ui-state-hover&quot;</span><span class="p">);</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;ui-datepicker-prev&quot;</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s2">&quot;ui-datepicker-prev-hover&quot;</span><span class="p">);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;ui-datepicker-next&quot;</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s2">&quot;ui-datepicker-next-hover&quot;</span><span class="p">);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>      <span class="p">.</span><span class="nx">delegate</span><span class="p">(</span><span class="nx">selector</span><span class="p">,</span> <span class="s2">&quot;mouseover&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_isDisabledDatepicker</span><span class="p">(</span> <span class="nx">instActive</span><span class="p">.</span><span class="nx">inline</span> <span class="o">?</span> <span class="nx">dpDiv</span><span class="p">.</span><span class="nx">parent</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">:</span> <span class="nx">instActive</span><span class="p">.</span><span class="nx">input</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">parents</span><span class="p">(</span><span class="s2">&quot;.ui-datepicker-calendar&quot;</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s2">&quot;ui-state-hover&quot;</span><span class="p">);</span>
</span><span class='line'>              <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;ui-state-hover&quot;</span><span class="p">);</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;ui-datepicker-prev&quot;</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;ui-datepicker-prev-hover&quot;</span><span class="p">);</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;ui-datepicker-next&quot;</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;ui-datepicker-next-hover&quot;</span><span class="p">);</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/* jQuery extend now ignores nulls! */</span>
</span><span class='line'><span class="kd">function</span> <span class="nx">extendRemove</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">props</span><span class="p">);</span>
</span><span class='line'>  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">name</span> <span class="k">in</span> <span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">props</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">target</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">props</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">target</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/* Invoke the datepicker functionality.</span>
</span><span class='line'><span class="cm">   @param  options  string - a command, optionally followed by additional parameters or</span>
</span><span class='line'><span class="cm">                 Object - settings for attaching new datepicker functionality</span>
</span><span class='line'><span class="cm">   @return  jQuery object */</span>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">datepicker</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">){</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Verify an empty collection wasn&#39;t passed - Fixes #6976 */</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Initialise the date picker. */</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">initialized</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">mousedown</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_checkExternalClick</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">initialized</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Append datepicker main container to body if not exist. */</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="o">+</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_mainDivId</span><span class="p">).</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">dpDiv</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">otherArgs</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">options</span> <span class="o">===</span> <span class="s2">&quot;string&quot;</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">options</span> <span class="o">===</span> <span class="s2">&quot;isDisabled&quot;</span> <span class="o">||</span> <span class="nx">options</span> <span class="o">===</span> <span class="s2">&quot;getDate&quot;</span> <span class="o">||</span> <span class="nx">options</span> <span class="o">===</span> <span class="s2">&quot;widget&quot;</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">[</span><span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nx">options</span> <span class="o">+</span> <span class="s2">&quot;Datepicker&quot;</span><span class="p">].</span>
</span><span class='line'>          <span class="nx">apply</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">,</span> <span class="p">[</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">otherArgs</span><span class="p">));</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">options</span> <span class="o">===</span> <span class="s2">&quot;option&quot;</span> <span class="o">&amp;&amp;</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">===</span> <span class="s2">&quot;string&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">[</span><span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nx">options</span> <span class="o">+</span> <span class="s2">&quot;Datepicker&quot;</span><span class="p">].</span>
</span><span class='line'>          <span class="nx">apply</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">,</span> <span class="p">[</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">otherArgs</span><span class="p">));</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">typeof</span> <span class="nx">options</span> <span class="o">===</span> <span class="s2">&quot;string&quot;</span> <span class="o">?</span>
</span><span class='line'>          <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">[</span><span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nx">options</span> <span class="o">+</span> <span class="s2">&quot;Datepicker&quot;</span><span class="p">].</span>
</span><span class='line'>              <span class="nx">apply</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">,</span> <span class="p">[</span><span class="k">this</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">otherArgs</span><span class="p">))</span> <span class="o">:</span>
</span><span class='line'>          <span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">_attachDatepicker</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Datepicker</span><span class="p">();</span> <span class="c1">// singleton instance</span>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">initialized</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">uuid</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">();</span>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">.</span><span class="nx">version</span> <span class="o">=</span> <span class="s2">&quot;1.10.2&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Workaround for #4055</span>
</span><span class='line'><span class="c1">// Add another global to avoid noConflict issues with inline event handlers</span>
</span><span class='line'><span class="nb">window</span><span class="p">[</span><span class="s2">&quot;DP_jQuery_&quot;</span> <span class="o">+</span> <span class="nx">dpuuid</span><span class="p">]</span> <span class="o">=</span> <span class="nx">$</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="p">})(</span><span class="nx">jQuery</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[学习ruby on rails-ruby和rails的安装]]></title>
    <link href="http://ajia.github.com/blog/2013/04/01/xue-xi-ruby-on-rails-rubyhe-railsde-an-zhuang/"/>
    <updated>2013-04-01T11:59:00+08:00</updated>
    <id>http://ajia.github.com/blog/2013/04/01/xue-xi-ruby-on-rails-rubyhe-railsde-an-zhuang</id>
    <content type="html"><![CDATA[<p>ruby的安装在文章<a href="http://ajia.github.com/blog/2013/03/06/how-to-install-octopress/" title="点击查看">how-to-install-octopress</a>里有说过。</p>

<h3>在Lion安装rails</h3>

<pre><code>gem install rails
</code></pre>

<h3>创建rails的应用</h3>

<pre><code>rails new myapp
</code></pre>

<h3>启动应用</h3>

<pre><code>cd myapp
rails server
</code></pre>

<h3>进入</h3>

<pre><code>http://localhost:3000
"Welcome aboard: You're riding Ruby on Rails!"
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[好听的曲子]]></title>
    <link href="http://ajia.github.com/blog/2013/03/28/hao-ting-de-qu-zi/"/>
    <updated>2013-03-28T15:15:00+08:00</updated>
    <id>http://ajia.github.com/blog/2013/03/28/hao-ting-de-qu-zi</id>
    <content type="html"><![CDATA[<p>Exodus-Maksim Mrvica<br/>
<audio controls><source src='http://ajia.github.com/downloads/media/exodus.mp3'></audio></p>

<p>最后的倾述-韩磊<br/>
<audio controls><source src='http://ajia.github.com/downloads/media/zhdqs.mp3'></audio></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Octopress的插件]]></title>
    <link href="http://ajia.github.com/blog/2013/03/28/octopressde-cha-jian/"/>
    <updated>2013-03-28T13:27:00+08:00</updated>
    <id>http://ajia.github.com/blog/2013/03/28/octopressde-cha-jian</id>
    <content type="html"><![CDATA[<p>记得去掉{和%之间的空格</p>

<h2>包含代码（Include Code）</h2>

<h5>语法</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{ % include_code [title] [lang:language] path/to/file % }</span></code></pre></td></tr></table></div></figure>


<h5>例子</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{ % include_code test.js % }</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span> (test.js)</span> <a href='http://ajia.github.com/downloads/code/test.js'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm">sample javascript from xui</span>
</span><span class='line'><span class="cm">*/</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="kc">undefined</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">xui</span><span class="p">,</span>
</span><span class='line'>    <span class="nb">window</span>     <span class="o">=</span> <span class="k">this</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">string</span>     <span class="o">=</span> <span class="k">new</span> <span class="nb">String</span><span class="p">(</span><span class="s1">&#39;string&#39;</span><span class="p">),</span>
</span><span class='line'>    <span class="nb">document</span>   <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nb">document</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">simpleExpr</span> <span class="o">=</span> <span class="sr">/^#?([\w-]+)$/</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">idExpr</span>     <span class="o">=</span> <span class="sr">/^#/</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">tagExpr</span>    <span class="o">=</span> <span class="sr">/&lt;([\w:]+)/</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">slice</span>      <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="p">[].</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="p">};</span>
</span><span class='line'>    <span class="k">try</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">slice</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">nodeType</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span> <span class="nx">slice</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">ret</span><span class="o">=</span><span class="p">[];</span> <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">e</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">ret</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">e</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span> <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span> <span class="p">};</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nb">window</span><span class="p">.</span><span class="nx">x$</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">xui</span> <span class="o">=</span> <span class="nx">xui</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">q</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="nx">xui</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">q</span><span class="p">,</span> <span class="nx">context</span><span class="p">);</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>




<!--more-->


<h2>引用块（Blockquote）</h2>

<h5>语法</h5>

<pre><code>{ % blockquote [author[, source]] [link] [source_link_title] % }
Quote string
{ % endblockquote % }
</code></pre>

<h5>例子</h5>

<pre><code>{ % blockquote % }
Last night I lay in bed looking up at the stars in the sky and I thought to myself, where the heck is the ceiling.
{ % endblockquote % }
</code></pre>

<blockquote><p>Last night I lay in bed looking up at the stars in the sky and I thought to myself, where the heck is the ceiling.</p></blockquote>


<pre><code>{ % blockquote Douglas Adams, The Hichhikers Guide to the Galaxy % }
Flying is learning how to throw yourself at the ground and miss.
{ % endblockquote % }
</code></pre>

<blockquote><p>Flying is learning how to throw yourself at the ground and miss.</p><footer><strong>Douglas Adams</strong> <cite>The Hichhikers Guide to the Galaxy</cite></footer></blockquote>


<pre><code>{ % blockquote Seth Godin http://sethgodin.typepad.com/seths_blog/2009/07/welcome-to-island-marketing.html Welcome to Island Marketing % }
Every interaction is both precious and an opportunity to delight.
{ % endblockquote % }
</code></pre>

<blockquote><p>Every interaction is both precious and an opportunity to delight.</p><footer><strong>Seth Godin</strong> <cite><a href='http://sethgodin.typepad.com/seths_blog/2009/07/welcome-to-island-marketing.html'>Welcome to Island Marketing</a></cite></footer></blockquote>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[在octopress里写博客]]></title>
    <link href="http://ajia.github.com/blog/2013/03/28/zai-octopressli-xie-bo-ke/"/>
    <updated>2013-03-28T11:00:00+08:00</updated>
    <id>http://ajia.github.com/blog/2013/03/28/zai-octopressli-xie-bo-ke</id>
    <content type="html"><![CDATA[<h3>代码高亮</h3>

<h4>Codeblock</h4>

<h6>语法</h6>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{ % codeblock [title] [lang:language] [url] [link text] % }
</span><span class='line'>code snippet
</span><span class='line'>{ % endcodeblock % }</span></code></pre></td></tr></table></div></figure>


<h6>例子</h6>

<pre><code>{ % codeblock % }
Awesome code snippet
{ % endcodeblock % }
</code></pre>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Awesome code snippet</span></code></pre></td></tr></table></div></figure>




<!-- more -->


<h4>Backtick Code Blocks</h4>

<h6>语法</h6>

<pre><code>``` [language] [title] [url] [link text]
code snippet
```
</code></pre>

<h6>例子</h6>

<pre><code>```
$ sudo make me a sandwich
```
</code></pre>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo make me a sandwich</span></code></pre></td></tr></table></div></figure>


<h4>摘要</h4>

<p>如果不希望显示全文，只需要在你希望首页显示的内容最后，输入：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;!--more--></span></code></pre></td></tr></table></div></figure>


<h3>插入图片</h3>

<h4>语法</h4>

<pre><code>{ % img [class names] /path/to/image [width] [height] [title text [alt text]] % }
</code></pre>

<h4>例子</h4>

<pre><code>{ % img center /images/zy.jpg 300 300 品 % }
{ % img center /images/zd.jpg 300 300 丹丹 % }
</code></pre>

<p><img class="center" src="http://ajia.github.com/images/zy.jpg" width="300" height="300" title="品" >
<img class="center" src="http://ajia.github.com/images/zd.jpg" width="300" height="300" title="朱朱" ></p>

<h3>插入视频</h3>

<h4>语法</h4>

<pre><code>{ % video url/to/video [width height] [url/to/poster] % }
</code></pre>

<h4>例子</h4>

<pre><code>{ % video http://s3.imathis.com/video/zero-to-fancy-buttons.mp4 640 320 http://s3.imathis.com/video/zero-to-fancy-buttons.png % }
</code></pre>

<p><video width='640' height='320' preload='none' controls poster='http://s3.imathis.com/video/zero-to-fancy-buttons.png'><source src='http://s3.imathis.com/video/zero-to-fancy-buttons.mp4' type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'></video></p>

<h3>插入超链</h3>

<pre><code>[欢迎来到ajia的部落格](http://ajia.github.com "ajia's blog")
</code></pre>

<p><a href="http://ajia.github.com" title="ajia's blog">欢迎来到ajia的部落格</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[推荐微信]]></title>
    <link href="http://ajia.github.com/blog/2013/03/27/tui-jian-wei-xin/"/>
    <updated>2013-03-27T21:42:00+08:00</updated>
    <id>http://ajia.github.com/blog/2013/03/27/tui-jian-wei-xin</id>
    <content type="html"><![CDATA[<p>推荐一个微信公众账号，带给你一些关于情侣和夫妻之间好玩的事
<img class="center" src="http://ajia.github.com/images/getqrcode.jpg" width="300" height="300" title="丹丹调戏品" ></p>
]]></content>
  </entry>
  
</feed>
